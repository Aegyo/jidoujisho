var ui=Object.defineProperty;var fi=(t,e,n)=>e in t?ui(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ne=(t,e,n)=>(fi(t,typeof e!="symbol"?e+"":e,n),n);import{S as ct,i as ht,n as dt,a0 as ci,e as yt,a1 as hi,a as A,Q as Ct,f as E,ad as tn,h as di,j as U,w as ve,s as $,k as J,l as Q,x as Pe,c as ee,m as X,ae as N,p as M,y as ye,_ as De,d as z,g as xe,t as Y,b as $e,z as Me,af as mt,a2 as W,a8 as _n,ag as wn,ac as ne,O as Z,a3 as Sn,q as _e,r as we,u as He,ah as Dn,ai as me,aj as ge,o as fo,a6 as co,a7 as ho,N as mi,ak as gi,a9 as mo,ab as Fn,aa as ki,C as pi}from"../../../chunks/singletons-54206af0.js";import{a as bi,p as go,b as ko,i as Ci,c as qt,e as Et,h as _i,j as wi,k as Si,l as ot,o as gt,s as At,m as Ve,n as nn,F as qe,q as vn,r as Kt,u as po,t as rt,v as bo,w as Co,x as wt,y as gn,z as kn,R as vi,A as pn,V as bt,B as on,C as Pi,D as yi,E as Mi,G as _o,N as Ei,H as Bi,I as nt,f as Tn,d as Dt,J as Ri,S as Di,K as Fi,L as Ti,g as Ii,M as Ai,O as fn,P as bn,Q as Cn,T as Vi,U as cn,W as hn,X as Oi,Y as Li,Z as zi,_ as Ni,$ as Hi,a0 as Gi,a1 as Wi,a2 as ji,a3 as Xi,a4 as qi,a5 as Yi,a6 as Ki}from"../../../chunks/format-page-title-2ec229d3.js";import{p as Ui}from"../../../chunks/stores-41bc0127.js";import{p as wo,l as Ut,m as Vt,_ as Nt,q as Ji,O as at,i as _t,n as Qi,j as Zi,B as Jt,a as je,w as xi,d as In}from"../../../chunks/dialog-manager-6307dd27.js";import{m as $i,g as rn,t as Qe,a as So,c as Ot,p as An,f as Vn,b as er,i as vo}from"../../../chunks/index-970eb221.js";import{F as et,f as Lt,a as tr,M as nr,m as Qt,b as or,P as ir,c as rr,d as ar,e as lr,g as sr,h as ur,i as Po}from"../../../chunks/merged-header-icon-f43ceb7d.js";import{r as pt,a as fr}from"../../../chunks/theme-option-fbb9d515.js";import{i as Pn,d as an}from"../../../chunks/utils-87ab534e.js";var It={schedule:function(t){var e=requestAnimationFrame,n=cancelAnimationFrame,i=It.delegate;i&&(e=i.requestAnimationFrame,n=i.cancelAnimationFrame);var o=e(function(r){n=void 0,t(r)});return new wo(function(){return n==null?void 0:n(o)})},requestAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=It.delegate;return((n==null?void 0:n.requestAnimationFrame)||requestAnimationFrame).apply(void 0,Ut([],Vt(t)))},cancelAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=It.delegate;return((n==null?void 0:n.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,Ut([],Vt(t)))},delegate:void 0},cr=function(t){Nt(e,t);function e(n,i){return t.call(this)||this}return e.prototype.schedule=function(n,i){return this},e}(wo),Zt={setInterval:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=Zt.delegate;return o!=null&&o.setInterval?o.setInterval.apply(o,Ut([t,e],Vt(n))):setInterval.apply(void 0,Ut([t,e],Vt(n)))},clearInterval:function(t){var e=Zt.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},yo=function(t){Nt(e,t);function e(n,i){var o=t.call(this,n,i)||this;return o.scheduler=n,o.work=i,o.pending=!1,o}return e.prototype.schedule=function(n,i){var o;if(i===void 0&&(i=0),this.closed)return this;this.state=n;var r=this.id,a=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(a,r,i)),this.pending=!0,this.delay=i,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(a,this.id,i),this},e.prototype.requestAsyncId=function(n,i,o){return o===void 0&&(o=0),Zt.setInterval(n.flush.bind(n,this),o)},e.prototype.recycleAsyncId=function(n,i,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return i;i!=null&&Zt.clearInterval(i)},e.prototype.execute=function(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(n,i);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,i){var o=!1,r;try{this.work(n)}catch(a){o=!0,r=a||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),r},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,i=n.id,o=n.scheduler,r=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ji(r,this),i!=null&&(this.id=this.recycleAsyncId(o,i,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(cr),On=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,i){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(i,n)},t.now=bi.now,t}(),Mo=function(t){Nt(e,t);function e(n,i){i===void 0&&(i=On.now);var o=t.call(this,n,i)||this;return o.actions=[],o._active=!1,o}return e.prototype.flush=function(n){var i=this.actions;if(this._active){i.push(n);return}var o;this._active=!0;do if(o=n.execute(n.state,n.delay))break;while(n=i.shift());if(this._active=!1,o){for(;n=i.shift();)n.unsubscribe();throw o}},e}(On),ln=new Mo(yo),hr=ln,dr=function(t){Nt(e,t);function e(n,i){var o=t.call(this,n,i)||this;return o.scheduler=n,o.work=i,o}return e.prototype.requestAsyncId=function(n,i,o){return o===void 0&&(o=0),o!==null&&o>0?t.prototype.requestAsyncId.call(this,n,i,o):(n.actions.push(this),n._scheduled||(n._scheduled=It.requestAnimationFrame(function(){return n.flush(void 0)})))},e.prototype.recycleAsyncId=function(n,i,o){var r;if(o===void 0&&(o=0),o!=null?o>0:this.delay>0)return t.prototype.recycleAsyncId.call(this,n,i,o);var a=n.actions;i!=null&&((r=a[a.length-1])===null||r===void 0?void 0:r.id)!==i&&(It.cancelAnimationFrame(i),n._scheduled=void 0)},e}(yo),mr=function(t){Nt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.flush=function(n){this._active=!0;var i=this._scheduled;this._scheduled=void 0;var o=this.actions,r;n=n||o.shift();do if(r=n.execute(n.state,n.delay))break;while((n=o[0])&&n.id===i&&o.shift());if(this._active=!1,r){for(;(n=o[0])&&n.id===i&&o.shift();)n.unsubscribe();throw r}},e}(Mo),sn=new mr(dr),Mt=new at(function(t){return t.complete()});function yn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=go(t);return ko(t,n)}function gr(t){return t instanceof Date&&!isNaN(t)}var kr=["addListener","removeListener"],pr=["addEventListener","removeEventListener"],br=["on","off"];function Ye(t,e,n,i){if(_t(n)&&(i=n,n=void 0),i)return Ye(t,e,n).pipe($i(i));var o=Vt(wr(t)?pr.map(function(l){return function(u){return t[l](e,u,n)}}):Cr(t)?kr.map(Ln(t,e)):_r(t)?br.map(Ln(t,e)):[],2),r=o[0],a=o[1];if(!r&&Ci(t))return qt(function(l){return Ye(l,e,n)})(Et(t));if(!r)throw new TypeError("Invalid event target");return new at(function(l){var u=function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];return l.next(1<f.length?f:f[0])};return r(u),function(){return a(u)}})}function Ln(t,e){return function(n){return function(i){return t[n](e,i)}}}function Cr(t){return _t(t.addListener)&&_t(t.removeListener)}function _r(t){return _t(t.on)&&_t(t.off)}function wr(t){return _t(t.addEventListener)&&_t(t.removeEventListener)}function un(t,e,n){t===void 0&&(t=0),n===void 0&&(n=hr);var i=-1;return e!=null&&(_i(e)?n=e:i=e),new at(function(o){var r=gr(t)?+t-n.now():t;r<0&&(r=0);var a=0;return n.schedule(function(){o.closed||(o.next(a++),0<=i?this.schedule(void 0,i):o.complete())},r)})}function Sr(t,e){return t===void 0&&(t=0),e===void 0&&(e=ln),t<0&&(t=0),un(t,t,e)}function Ht(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=go(t),i=wi(t,1/0),o=t;return o.length?o.length===1?Et(o[0]):Si(i)(ko(o,n)):Mt}var vr=Array.isArray;function Pr(t){return t.length===1&&vr(t[0])?t[0]:t}function yr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t=Pr(t),t.length===1?Et(t[0]):new at(Mr(t))}function Mr(t){return function(e){for(var n=[],i=function(r){n.push(Et(t[r]).subscribe(ot(e,function(a){if(n){for(var l=0;l<n.length;l++)l!==r&&n[l].unsubscribe();n=null}e.next(a)})))},o=0;n&&!e.closed&&o<t.length;o++)i(o)}}function Er(t){return gt(function(e,n){var i=!1,o=null,r=null,a=function(){if(r==null||r.unsubscribe(),r=null,i){i=!1;var l=o;o=null,n.next(l)}};e.subscribe(ot(n,function(l){r==null||r.unsubscribe(),i=!0,o=l,r=ot(n,a,Qi),Et(t(l)).subscribe(r)},function(){a(),n.complete()},void 0,function(){o=r=null}))})}function zt(t,e){return e===void 0&&(e=ln),gt(function(n,i){var o=null,r=null,a=null,l=function(){if(o){o.unsubscribe(),o=null;var f=r;r=null,i.next(f)}};function u(){var f=a+t,h=e.now();if(h<f){o=this.schedule(void 0,f-h),i.add(o);return}l()}n.subscribe(ot(i,function(f){r=f,a=e.now(),o||(o=e.schedule(u,t),i.add(o))},function(){l(),i.complete()},void 0,function(){r=o=null}))})}function Bt(t){return t<=0?function(){return Mt}:gt(function(e,n){var i=0;e.subscribe(ot(n,function(o){++i<=t&&(n.next(o),t<=i&&n.complete())}))})}function Eo(t,e){return e===void 0&&(e=Zi),t=t??Br,gt(function(n,i){var o,r=!0;n.subscribe(ot(i,function(a){var l=e(a);(r||!t(o,l))&&(r=!1,o=l,i.next(a))}))})}function Br(t,e){return t===e}function Rr(t){return gt(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function Dr(){return gt(function(t,e){var n,i=!1;t.subscribe(ot(e,function(o){var r=n;n=o,i&&e.next([r,o]),i=!0}))})}function Fr(t,e){return e===void 0&&(e=!1),gt(function(n,i){var o=0;n.subscribe(ot(i,function(r){var a=t(r,o++);(a||e)&&i.next(r),!a&&i.complete()}))})}var Bo={leading:!0,trailing:!1};function Tr(t,e){return e===void 0&&(e=Bo),gt(function(n,i){var o=e.leading,r=e.trailing,a=!1,l=null,u=null,f=!1,h=function(){u==null||u.unsubscribe(),u=null,r&&(m(),f&&i.complete())},d=function(){u=null,f&&i.complete()},p=function(_){return u=Et(t(_)).subscribe(ot(i,h,d))},m=function(){if(a){a=!1;var _=l;l=null,i.next(_),!f&&p(_)}};n.subscribe(ot(i,function(_){a=!0,l=_,!(u&&!u.closed)&&(o?m():p(_))},function(){f=!0,!(r&&a&&u&&!u.closed)&&i.complete()}))})}function Ir(t,e,n){e===void 0&&(e=ln),n===void 0&&(n=Bo);var i=un(t,e);return Tr(function(){return i},n)}const Mn=new Jt([]),xt=new je,Gt=new je,Pt=new je;function Ro(t){const e=t.filter(r=>!r.parentChapter);let n=t.find(r=>r.progress<100);n||(n=t[t.length-1]);const i=n.parentChapter||n.reference,o=e.findIndex(r=>r.reference===i);return[e,o,i]}function Ar(t){let e,n;return{c(){e=new ci(!1),n=yt(),this.h()},l(i){e=hi(i,!1),n=yt(),this.h()},h(){e.a=n},m(i,o){e.m(t[0],i,o),A(i,n,o)},p(i,[o]){o&1&&e.p(i[0])},i:Ct,o:Ct,d(i){i&&E(n),i&&e.d()}}}function Vr(t,e,n){let{html:i}=e;const o=tn();return di(()=>{o("load")}),t.$$set=r=>{"html"in r&&n(0,i=r.html)},[i]}class Do extends ct{constructor(e){super(),ht(this,e,Vr,Ar,dt,{html:0})}}function Or(t,e){var o;const n=(o=document.elementFromPoint(t,e))==null?void 0:o.closest("p");if(!n)return;const i=rn(n);if(!!i.length)return{range:En(i[0]),parent:n}}function En(t,e=0,n=0){const i=new Range;return i.setStart(t,e),i.setEnd(t,n),i}function Lr(t,e){var a,l,u;const n=(a=t.getSelection())!=null&&a.toString().trim()?(l=t.getSelection())==null?void 0:l.getRangeAt(0):void 0;let i;if(n?i=n:i=e,!i)return;const o=(u=i.endContainer.parentElement)==null?void 0:u.closest("p");if(!o)return;const r=rn(o);if(!!r.length)return En(r[0])}function zn(t,e){const n=t.createRange();return n.selectNode(e),n.getBoundingClientRect()}function Fo(t,e=250){var n;(n=t.getSelection())==null||n.removeAllRanges(),setTimeout(()=>{var i;(i=t.getSelection())==null||i.addRange(new Range)},e)}function To(t,e,n,i){const o=Math.min(Math.max(i,0),n?t.innerWidth/4:t.innerHeight/4),r=e.getBoundingClientRect(),a=n?o:r.left,l=n?t.innerWidth-o:r.right,u=n?r.top:o,f=n?r.bottom:t.innerHeight-o,h=Number(getComputedStyle(e).lineHeight.replace(/px$/,""));return{elLeftReferencePoint:a,elRightReferencePoint:l,elTopReferencePoint:u,elBottomReferencePoint:f,firstDimensionMargin:o,pointGap:h}}function Tt(t,e,n,i=0){if(!t)return;const o=`animate-[pulse_${n}s_cubic-bezier(0.4,0,0.6,1)_${i?"1":"infinite"}]`;t.classList[e](o),i&&setTimeout(()=>t.classList.remove(o),i)}class zr{constructor(e,n,i,o,r=sn){Ne(this,"enabled$",new Jt(!1));this.multiplier=e,this.verticalMode=n,this.enabled$.pipe(At(a=>{if(!a)return Mt;let l=0;return Sr(0,r).pipe(Ve(()=>Date.now()),Dr(),Ve(u=>this.calcNewPos(u)),Ve(u=>{l+=u;const f=Math.trunc(l);return l-=f,f}),nn(u=>u!==0))}),Qe(i)).subscribe(a=>{let l="top";n&&(l="left"),o.documentElement.scrollBy({[l]:a})})}toggle(){this.enabled$.next(!this.enabled$.getValue())}off(){this.enabled$.next(!1)}calcNewPos([e,n]){let i=.00365956;return this.verticalMode&&(i=-91489e-8),i*this.multiplier*(n-e)}}function St(t,e){return e==="rtl"?-t:t}class Nr{constructor(e,n,i){this.calculator=e,this.window=n,this.firstDimensionMargin=i}scrollToBookmark(e,n=0){const i=this.getBookmarkPosition(e);if(!i)return;const{scrollToData:o}=Nn(i,this.firstDimensionMargin),r=this.calculator.verticalMode?"left":"top";o.left!==void 0&&r==="left"?o.left+=n:o.top!==void 0&&r==="top"&&(o.top-=n),this.window.scrollTo(o)}formatBookmarkData(e,n=0){const i=this.calculator.calcExploredCharCount(n),o=this.calculator.charCount,{verticalMode:r}=this.calculator,a=r?"scrollX":"scrollY";return{dataId:e,exploredCharCount:i,progress:i/o,[a]:this.window[a],lastBookmarkModified:new Date().getTime()}}formatBookmarkDataByRange(e){return this.formatBookmarkData(e)}getBookmarkBarPosition(e){const n=this.getBookmarkPosition(e);if(!!n)return Nn(n,this.firstDimensionMargin).bookmarkPosData}getBookmarkPosition(e){if(!e.exploredCharCount)return;const{verticalMode:n}=this.calculator,i=this.getBookmarkTargetPosByScrollValue(e);if(i)return i;const o=this.calculator.getScrollPosByCharCount(e.exploredCharCount);return n?{scrollX:o}:{scrollY:o}}getBookmarkTargetPosByScrollValue(e){const{exploredCharCount:n}=e,i=o=>{const r=e[o];if(!r)return;const a=St(r,this.calculator.direction);if(this.calculator.getCharCountByScrollPos(a)===n)return{[o]:r}};return this.calculator.verticalMode?i("scrollX"):i("scrollY")}}function Nn(t,e){return"scrollX"in t?{scrollToData:{left:t.scrollX},bookmarkPosData:{right:`${-t.scrollX+e}px`}}:{scrollToData:{top:t.scrollY},bookmarkPosData:{top:`${t.scrollY+e}px`}}}function Io(t){const e=(n,i,o,r)=>{if(o<i)return t??o;const a=Math.floor((i+o)/2);return n[a]===r?a:n[a]>r?e(n,i,a-1,r):e(n,a+1,o,r)};return(n,i)=>e(n,0,n.length-1,i)}function Hr(){const t=(e,n,i,o)=>{if(i<n)return-1;const r=Math.floor((n+i)/2);return o.intersectsNode(e[r])?r:o.comparePoint(e[r],0)>0?t(e,n,r-1,o):t(e,r+1,i,o)};return(e,n)=>t(e,0,e.length-1,n)}const Gr=Hr(),Wr=Io(-1),$t=Io(void 0);class Ao{constructor(e,n,i,o,r){Ne(this,"charCount");Ne(this,"accumulatedCharCount");Ne(this,"paragraphPos");Ne(this,"paragraphs");Ne(this,"paragraphPosToAccCharCount",new Map);this.containerEl=e,this.axis=n,this.direction=i,this.scrollEl=o,this.document=r,this.paragraphs=rn(e),this.paragraphPos=Array(this.paragraphs.length),this.accumulatedCharCount=[];let a=0;this.paragraphs.forEach(l=>{a+=So(l),this.accumulatedCharCount.push(a)}),this.charCount=a}get verticalMode(){return this.axis==="vertical"}updateParagraphPos(e=0){const n=this.scrollEl.getBoundingClientRect(),i=St(this.verticalMode?n.right:n.top,this.direction),o=Number(getComputedStyle(this.containerEl)[this.verticalMode?"paddingRight":"paddingTop"].replace(/px$/,"")),r=new Map;for(let a=0;a<this.paragraphs.length;a+=1){const l=this.paragraphs[a],u=zn(this.document,l),h=(()=>(this.verticalMode?u.width:u.height)<=0?this.paragraphPos[a-1]||0:St(this.verticalMode?u.left:u.bottom,this.direction)-i-o+e)();this.paragraphPos[a]=h;const d=r.get(h)||[];r.set(h,d),d.push(a)}this.paragraphPosToAccCharCount=new Map(Array.from(r.entries()).map(([a,l])=>[a,Math.max(...l.map(u=>this.accumulatedCharCount[u]))]))}calcExploredCharCount(e=0){return this.getCharCountByScrollPos(this.scrollPos+e)}getCharCountByScrollPos(e){const n=$t(this.paragraphPos,e);return this.paragraphPosToAccCharCount.get(this.paragraphPos[n])||0}getBookMarkPosForSection(e,n){const i=Math.max(0,Wr(this.accumulatedCharCount,n-e));let o=i,r=this.processSectionBookmarkIteration(i,e,n);if(!r){for(let a=i+1,{length:l}=this.accumulatedCharCount;a<l;a+=1)if(r=this.processSectionBookmarkIteration(a,e,n),r){o=a;break}}return{bookmarkPos:r,node:r?this.paragraphs[o]:void 0,isFirstNode:o===0}}getScrollPosByCharCount(e){const n=$t(this.accumulatedCharCount,e);return St(this.paragraphPos[n],this.direction)||0}getCharCountToPoint(e){const n=Math.max(0,Gr(this.paragraphs,e));return this.accumulatedCharCount[n-1]||0}processSectionBookmarkIteration(e,n,i){const o=this.accumulatedCharCount[e]+n;let r;if(o>i){let a=this.paragraphs[e];a.parentElement&&(a=a.parentElement.closest("p")||a.parentElement);const{top:l,right:u,left:f}=zn(this.document,a);r=this.axis==="horizontal"?{left:u}:{top:l,left:f}}return r}get scrollPos(){return St(this.scrollEl[this.scrollPosProp],this.direction)}get scrollPosProp(){return this.verticalMode?"scrollLeft":"scrollTop"}}function jr(t,e,n){const i=Yr(e,n)(t,"scrollLeft");return(o,r,a)=>{if(!Xr(o))return;const l=qr(o,r,a);i(-l),o.preventDefault()}}function Xr(t){return!(!t.deltaY||t.deltaX||t.altKey||t.shiftKey||t.ctrlKey||t.metaKey)}function qr(t,e,n){switch(t.deltaMode){case 0:return t.deltaY;case 1:return t.deltaY*e*1.75;default:return t.deltaY*n}}function Yr(t,e){return(n,i)=>{let o=!1,r=t[i],a=t[i];const l=()=>{o=!0;const u=Math.trunc((r-t[i])/n);if(t[i]!==a){o=!1;return}if(a+=u,t.scrollBy(u,0),Math.abs(u)>0){e(l);return}o=!1};return u=>{o||(r=t[i],a=t[i]),r+=u,o||e(l)}}}class Kr{constructor(e,n,i){this.verticalMode=e,this.firstDimensionMargin=n,this.window=i}nextPage(){this.scrollByPercent(.95)}prevPage(){this.scrollByPercent(-.95)}updateSectionDataByOffset(){}scrollTo(e){this.window.scrollTo({[this.verticalMode?"left":"top"]:e})}scrollByPercent(e){let n=this.window.innerHeight,i="top",o=1;this.verticalMode&&(n=this.window.innerWidth,i="left",o=-1);const r=n-this.firstDimensionMargin*2;this.window.scrollBy({[i]:r*e*o,behavior:"smooth"})}}const{document:Ur,window:Jr}=wn;function Hn(t){let e,n,i,o,r;return{c(){e=U("div"),i=$(),o=U("div"),this.h()},l(a){e=J(a,"DIV",{class:!0,style:!0}),Q(e).forEach(E),i=ee(a),o=J(a,"DIV",{class:!0,style:!0}),Q(o).forEach(E),this.h()},h(){X(e,"class","fixed z-[5]"),X(e,"style",n=t[22]+": 100%; "+t[21]+": "+t[15]+"px; "+t[20][0]+": 0"),N(e,"inset-y-0",t[2]),N(e,"inset-x-0",!t[2]),M(e,"background-color",t[4]),X(o,"class","fixed z-[5]"),X(o,"style",r=t[22]+": 100%; "+t[21]+": "+t[15]+"px; "+t[20][1]+": 0"),N(o,"inset-y-0",t[2]),N(o,"inset-x-0",!t[2]),M(o,"background-color",t[4])},m(a,l){A(a,e,l),A(a,i,l),A(a,o,l)},p(a,l){l[0]&7372800&&n!==(n=a[22]+": 100%; "+a[21]+": "+a[15]+"px; "+a[20][0]+": 0")&&X(e,"style",n),l[0]&4&&N(e,"inset-y-0",a[2]),l[0]&4&&N(e,"inset-x-0",!a[2]),l[0]&16&&M(e,"background-color",a[4]),l[0]&7372800&&r!==(r=a[22]+": 100%; "+a[21]+": "+a[15]+"px; "+a[20][1]+": 0")&&X(o,"style",r),l[0]&4&&N(o,"inset-y-0",a[2]),l[0]&4&&N(o,"inset-x-0",!a[2]),l[0]&16&&M(o,"background-color",a[4])},d(a){a&&E(e),a&&E(i),a&&E(o)}}}function Gn(t){let e,n,i,o;const r=[Zr,Qr],a=[];function l(u,f){return u[2]?0:1}return e=l(t),n=a[e]=r[e](t),{c(){n.c(),i=yt()},l(u){n.l(u),i=yt()},m(u,f){a[e].m(u,f),A(u,i,f),o=!0},p(u,f){let h=e;e=l(u),e===h?a[e].p(u,f):(xe(),Y(a[h],1,1,()=>{a[h]=null}),$e(),n=a[e],n?n.p(u,f):(n=a[e]=r[e](u),n.c()),z(n,1),n.m(i.parentNode,i))},i(u){o||(z(n),o=!0)},o(u){Y(n),o=!1},d(u){a[e].d(u),u&&E(i)}}}function Qr(t){let e,n,i;return n=new et({props:{icon:Lt}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(o){e=J(o,"DIV",{class:!0});var r=Q(e);Pe(n.$$.fragment,r),r.forEach(E),this.h()},h(){X(e,"class","pointer-events-none absolute text-sm opacity-25 sm:text-xl"),M(e,"color",t[3]),M(e,"left",t[17]),M(e,"top",`calc(${t[18].top} + 1.5rem)`)},m(o,r){A(o,e,r),ye(n,e,null),i=!0},p(o,r){r[0]&8&&M(e,"color",o[3]),r[0]&131072&&M(e,"left",o[17]),r[0]&262144&&M(e,"top",`calc(${o[18].top} + 1.5rem)`)},i(o){i||(z(n.$$.fragment,o),i=!0)},o(o){Y(n.$$.fragment,o),i=!1},d(o){o&&E(e),Me(n)}}}function Zr(t){let e,n,i;return n=new et({props:{icon:Lt}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(o){e=J(o,"DIV",{class:!0});var r=Q(e);Pe(n.$$.fragment,r),r.forEach(E),this.h()},h(){X(e,"class","pointer-events-none absolute text-xl opacity-25"),M(e,"color",t[3]),M(e,"right",`calc(${t[18].right} + 1rem)`),M(e,"top",t[17])},m(o,r){A(o,e,r),ye(n,e,null),i=!0},p(o,r){r[0]&8&&M(e,"color",o[3]),r[0]&262144&&M(e,"right",`calc(${o[18].right} + 1rem)`),r[0]&131072&&M(e,"top",o[17])},i(o){i||(z(n.$$.fragment,o),i=!0)},o(o){Y(n.$$.fragment,o),i=!1},d(o){o&&E(e),Me(n)}}}function xr(t){let e,n,i=`${t[9]}px`,o=`${t[19]||t[1]}px`,r,a,l,u,f,h;n=new Do({props:{html:t[0]}}),n.$on("load",t[25]);let d=t[15]&&Hn(t),p=t[18]&&Gn(t);return{c(){e=U("div"),ve(n.$$.fragment),r=$(),d&&d.c(),a=$(),p&&p.c(),l=$(),this.h()},l(m){e=J(m,"DIV",{class:!0});var _=Q(e);Pe(n.$$.fragment,_),_.forEach(E),r=ee(m),d&&d.l(m),a=ee(m),p&&p.l(m),l=ee(m),this.h()},h(){X(e,"class","book-content m-auto svelte-1ouz3ba"),N(e,"book-content--writing-vertical-rl",t[2]),N(e,"book-content--writing-horizontal-rl",!t[2]),N(e,"book-content--hide-furigana",t[12]),N(e,"book-content--hide-spoiler-image",t[11]),N(e,"book-content--furigana-style-partial",t[13]===qe.Partial),N(e,"book-content--furigana-style-full",t[13]===qe.Full),N(e,"book-content--furigana-style-toggle",t[13]===qe.Toggle),M(e,"color",t[3]),M(e,"font-size",i),M(e,"line-height",t[10]),M(e,"max-width",!t[2]&&t[14]?`${t[14]}px`:void 0),M(e,"max-height",t[19]?`${t[19]}px`:void 0),M(e,"padding-left",t[2]&&t[15]?`${t[15]}px`:void 0),M(e,"padding-right",t[2]&&t[15]?`${t[15]}px`:void 0),M(e,"padding-top",!t[2]&&t[15]?`${t[15]}px`:void 0),M(e,"padding-bottom",!t[2]&&t[15]?`${t[15]}px`:void 0),M(e,"--font-family-serif",t[7]),M(e,"--font-family-sans-serif",t[8]),M(e,"--book-content-hint-furigana-font-color",t[5]),M(e,"--book-content-hint-furigana-shadow-color",t[6]),M(e,"--book-content-child-height",o)},m(m,_){A(m,e,_),ye(n,e,null),t[47](e),A(m,r,_),d&&d.m(m,_),A(m,a,_),p&&p.m(m,_),A(m,l,_),u=!0,f||(h=[De(Jr,"scroll",t[24]),De(Ur.body,"wheel",t[23],{passive:!1})],f=!0)},p(m,_){const P={};_[0]&1&&(P.html=m[0]),n.$set(P),(!u||_[0]&4)&&N(e,"book-content--writing-vertical-rl",m[2]),(!u||_[0]&4)&&N(e,"book-content--writing-horizontal-rl",!m[2]),(!u||_[0]&4096)&&N(e,"book-content--hide-furigana",m[12]),(!u||_[0]&2048)&&N(e,"book-content--hide-spoiler-image",m[11]),(!u||_[0]&8192)&&N(e,"book-content--furigana-style-partial",m[13]===qe.Partial),(!u||_[0]&8192)&&N(e,"book-content--furigana-style-full",m[13]===qe.Full),(!u||_[0]&8192)&&N(e,"book-content--furigana-style-toggle",m[13]===qe.Toggle),_[0]&8&&M(e,"color",m[3]),_[0]&512&&i!==(i=`${m[9]}px`)&&M(e,"font-size",i),_[0]&1024&&M(e,"line-height",m[10]),_[0]&16388&&M(e,"max-width",!m[2]&&m[14]?`${m[14]}px`:void 0),_[0]&524288&&M(e,"max-height",m[19]?`${m[19]}px`:void 0),_[0]&32772&&M(e,"padding-left",m[2]&&m[15]?`${m[15]}px`:void 0),_[0]&32772&&M(e,"padding-right",m[2]&&m[15]?`${m[15]}px`:void 0),_[0]&32772&&M(e,"padding-top",!m[2]&&m[15]?`${m[15]}px`:void 0),_[0]&32772&&M(e,"padding-bottom",!m[2]&&m[15]?`${m[15]}px`:void 0),_[0]&128&&M(e,"--font-family-serif",m[7]),_[0]&256&&M(e,"--font-family-sans-serif",m[8]),_[0]&32&&M(e,"--book-content-hint-furigana-font-color",m[5]),_[0]&64&&M(e,"--book-content-hint-furigana-shadow-color",m[6]),_[0]&524290&&o!==(o=`${m[19]||m[1]}px`)&&M(e,"--book-content-child-height",o),m[15]?d?d.p(m,_):(d=Hn(m),d.c(),d.m(a.parentNode,a)):d&&(d.d(1),d=null),m[18]?p?(p.p(m,_),_[0]&262144&&z(p,1)):(p=Gn(m),p.c(),z(p,1),p.m(l.parentNode,l)):p&&(xe(),Y(p,1,1,()=>{p=null}),$e())},i(m){u||(z(n.$$.fragment,m),z(p),u=!0)},o(m){Y(n.$$.fragment,m),Y(p),u=!1},d(m){m&&E(e),Me(n),t[47](null),m&&E(r),d&&d.d(m),m&&E(a),p&&p.d(m),m&&E(l),f=!1,mt(h)}}}function $r(t,e,n){let i,o,r,a,l,u;W(t,Pt,y=>n(53,l=y)),W(t,vn,y=>n(46,u=y));let{htmlContent:f}=e,{width:h}=e,{height:d}=e,{verticalMode:p}=e,{fontColor:m}=e,{backgroundColor:_}=e,{hintFuriganaFontColor:P}=e,{hintFuriganaShadowColor:s}=e,{fontFamilyGroupOne:c}=e,{fontFamilyGroupTwo:S}=e,{fontSize:B}=e,{lineHeight:O}=e,{hideSpoilerImage:D}=e,{hideFurigana:K}=e,{furiganaStyle:I}=e,{secondDimensionMaxValue:j}=e,{firstDimensionMargin:H}=e,{autoPositionOnResize:ae}=e,{autoBookmark:k}=e,{loadingState:R}=e,{multiplier:v}=e,{bookmarkData:T}=e,{exploredCharCount:G}=e,{bookCharCount:oe}=e,{autoScroller:x}=e,{bookmarkManager:ie}=e,{pageManager:pe}=e,{customReadingPoint:Ee}=e,{customReadingPointLeft:fe}=e,{customReadingPointTop:Be}=e,{customReadingPointScrollOffset:L}=e;const be=tn();let q,le,te={},he,ke,Re,w,F,ce=0,V=!1,Se=window.matchMedia("(min-width: 640px)").matches?"0.5rem":"0.25rem";const Ce=jr(4,document.documentElement,requestAnimationFrame),Ge=new je,Ae=new je,Fe=new je,Oe=new Map,Ke=new Map;let Le=0,We=!1;_n(()=>{Fe.next(),Fe.complete()}),he=new zr(v,p,Fe,document),x=he,Ot([Ge,Ae]).pipe(nn(()=>ae),Kt(1),Ve(([y,se])=>p?se:y),Eo(),zt(10),po(sn),Qe(Fe)).subscribe(()=>{if(!le||!Re)return;const y=le.getScrollPosByCharCount(ce)+(p?L:-L);V=!0,Re.scrollTo(y)});function Te(){if(!u||!q)return;const{elLeftReferencePoint:y,elTopReferencePoint:se,elRightReferencePoint:Xe,elBottomReferencePoint:Ie,firstDimensionMargin:b,pointGap:re}=To(window,q,p,H);if(p){n(32,Be=se),n(31,fe=Math.min(Math.max(b+(Xe-y)*(Ee/100)-2,y+re),Xe-2)),n(33,L=window.innerWidth-b-fe);return}n(32,Be=Math.min(Math.max(b+(Ie-se)*(Ee/100),b),Ie-re*1.5)),n(31,fe=y),n(33,L=Be-b)}function lt(y){y.updateParagraphPos(),Te(),n(26,G=y.calcExploredCharCount(L)),F&&(F=!1,T.then(se=>{!se||!ie||(ce=se.exploredCharCount||0,ie.scrollToBookmark(se,L))}).finally(()=>{k&&Ye(window,"scroll").pipe(Kt(1),zt(3e3),Qe(Fe)).subscribe(()=>{be("bookmark")}),Mn.pipe(Bt(1),At(se=>se.length?(se.forEach(Xe=>{const Ie=Xe.reference,b=document.getElementById(Ie);b&&(Le||(Le=Number(getComputedStyle(b)[p?"marginLeft":"marginBottom"].replace(/px$/,""))/2),Ke.set(Ie,{...Xe,progress:0}),Oe.set(Ie,b))}),Oe.size?(Ue(),Ye(window,"scroll")):Mt):Mt),Er(()=>un(We?100:500)),Qe(Fe)).subscribe(Ue)})),n(42,te={})}function Ue(){const y=[...Ke.entries()];for(let se=0,{length:Xe}=y;se<Xe;se+=1){const[Ie,b]=y[se],ue=Oe.get(Ie).getBoundingClientRect();b.progress=p?Math.min(Math.max(ue.right+(H||0)-window.innerWidth+L,0),ue.width)/(ue.width||1)*100:Math.abs(Math.min(Math.max(ue.top-(H||0)-L,-ue.height),0))/(ue.height||1)*100,Ke.set(Ie,b)}We=!1,xt.next(Ke)}function st(y){p&&!l&&Ce(y,B,window.innerWidth)}function it(){requestAnimationFrame(()=>{!le||(n(26,G=le.calcExploredCharCount(L)),!V&&G&&(ce=G),V=!1)})}function tt(){!q||(n(41,le=new Ao(q,p?"vertical":"horizontal",p?"rtl":"ltr",document.documentElement,document)),n(26,G=0),ce=G,n(27,oe=le.charCount),be("contentChange",q))}Gt.pipe(Qe(Fe)).subscribe(y=>{let se=document.getElementById(y);if(!se)return;se=!y.startsWith(An)&&se.closest(`div[id^="${An}"]`)||se,We=!0;const Ie=se.getBoundingClientRect();p?window.scrollBy(-(window.innerWidth-Ie.right-(H||0)-L-(!L||L&&Le>L?Le:0)),0):window.scrollBy(0,Ie.top-(H||0)-L-(!L||L&&Le>L?Le:0))});function C(y){ne[y?"unshift":"push"](()=>{q=y,n(16,q)})}return t.$$set=y=>{"htmlContent"in y&&n(0,f=y.htmlContent),"width"in y&&n(34,h=y.width),"height"in y&&n(1,d=y.height),"verticalMode"in y&&n(2,p=y.verticalMode),"fontColor"in y&&n(3,m=y.fontColor),"backgroundColor"in y&&n(4,_=y.backgroundColor),"hintFuriganaFontColor"in y&&n(5,P=y.hintFuriganaFontColor),"hintFuriganaShadowColor"in y&&n(6,s=y.hintFuriganaShadowColor),"fontFamilyGroupOne"in y&&n(7,c=y.fontFamilyGroupOne),"fontFamilyGroupTwo"in y&&n(8,S=y.fontFamilyGroupTwo),"fontSize"in y&&n(9,B=y.fontSize),"lineHeight"in y&&n(10,O=y.lineHeight),"hideSpoilerImage"in y&&n(11,D=y.hideSpoilerImage),"hideFurigana"in y&&n(12,K=y.hideFurigana),"furiganaStyle"in y&&n(13,I=y.furiganaStyle),"secondDimensionMaxValue"in y&&n(14,j=y.secondDimensionMaxValue),"firstDimensionMargin"in y&&n(15,H=y.firstDimensionMargin),"autoPositionOnResize"in y&&n(35,ae=y.autoPositionOnResize),"autoBookmark"in y&&n(36,k=y.autoBookmark),"loadingState"in y&&n(37,R=y.loadingState),"multiplier"in y&&n(38,v=y.multiplier),"bookmarkData"in y&&n(39,T=y.bookmarkData),"exploredCharCount"in y&&n(26,G=y.exploredCharCount),"bookCharCount"in y&&n(27,oe=y.bookCharCount),"autoScroller"in y&&n(28,x=y.autoScroller),"bookmarkManager"in y&&n(29,ie=y.bookmarkManager),"pageManager"in y&&n(30,pe=y.pageManager),"customReadingPoint"in y&&n(40,Ee=y.customReadingPoint),"customReadingPointLeft"in y&&n(31,fe=y.customReadingPointLeft),"customReadingPointTop"in y&&n(32,Be=y.customReadingPointTop),"customReadingPointScrollOffset"in y&&n(33,L=y.customReadingPointScrollOffset)},t.$$.update=()=>{if(t.$$.dirty[0]&4&&n(22,i=p?"height":"width"),t.$$.dirty[0]&4&&n(21,o=p?"width":"height"),t.$$.dirty[0]&4&&n(20,r=p?["left","right"]:["top","bottom"]),t.$$.dirty[1]&8&&Ge.next(h),t.$$.dirty[0]&2&&Ae.next(d),t.$$.dirty[0]&16388&&n(19,a=p&&j?j:void 0),t.$$.dirty[0]&212996&&j&&q){const y=Number(getComputedStyle(q)[p?"marginTop":"marginRight"].replace(/px$/,""));n(17,Se=`min(max(calc(${`${y}px - ${Se}`}), ${Se}), ${y?`${y}px`:Se})`)}if(t.$$.dirty[0]&1&&f&&(F=!0),t.$$.dirty[0]&2|t.$$.dirty[1]&1096&&le&&h&&d&&!R){const y=le;requestAnimationFrame(()=>{lt(y)})}t.$$.dirty[0]&4|t.$$.dirty[1]&4224&&he&&(n(43,he.multiplier=v,he),n(43,he.verticalMode=p,he)),t.$$.dirty[0]&32768|t.$$.dirty[1]&9216&&le&&(n(44,ke=le&&new Nr(le,window,H||0)),n(29,ie=ke)),t.$$.dirty[1]&10496&&te&&(n(18,w=void 0),T.then(y=>{!y||n(18,w=ke==null?void 0:ke.getBookmarkBarPosition(y))})),t.$$.dirty[0]&32772|t.$$.dirty[1]&16384&&(n(45,Re=new Kr(p,H,window)),n(30,pe=Re)),t.$$.dirty[0]&65536|t.$$.dirty[1]&33280&&u&&q&&Number.isFinite(Ee)&&(Te(),it(),Ue())},[f,d,p,m,_,P,s,c,S,B,O,D,K,I,j,H,q,Se,w,a,r,o,i,st,it,tt,G,oe,x,ie,pe,fe,Be,L,h,ae,k,R,v,T,Ee,le,te,he,ke,Re,u,C]}class ea extends ct{constructor(e){super(),ht(this,e,$r,xr,dt,{htmlContent:0,width:34,height:1,verticalMode:2,fontColor:3,backgroundColor:4,hintFuriganaFontColor:5,hintFuriganaShadowColor:6,fontFamilyGroupOne:7,fontFamilyGroupTwo:8,fontSize:9,lineHeight:10,hideSpoilerImage:11,hideFurigana:12,furiganaStyle:13,secondDimensionMaxValue:14,firstDimensionMargin:15,autoPositionOnResize:35,autoBookmark:36,loadingState:37,multiplier:38,bookmarkData:39,exploredCharCount:26,bookCharCount:27,autoScroller:28,bookmarkManager:29,pageManager:30,customReadingPoint:40,customReadingPointLeft:31,customReadingPointTop:32,customReadingPointScrollOffset:33},null,[-1,-1,-1])}}const ta="px-4 md:px-8";function na(t){const e=Array.from(t.getElementsByTagName("img"));return new at(n=>{const i=e.filter(r=>r.src).map(oa);if(i.length<=0){n.next(!1),n.complete();return}const o=Ot(i).subscribe(()=>{n.next(!1),n.complete()});return n.next(!0),o})}function oa(t){return t.complete?yn(1):yr(Ye(t,"load"),Ye(t,"error"))}function ia(t,e){const n=ra(t),i=la(t);return o=>Ht(n(o),aa(o,e),i(o))}function ra(t){return e=>{const n=Array.from(e.getElementsByTagName("a"));n.forEach(o=>{o.href=t.location.pathname+o.hash});const i=n.map(o=>en(o).pipe(rt(()=>Gt.next(o.hash.substring(1)))));return Ht(...i)}}function aa(t,e){const n=e===qe.Toggle,o=Array.from(t.getElementsByTagName("ruby")).map(r=>n?en(r).pipe(rt(()=>{r.classList.toggle("reveal-rt")})):en(r).pipe(Bt(1),rt(()=>{r.classList.add("reveal-rt")})));return Ht(...o)}function la(t){return e=>{const i=Array.from(e.querySelectorAll("[data-ttu-spoiler-img]")).map(o=>{const r=t.createElement("span");return r.classList.add("spoiler-label"),r.setAttribute("aria-hidden","true"),r.innerText="ネタバレ",o.appendChild(r),en(o).pipe(Bt(1),rt(()=>{o.removeChild(r),o.removeAttribute("data-ttu-spoiler-img")}))});return Ht(...i)}}function en(t){return Ye(t,"click").pipe(rt(e=>{e.preventDefault(),e.stopImmediatePropagation()}))}const sa=300,ua=60,Vo="none";function Ft(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function fa(t,e){return e.filter(n=>t.pointerId!==n.pointerId)}function Wt(t,e,n,i,o){t.dispatchEvent(new CustomEvent(`${e}${o}`,{detail:{event:n,pointersCount:i.length}}))}function ca(t,e,n,i,o,r=Vo){e.style.touchAction=r;let a=[];function l(f){a.push(f),Wt(e,t,f,a,"down"),i==null||i(a,f);const h=f.pointerId;function d(c){h===c.pointerId&&(a=fa(c,a),a.length||p(),Wt(e,t,c,a,"up"),o==null||o(a,c))}function p(){m(),_(),P(),s()}const m=Ft(e,"pointermove",c=>{a=a.map(S=>c.pointerId===S.pointerId?c:S),Wt(e,t,c,a,"move"),n==null||n(a,c)}),_=Ft(e,"lostpointercapture",c=>{d(c)}),P=Ft(e,"pointerup",c=>{d(c)}),s=Ft(e,"pointerleave",c=>{a=[],p(),Wt(e,t,c,a,"up"),o==null||o(a,c)})}const u=Ft(e,"pointerdown",l);return{destroy:()=>{u()}}}function ha(t,e={timeframe:sa,minSwipeDistance:ua,touchAction:Vo}){const n="swipe";let i,o,r,a;function l(f,h){o=h.clientX,r=h.clientY,i=Date.now(),f.length===1&&(a=h.target)}function u(f,h){if(h.type==="pointerup"&&f.length===0&&Date.now()-i<e.timeframe){const d=h.clientX-o,p=h.clientY-r,m=Math.abs(d),_=Math.abs(p);let P=null;m>=2*_&&m>e.minSwipeDistance?P=d>0?"right":"left":_>=2*m&&_>e.minSwipeDistance&&(P=p>0?"bottom":"top"),P&&t.dispatchEvent(new CustomEvent(n,{detail:{direction:P,target:a}}))}}return ca(n,t,null,l,u,e.touchAction)}class da{constructor(e,n,i,o,r){this.calculator=e,this.pageManager=n,this.sectionReady$=i,this.sectionIndex$=o,this.setIntendedCharCount=r}scrollToBookmark(e){const n=e.exploredCharCount;if(!n)return;const i=this.calculator.getSectionIndexByCharCount(n),o=l=>{const u=l.getScrollPosByCharCount(n);this.pageManager.scrollTo(u,!1),this.setIntendedCharCount(n)};if(this.sectionIndex$.getValue()===i){o(this.calculator);return}const a=this.sectionReady$.subscribe(l=>{o(l),a.unsubscribe()});this.sectionIndex$.next(i)}formatBookmarkData(e){return this.formatBookmarkDataByRange(e,void 0)}formatBookmarkDataByRange(e,n){const i=this.calculator.calcExploredCharCount(n),o=this.calculator.charCount;return{dataId:e,exploredCharCount:i,progress:i/o,lastBookmarkModified:new Date().getTime()}}}class ma{constructor(e,n,i,o,r,a,l,u,f,h,d){Ne(this,"translateX",0);Ne(this,"sectionData",new Map);this.contentEl=e,this.scrollEl=n,this.sections=i,this.sectionIndex$=o,this.virtualScrollPos$=r,this.width=a,this.height=l,this.pageGap=u,this.verticalMode=f,this.pageChange$=h,this.sectionRenderComplete$=d,Mn.pipe(Bt(1)).subscribe(p=>{!p.length||(p.forEach(m=>{this.sectionData.set(m.reference,{...m,progress:0})}),xt.next(this.sectionData))})}nextPage(){this.flipPage(1)}prevPage(){this.flipPage(-1)}updateSectionDataByOffset(e=0){var o,r;const n=this.verticalMode?this.height:this.width,i=this.virtualScrollPos$.getValue()/this.scrollEl[this.verticalMode?"scrollHeight":"scrollWidth"]*100;if(e){const l=(this.virtualScrollPos$.getValue()+n+this.pageGap)/this.scrollEl[this.verticalMode?"scrollHeight":"scrollWidth"]*100-i;this.updateSectionData((o=this.sections[this.sectionIndex$.getValue()])==null?void 0:o.id,i+l*e)}else this.updateSectionData((r=this.sections[this.sectionIndex$.getValue()])==null?void 0:r.id,i)}flipPage(e){const n=this.verticalMode?"scrollHeight":"scrollWidth",i=this.verticalMode?this.height:this.width,o=i+this.pageGap,r=!0;if(this.translateX){const d=()=>{this.contentEl.style.removeProperty("transform"),this.translateX=0};if(e<0){const p=this.translateX;d(),this.scrollToPos(-p-o,r);return}if(this.nextSection(r)){d();return}return}const a=0,l=this.scrollEl[n],u=this.virtualScrollPos$.getValue(),f=u+o*e,h=Math.ceil(f);if(h<a){if(u!==a){this.scrollToPos(a,r);return}this.prevSection(o,n,i,r);return}if(h>=l){this.nextSection(r);return}this.scrollOrTranslateToPos(f,l,i,r)}scrollTo(e,n){const i=this.verticalMode?"scrollHeight":"scrollWidth",o=this.verticalMode?this.height:this.width;this.scrollOrTranslateToPos(e,this.scrollEl[i],o,n)}prevSection(e,n,i,o){const r=this.sectionIndex$.getValue()-1;return r<0?!1:(this.updateSectionIndex(r).subscribe(()=>{const a=this.scrollEl[n];let l=e*(Math.ceil(a/e)-1);Math.ceil(l)>=a&&(l-=e),this.scrollOrTranslateToPos(l,a,i,o)}),!0)}nextSection(e){const n=this.sectionIndex$.getValue()+1;return n>=this.sections.length?!1:(this.updateSectionIndex(n).subscribe(()=>{var i,o;this.scrollToPos(0,e),this.updateSectionData((i=this.sections[n-1])==null?void 0:i.id,100,!1),this.updateSectionData((o=this.sections[n])==null?void 0:o.id,0)}),!0)}scrollOrTranslateToPos(e,n,i,o){var a;if(this.updateSectionData((a=this.sections[this.sectionIndex$.getValue()])==null?void 0:a.id,e/n*100),this.verticalMode){this.scrollToPos(e,o);return}if(e+i<=n){this.scrollToPos(e,o);return}this.translateXToPos(-e,o)}scrollToPos(e,n){this.virtualScrollPos$.next(e),this.scrollEl.scrollTo({[this.verticalMode?"top":"left"]:e}),this.pageChange$.next(n)}translateXToPos(e,n){this.virtualScrollPos$.next(-e),this.contentEl.style.transform=`translateX(${e}px)`,this.translateX=e,this.pageChange$.next(n)}updateSectionIndex(e){return new at(n=>{if(this.sectionIndex$.getValue()===e){n.next(),n.complete();return}const i=this.sectionRenderComplete$.subscribe(o=>{o===e&&n.next(),n.complete(),i.unsubscribe()});return this.sectionIndex$.next(e),i})}updateSectionData(e,n,i=!0){if(!e||!this.sectionData.has(e))return;const o=[...this.sectionData.values()];let r=!1;o.forEach(a=>{const l=this.sectionData.get(a.reference),u=a.reference===e;u?l.progress=n:r?l.progress=0:l.progress=100,!r&&u&&(r=!0),this.sectionData.set(a.reference,l)}),i&&xt.next(this.sectionData)}}class ga{constructor(e,n,i,o,r,a,l,u,f){Ne(this,"charCount");Ne(this,"sectionAccCharCounts");Ne(this,"sectionIndex",-1);Ne(this,"calculator");this.containerEl=e,this.sections=n,this.virtualScrollPos$=i,this.getWidth=o,this.getHeight=r,this.getPageGap=a,this.verticalMode=l,this.scrollEl=u,this.document=f;const h=p=>rn(p).reduce((_,P)=>_+So(P),0);let d=0;this.sectionAccCharCounts=n.map(p=>(d+=h(p),d)),this.charCount=d}updateCurrentSection(e){this.calculator=new Ao(this.containerEl,this.verticalMode?"horizontal":"vertical","ltr",this.scrollEl,this.document),this.sectionIndex=e}updateParagraphPos(){!this.calculator||this.calculator.updateParagraphPos(this.virtualScrollPos$.getValue())}calcExploredCharCount(e){if(e&&this.calculator)return this.getSectionStartCount()+this.calculator.getCharCountToPoint(e);const n=this.verticalMode?0:-this.screenSize;return this.getCharCountByScrollPos(this.virtualScrollPos$.getValue()+n)}getCharCountByScrollPos(e){if(!this.calculator)return-1;const n=this.getSectionStartCount();return this.calculator.getCharCountByScrollPos(e)+n}getSectionIndexByCharCount(e){return $t(this.sectionAccCharCounts,e)+1}getScrollPosByCharCount(e){if(!this.calculator)return-1;const n=this.getSectionStartCount(),i=this.sectionAccCharCounts[this.sectionIndex],o=e-n,r=e===i&&i-n>0;if(o<0||e>i||r)return-1;if(o===0)return 0;const a=$t(this.calculator.accumulatedCharCount,o),{accumulatedCharCount:l,paragraphPos:u}=this.calculator,f=l[a];if(Number.isNaN(Number(u[a])))return-1;const h=(P,s)=>P>=s?s:l[P]>f?P:h(P+1,s),d=u[h(a+1,l.length-1)],{screenSize:p}=this,m=this.verticalMode?-1:0,_=p*(Math.ceil(d/p)+m);return St(_,this.calculator.direction)}checkBookmarkOnScreen(e){const n=this.getScrollPosByCharCount(e),i=this.virtualScrollPos$.getValue();return n===i&&this.calculator?{isBookmarkScreen:!0,...this.calculator.getBookMarkPosForSection(this.getSectionStartCount(),e)}:{isBookmarkScreen:n===i,bookmarkPos:void 0,node:void 0,isFirstNode:!0}}getOffsetToRange(e,n){if(!e)return 0;const i=e.getBoundingClientRect();if(this.verticalMode)return 1-i.left/this.screenSizeMirrored;const o=Math.floor(100/n),r=Math.floor(this.screenSize/n),a=o*i.bottom/this.screenSizeMirrored;let l=a,u=0;for(let f=0;f<this.screenSize&&i.right>=f;f+=r)l=u*o+a,u+=1;return l/100}getSectionStartCount(){return this.sectionAccCharCounts[this.sectionIndex-1]||0}get screenSize(){return(this.verticalMode?this.getHeight():this.getWidth())+this.getPageGap()}get screenSizeMirrored(){return(this.verticalMode?this.getWidth():this.getHeight())+this.getPageGap()}}const{window:ka}=wn;function Wn(t){let e,n,i;return n=new et({props:{icon:tr,spin:!0}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(o){e=J(o,"DIV",{class:!0});var r=Q(e);Pe(n.$$.fragment,r),r.forEach(E),this.h()},h(){X(e,"class","fixed inset-0 flex h-full w-full items-center justify-center text-7xl"),M(e,"color",t[4]),M(e,"background-color",t[5])},m(o,r){A(o,e,r),ye(n,e,null),i=!0},p(o,r){r[0]&16&&M(e,"color",o[4]),r[0]&32&&M(e,"background-color",o[5])},i(o){i||(z(n.$$.fragment,o),i=!0)},o(o){Y(n.$$.fragment,o),i=!1},d(o){o&&E(e),Me(n)}}}function jn(t){let e,n,i;return n=new et({props:{icon:Lt}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(o){e=J(o,"DIV",{class:!0});var r=Q(e);Pe(n.$$.fragment,r),r.forEach(E),this.h()},h(){X(e,"class","fixed h-3 w-3 text-base opacity-25 sm:text-xl"),M(e,"color",t[4]),M(e,"top",t[21]),M(e,"left",t[22]),M(e,"right",t[23])},m(o,r){A(o,e,r),ye(n,e,null),i=!0},p(o,r){r[0]&16&&M(e,"color",o[4]),r[0]&2097152&&M(e,"top",o[21]),r[0]&4194304&&M(e,"left",o[22]),r[0]&8388608&&M(e,"right",o[23])},i(o){i||(z(n.$$.fragment,o),i=!0)},o(o){Y(n.$$.fragment,o),i=!1},d(o){o&&E(e),Me(n)}}}function pa(t){let e,n,i,o=`${t[10]}px`,r=`${t[1]}px`,a=`${t[2]}px`,l=`${t[3]?t[1]:(t[1]+vt)/t[24]-vt}px`,u,f,h,d,p,m;i=new Do({props:{html:t[20]}}),i.$on("load",t[25]);let _=!t[19]&&Wn(t),P=t[0]&&jn(t);return{c(){e=U("div"),n=U("div"),ve(i.$$.fragment),u=$(),_&&_.c(),f=$(),P&&P.c(),h=yt(),this.h()},l(s){e=J(s,"DIV",{class:!0});var c=Q(e);n=J(c,"DIV",{class:!0});var S=Q(n);Pe(i.$$.fragment,S),S.forEach(E),c.forEach(E),u=ee(s),_&&_.l(s),f=ee(s),P&&P.l(s),h=yt(),this.h()},h(){X(n,"class","book-content-container svelte-u9j5ct"),X(e,"class","book-content m-auto svelte-u9j5ct"),N(e,"book-content--avoid-page-break",t[15]),N(e,"book-content--writing-vertical-rl",t[3]),N(e,"book-content--writing-horizontal-rl",!t[3]),N(e,"book-content--hide-furigana",t[13]),N(e,"book-content--hide-spoiler-image",t[12]),N(e,"book-content--furigana-style-partial",t[14]===qe.Partial),N(e,"book-content--furigana-style-full",t[14]===qe.Full),N(e,"book-content--furigana-style-toggle",t[14]===qe.Toggle),M(e,"color",t[4]),M(e,"font-size",o),M(e,"line-height",t[11]),M(e,"padding-top",!t[3]&&t[16]?`${t[16]}px`:void 0),M(e,"padding-bottom",!t[3]&&t[16]?`${t[16]}px`:void 0),M(e,"padding-left",t[3]&&t[16]?`${t[16]}px`:void 0),M(e,"padding-right",t[3]&&t[16]?`${t[16]}px`:void 0),M(e,"max-width",t[1]?`${t[1]}px`:void 0),M(e,"max-height",t[3]&&t[2]?`${t[2]}px`:void 0),M(e,"--font-family-serif",t[8]),M(e,"--font-family-sans-serif",t[9]),M(e,"--book-content-hint-furigana-font-color",t[6]),M(e,"--book-content-hint-furigana-shadow-color",t[7]),M(e,"--book-content-child-width",r),M(e,"--book-content-child-height",a),M(e,"--book-content-child-column-width",!t[3]&&t[24]===1?`${t[1]}px`:""),M(e,"--book-content-column-count",t[24]),M(e,"--book-content-image-max-width",l)},m(s,c){A(s,e,c),Z(e,n),ye(i,n,null),t[43](n),t[44](e),A(s,u,c),_&&_.m(s,c),A(s,f,c),P&&P.m(s,c),A(s,h,c),d=!0,p||(m=[De(ka,"keydown",t[27]),Sn(ha.call(null,e,{timeframe:500,minSwipeDistance:10,touchAction:"pan-y"})),De(e,"swipe",t[26])],p=!0)},p(s,c){const S={};c[0]&1048576&&(S.html=s[20]),i.$set(S),(!d||c[0]&32768)&&N(e,"book-content--avoid-page-break",s[15]),(!d||c[0]&8)&&N(e,"book-content--writing-vertical-rl",s[3]),(!d||c[0]&8)&&N(e,"book-content--writing-horizontal-rl",!s[3]),(!d||c[0]&8192)&&N(e,"book-content--hide-furigana",s[13]),(!d||c[0]&4096)&&N(e,"book-content--hide-spoiler-image",s[12]),(!d||c[0]&16384)&&N(e,"book-content--furigana-style-partial",s[14]===qe.Partial),(!d||c[0]&16384)&&N(e,"book-content--furigana-style-full",s[14]===qe.Full),(!d||c[0]&16384)&&N(e,"book-content--furigana-style-toggle",s[14]===qe.Toggle),c[0]&16&&M(e,"color",s[4]),c[0]&1024&&o!==(o=`${s[10]}px`)&&M(e,"font-size",o),c[0]&2048&&M(e,"line-height",s[11]),c[0]&65544&&M(e,"padding-top",!s[3]&&s[16]?`${s[16]}px`:void 0),c[0]&65544&&M(e,"padding-bottom",!s[3]&&s[16]?`${s[16]}px`:void 0),c[0]&65544&&M(e,"padding-left",s[3]&&s[16]?`${s[16]}px`:void 0),c[0]&65544&&M(e,"padding-right",s[3]&&s[16]?`${s[16]}px`:void 0),c[0]&2&&M(e,"max-width",s[1]?`${s[1]}px`:void 0),c[0]&12&&M(e,"max-height",s[3]&&s[2]?`${s[2]}px`:void 0),c[0]&256&&M(e,"--font-family-serif",s[8]),c[0]&512&&M(e,"--font-family-sans-serif",s[9]),c[0]&64&&M(e,"--book-content-hint-furigana-font-color",s[6]),c[0]&128&&M(e,"--book-content-hint-furigana-shadow-color",s[7]),c[0]&2&&r!==(r=`${s[1]}px`)&&M(e,"--book-content-child-width",r),c[0]&4&&a!==(a=`${s[2]}px`)&&M(e,"--book-content-child-height",a),c[0]&16777226&&M(e,"--book-content-child-column-width",!s[3]&&s[24]===1?`${s[1]}px`:""),c[0]&16777216&&M(e,"--book-content-column-count",s[24]),c[0]&16777226&&l!==(l=`${s[3]?s[1]:(s[1]+vt)/s[24]-vt}px`)&&M(e,"--book-content-image-max-width",l),s[19]?_&&(xe(),Y(_,1,1,()=>{_=null}),$e()):_?(_.p(s,c),c[0]&524288&&z(_,1)):(_=Wn(s),_.c(),z(_,1),_.m(f.parentNode,f)),s[0]?P?(P.p(s,c),c[0]&1&&z(P,1)):(P=jn(s),P.c(),z(P,1),P.m(h.parentNode,h)):P&&(xe(),Y(P,1,1,()=>{P=null}),$e())},i(s){d||(z(i.$$.fragment,s),z(_),z(P),d=!0)},o(s){Y(i.$$.fragment,s),Y(_),Y(P),d=!1},d(s){s&&E(e),Me(i),t[43](null),t[44](null),s&&E(u),_&&_.d(s),s&&E(f),P&&P.d(s),s&&E(h),p=!1,mt(m)}}}const Xn="overflow-hidden",vt=40;function ba(t,e,n){let i,o,r,a,l;W(t,Pt,b=>n(49,o=b)),W(t,bo,b=>n(50,r=b)),W(t,Pn,b=>n(51,a=b)),W(t,Co,b=>n(52,l=b));let{htmlContent:u}=e,{width:f}=e,{height:h}=e,{verticalMode:d}=e,{fontColor:p}=e,{backgroundColor:m}=e,{hintFuriganaFontColor:_}=e,{hintFuriganaShadowColor:P}=e,{fontFamilyGroupOne:s}=e,{fontFamilyGroupTwo:c}=e,{fontSize:S}=e,{lineHeight:B}=e,{hideSpoilerImage:O}=e,{hideFurigana:D}=e,{furiganaStyle:K}=e,{loadingState:I}=e,{bookmarkData:j}=e,{pageManager:H}=e,{bookmarkManager:ae}=e,{exploredCharCount:k}=e,{bookCharCount:R}=e,{isBookmarkScreen:v=!1}=e,{avoidPageBreak:T=!0}=e,{pageColumns:G}=e,{firstDimensionMargin:oe}=e,{autoBookmark:x=!1}=e,{customReadingPointRange:ie}=e,{showCustomReadingPoint:pe}=e;const Ee=tn();let fe,Be,L,be=[],q,le,te,he=!1,ke="",Re=!0,w=0,F=!1,ce,V,Se;const Ce=new je,Ge=new je,Ae=new Jt(-1),Fe=new je,Oe=new Jt(0),Ke=new je,Le=new je,We=Ae.pipe(Ve(b=>{var re;return((re=be[b])==null?void 0:re.innerHTML)||""})),Te=new je;_n(()=>{document.body.classList.remove(Xn),Te.next(),Te.complete()}),Ot([Ce,Ge]).pipe(Kt(1),At(()=>Le.pipe(Bt(1))),Qe(Te)).subscribe(()=>{if(!L||!q)return;const b=L.getScrollPosByCharCount(w);b<0||q.scrollTo(b,!1)}),Fe.pipe(Qe(Te)).subscribe(b=>{var re;!L||(n(33,pe=!1),Tt((re=ie==null?void 0:ie.endContainer)==null?void 0:re.parentElement,"remove",1),n(28,ie=void 0),n(31,k=L.calcExploredCharCount(ie)),b&&(w=k,l&&Fo(window)),j.then(tt))}),x&&Fe.pipe(zt(3e3),Qe(Te)).subscribe(b=>{b&&Ee("bookmark")}),We.pipe(Eo(),Qe(Te)).subscribe(()=>{n(19,he=!1)}),We.pipe(Qe(Te)).subscribe(b=>{const re=(ue,Ze)=>{if(Ze===0){ue();return}requestAnimationFrame(()=>re(ue,Ze-1))};re(()=>{n(20,ke=b)},2)}),wt(()=>Ye(document.body,"wheel",{passive:!0})).pipe(Ir(50),Qe(Te)).subscribe(b=>{if(!o){let re=(b.deltaX<0?-1:1)*(d?-1:1);b.deltaX||(re=b.deltaY<0?-1:1),q==null||q.flipPage(re)}});function lt(b){!L||(n(31,k=L.calcExploredCharCount(b)),w=k,Ue(b))}function Ue(b){!q||!L||q.updateSectionDataByOffset(L.getOffsetToRange(b,i))}function st(){if(Re){Re=!1;return}!fe||(n(39,L=new ga(fe,be,Oe,()=>f,()=>h,()=>vt,d,fe,document)),n(31,k=0),w=0,n(32,R=L.charCount),L.updateCurrentSection(Ae.getValue()),Ee("contentChange",fe))}function it(b){b.updateParagraphPos(),n(31,k=b.calcExploredCharCount(ie)),Le.next(b),j.then(tt),te&&(te=!1,j.then(re=>{!re||!ae||(n(31,k=re.exploredCharCount||0),ae.scrollToBookmark(re))})),n(19,he=!0)}function tt(b){const re=b==null?void 0:b.exploredCharCount;if(!L||!re)return;const ue=L.checkBookmarkOnScreen(re);if(fe&&ue.isBookmarkScreen){const Ze=Number(getComputedStyle(fe)[d?"marginTop":"marginRight"].replace(/px$/,""));ue.bookmarkPos?d?(n(21,ce=Ze?`${Ze}px`:"0.5rem"),n(22,V=`${ue.bookmarkPos.left}px`),n(23,Se=void 0)):(n(21,ce=`${ue.bookmarkPos.top}px`),n(23,Se=void 0),n(22,V=ue.bookmarkPos.left>0?`calc(${ue.bookmarkPos.left}px - ${a?"15":"20"}px)`:`calc(${Math.max(a?15:20,Ze)}px)`)):C(Ze)}else C(0);ue.isBookmarkScreen&&b.exploredCharCount&&(ue.node&&!F&&!ue.isFirstNode?Ue(En(ue.node)):ue.isFirstNode&&Ue(void 0),n(31,k=F?k:b.exploredCharCount),w=k,F=!0),n(0,v=ue.isBookmarkScreen)}function C(b){d?(n(21,ce=b?`${b}px`:"0.5rem"),n(22,V=r?`${f-r}px`:void 0),n(23,Se=r?void 0:"0.75rem")):(n(21,ce=r?`${r}px`:"0.5rem"),n(22,V=b?`calc(${b}px + 0.75rem)`:"0.75rem"),n(23,Se=void 0))}function y(b){if(!q||o||b.detail.direction!=="left"&&b.detail.direction!=="right")return;const re=b.detail.direction==="left",ue=d?!re:re;q.flipPage(ue?1:-1)}function se(b){if(!(!q||o))switch(b.code){case"ArrowLeft":q[d?"nextPage":"prevPage"]();break;case"ArrowRight":q[d?"prevPage":"nextPage"]();break;case"ArrowUp":q.prevPage();break;case"ArrowDown":q.nextPage();break}}Gt.pipe(Qe(Te)).subscribe(b=>{const re=be.findIndex(ue=>ue.id===b||ue.querySelector(`[id="${b}"]`));re>-1&&(Ae.next(re),q==null||q.scrollTo(0,!0))});function Xe(b){ne[b?"unshift":"push"](()=>{Be=b,n(18,Be)})}function Ie(b){ne[b?"unshift":"push"](()=>{fe=b,n(17,fe)})}return t.$$set=b=>{"htmlContent"in b&&n(34,u=b.htmlContent),"width"in b&&n(1,f=b.width),"height"in b&&n(2,h=b.height),"verticalMode"in b&&n(3,d=b.verticalMode),"fontColor"in b&&n(4,p=b.fontColor),"backgroundColor"in b&&n(5,m=b.backgroundColor),"hintFuriganaFontColor"in b&&n(6,_=b.hintFuriganaFontColor),"hintFuriganaShadowColor"in b&&n(7,P=b.hintFuriganaShadowColor),"fontFamilyGroupOne"in b&&n(8,s=b.fontFamilyGroupOne),"fontFamilyGroupTwo"in b&&n(9,c=b.fontFamilyGroupTwo),"fontSize"in b&&n(10,S=b.fontSize),"lineHeight"in b&&n(11,B=b.lineHeight),"hideSpoilerImage"in b&&n(12,O=b.hideSpoilerImage),"hideFurigana"in b&&n(13,D=b.hideFurigana),"furiganaStyle"in b&&n(14,K=b.furiganaStyle),"loadingState"in b&&n(35,I=b.loadingState),"bookmarkData"in b&&n(36,j=b.bookmarkData),"pageManager"in b&&n(29,H=b.pageManager),"bookmarkManager"in b&&n(30,ae=b.bookmarkManager),"exploredCharCount"in b&&n(31,k=b.exploredCharCount),"bookCharCount"in b&&n(32,R=b.bookCharCount),"isBookmarkScreen"in b&&n(0,v=b.isBookmarkScreen),"avoidPageBreak"in b&&n(15,T=b.avoidPageBreak),"pageColumns"in b&&n(37,G=b.pageColumns),"firstDimensionMargin"in b&&n(16,oe=b.firstDimensionMargin),"autoBookmark"in b&&n(38,x=b.autoBookmark),"customReadingPointRange"in b&&n(28,ie=b.customReadingPointRange),"showCustomReadingPoint"in b&&n(33,pe=b.showCustomReadingPoint)},t.$$.update=()=>{if(t.$$.dirty[1]&32&&j.then(b=>{F=!1,tt(b)}),t.$$.dirty[0]&2&&f&&Ce.next(f),t.$$.dirty[0]&4&&h&&Ge.next(h),t.$$.dirty[0]&10|t.$$.dirty[1]&64&&n(24,i=d?1:G||Math.ceil(f/1e3)),t.$$.dirty[1]&8&&u&&(te=!0),t.$$.dirty[1]&8){const b=document.createElement("div");b.innerHTML=u,n(40,be=Array.from(b.children)),Ae.next(0)}if(t.$$.dirty[0]&393230|t.$$.dirty[1]&1536&&Be&&fe&&be&&(n(41,q=new ma(Be,fe,be,Ae,Oe,f,h,vt,d,Fe,Ke)),n(29,H=q)),t.$$.dirty[0]&6|t.$$.dirty[1]&272&&L&&f&&h&&!I){const b=L;requestAnimationFrame(()=>{it(b)})}t.$$.dirty[1]&272&&L&&!I&&Ke.next(Ae.getValue()),t.$$.dirty[1]&3328&&L&&q&&(n(42,le=new da(L,q,Le,Ae,b=>w=b)),n(30,ae=le)),t.$$.dirty[0]&268435456&&lt(ie)},document.body.classList.add(Xn),[v,f,h,d,p,m,_,P,s,c,S,B,O,D,K,T,oe,fe,Be,he,ke,ce,V,Se,i,st,y,se,ie,H,ae,k,R,pe,u,I,j,G,x,L,be,q,le,Xe,Ie]}class Ca extends ct{constructor(e){super(),ht(this,e,ba,pa,dt,{htmlContent:34,width:1,height:2,verticalMode:3,fontColor:4,backgroundColor:5,hintFuriganaFontColor:6,hintFuriganaShadowColor:7,fontFamilyGroupOne:8,fontFamilyGroupTwo:9,fontSize:10,lineHeight:11,hideSpoilerImage:12,hideFurigana:13,furiganaStyle:14,loadingState:35,bookmarkData:36,pageManager:29,bookmarkManager:30,exploredCharCount:31,bookCharCount:32,isBookmarkScreen:0,avoidPageBreak:15,pageColumns:37,firstDimensionMargin:16,autoBookmark:38,customReadingPointRange:28,showCustomReadingPoint:33},null,[-1,-1,-1])}}function _a(t){let e,n,i,o,r,a,l,u;function f(s){t[48](s)}function h(s){t[49](s)}function d(s){t[50](s)}function p(s){t[51](s)}function m(s){t[52](s)}function _(s){t[53](s)}let P={htmlContent:t[7],width:t[28]??0,height:t[29]??0,verticalMode:t[8],fontColor:t[9],backgroundColor:t[10],hintFuriganaFontColor:t[11],hintFuriganaShadowColor:t[12],fontSize:t[13],fontFamilyGroupOne:t[14],fontFamilyGroupTwo:t[15],hideSpoilerImage:t[16],hideFurigana:t[17],furiganaStyle:t[18],loadingState:t[30]??!0,avoidPageBreak:t[22],pageColumns:t[23],autoBookmark:t[24],firstDimensionMargin:t[20]};return t[0]!==void 0&&(P.exploredCharCount=t[0]),t[1]!==void 0&&(P.bookCharCount=t[1]),t[6]!==void 0&&(P.isBookmarkScreen=t[6]),t[2]!==void 0&&(P.bookmarkData=t[2]),t[4]!==void 0&&(P.bookmarkManager=t[4]),t[5]!==void 0&&(P.pageManager=t[5]),e=new Ca({props:P}),ne.push(()=>me(e,"exploredCharCount",f,t[0])),ne.push(()=>me(e,"bookCharCount",h,t[1])),ne.push(()=>me(e,"isBookmarkScreen",d,t[6])),ne.push(()=>me(e,"bookmarkData",p,t[2])),ne.push(()=>me(e,"bookmarkManager",m,t[4])),ne.push(()=>me(e,"pageManager",_,t[5])),e.$on("contentChange",t[54]),e.$on("bookmark",t[55]),{c(){ve(e.$$.fragment)},l(s){Pe(e.$$.fragment,s)},m(s,c){ye(e,s,c),u=!0},p(s,c){const S={};c[0]&128&&(S.htmlContent=s[7]),c[0]&268435456&&(S.width=s[28]??0),c[0]&536870912&&(S.height=s[29]??0),c[0]&256&&(S.verticalMode=s[8]),c[0]&512&&(S.fontColor=s[9]),c[0]&1024&&(S.backgroundColor=s[10]),c[0]&2048&&(S.hintFuriganaFontColor=s[11]),c[0]&4096&&(S.hintFuriganaShadowColor=s[12]),c[0]&8192&&(S.fontSize=s[13]),c[0]&16384&&(S.fontFamilyGroupOne=s[14]),c[0]&32768&&(S.fontFamilyGroupTwo=s[15]),c[0]&65536&&(S.hideSpoilerImage=s[16]),c[0]&131072&&(S.hideFurigana=s[17]),c[0]&262144&&(S.furiganaStyle=s[18]),c[0]&1073741824&&(S.loadingState=s[30]??!0),c[0]&4194304&&(S.avoidPageBreak=s[22]),c[0]&8388608&&(S.pageColumns=s[23]),c[0]&16777216&&(S.autoBookmark=s[24]),c[0]&1048576&&(S.firstDimensionMargin=s[20]),!n&&c[0]&1&&(n=!0,S.exploredCharCount=s[0],ge(()=>n=!1)),!i&&c[0]&2&&(i=!0,S.bookCharCount=s[1],ge(()=>i=!1)),!o&&c[0]&64&&(o=!0,S.isBookmarkScreen=s[6],ge(()=>o=!1)),!r&&c[0]&4&&(r=!0,S.bookmarkData=s[2],ge(()=>r=!1)),!a&&c[0]&16&&(a=!0,S.bookmarkManager=s[4],ge(()=>a=!1)),!l&&c[0]&32&&(l=!0,S.pageManager=s[5],ge(()=>l=!1)),e.$set(S)},i(s){u||(z(e.$$.fragment,s),u=!0)},o(s){Y(e.$$.fragment,s),u=!1},d(s){Me(e,s)}}}function wa(t){let e,n,i,o,r,a,l,u;function f(s){t[40](s)}function h(s){t[41](s)}function d(s){t[42](s)}function p(s){t[43](s)}function m(s){t[44](s)}function _(s){t[45](s)}let P={htmlContent:t[7],width:t[28]??0,height:t[29]??0,verticalMode:t[8],fontColor:t[9],backgroundColor:t[10],hintFuriganaFontColor:t[11],hintFuriganaShadowColor:t[12],fontSize:t[13],fontFamilyGroupOne:t[14],fontFamilyGroupTwo:t[15],hideSpoilerImage:t[16],hideFurigana:t[17],furiganaStyle:t[18],secondDimensionMaxValue:t[19],firstDimensionMargin:t[20],autoPositionOnResize:t[21],autoBookmark:t[24],multiplier:t[26],loadingState:t[30]??!0};return t[0]!==void 0&&(P.exploredCharCount=t[0]),t[1]!==void 0&&(P.bookCharCount=t[1]),t[2]!==void 0&&(P.bookmarkData=t[2]),t[3]!==void 0&&(P.autoScroller=t[3]),t[4]!==void 0&&(P.bookmarkManager=t[4]),t[5]!==void 0&&(P.pageManager=t[5]),e=new ea({props:P}),ne.push(()=>me(e,"exploredCharCount",f,t[0])),ne.push(()=>me(e,"bookCharCount",h,t[1])),ne.push(()=>me(e,"bookmarkData",d,t[2])),ne.push(()=>me(e,"autoScroller",p,t[3])),ne.push(()=>me(e,"bookmarkManager",m,t[4])),ne.push(()=>me(e,"pageManager",_,t[5])),e.$on("contentChange",t[46]),e.$on("bookmark",t[47]),{c(){ve(e.$$.fragment)},l(s){Pe(e.$$.fragment,s)},m(s,c){ye(e,s,c),u=!0},p(s,c){const S={};c[0]&128&&(S.htmlContent=s[7]),c[0]&268435456&&(S.width=s[28]??0),c[0]&536870912&&(S.height=s[29]??0),c[0]&256&&(S.verticalMode=s[8]),c[0]&512&&(S.fontColor=s[9]),c[0]&1024&&(S.backgroundColor=s[10]),c[0]&2048&&(S.hintFuriganaFontColor=s[11]),c[0]&4096&&(S.hintFuriganaShadowColor=s[12]),c[0]&8192&&(S.fontSize=s[13]),c[0]&16384&&(S.fontFamilyGroupOne=s[14]),c[0]&32768&&(S.fontFamilyGroupTwo=s[15]),c[0]&65536&&(S.hideSpoilerImage=s[16]),c[0]&131072&&(S.hideFurigana=s[17]),c[0]&262144&&(S.furiganaStyle=s[18]),c[0]&524288&&(S.secondDimensionMaxValue=s[19]),c[0]&1048576&&(S.firstDimensionMargin=s[20]),c[0]&2097152&&(S.autoPositionOnResize=s[21]),c[0]&16777216&&(S.autoBookmark=s[24]),c[0]&67108864&&(S.multiplier=s[26]),c[0]&1073741824&&(S.loadingState=s[30]??!0),!n&&c[0]&1&&(n=!0,S.exploredCharCount=s[0],ge(()=>n=!1)),!i&&c[0]&2&&(i=!0,S.bookCharCount=s[1],ge(()=>i=!1)),!o&&c[0]&4&&(o=!0,S.bookmarkData=s[2],ge(()=>o=!1)),!r&&c[0]&8&&(r=!0,S.autoScroller=s[3],ge(()=>r=!1)),!a&&c[0]&16&&(a=!0,S.bookmarkManager=s[4],ge(()=>a=!1)),!l&&c[0]&32&&(l=!0,S.pageManager=s[5],ge(()=>l=!1)),e.$set(S)},i(s){u||(z(e.$$.fragment,s),u=!0)},o(s){Y(e.$$.fragment,s),u=!1},d(s){Me(e,s)}}}function Sa(t){let e,n,i,o,r=(t[31]??"")+"",a,l;const u=[wa,_a],f=[];function h(d,p){return d[25]===bt.Continuous?0:1}return n=h(t),i=f[n]=u[n](t),{c(){e=U("div"),i.c(),o=$(),a=_e(r),this.h()},l(d){e=J(d,"DIV",{class:!0});var p=Q(e);i.l(p),p.forEach(E),o=ee(d),a=we(d,r),this.h()},h(){X(e,"class",ta+" py-8")},m(d,p){A(d,e,p),f[n].m(e,null),t[56](e),A(d,o,p),A(d,a,p),l=!0},p(d,p){let m=n;n=h(d),n===m?f[n].p(d,p):(xe(),Y(f[m],1,1,()=>{f[m]=null}),$e(),i=f[n],i?i.p(d,p):(i=f[n]=u[n](d),i.c()),z(i,1),i.m(e,null)),(!l||p[1]&1)&&r!==(r=(d[31]??"")+"")&&He(a,r)},i(d){l||(z(i),l=!0)},o(d){Y(i),l=!1},d(d){d&&E(e),f[n].d(),t[56](null),d&&E(o),d&&E(a)}}}function jt(t){return Number(t.replace(/px$/,""))}function va(t,e,n){let i,o,r,a,l,u,{htmlContent:f}=e,{width:h}=e,{height:d}=e,{verticalMode:p}=e,{fontColor:m}=e,{backgroundColor:_}=e,{hintFuriganaFontColor:P}=e,{hintFuriganaShadowColor:s}=e,{fontSize:c}=e,{fontFamilyGroupOne:S}=e,{fontFamilyGroupTwo:B}=e,{hideSpoilerImage:O}=e,{hideFurigana:D}=e,{furiganaStyle:K}=e,{secondDimensionMaxValue:I}=e,{firstDimensionMargin:j}=e,{autoPositionOnResize:H}=e,{avoidPageBreak:ae}=e,{pageColumns:k}=e,{autoBookmark:R}=e,{viewMode:v}=e,{exploredCharCount:T}=e,{bookCharCount:G}=e,{multiplier:oe}=e,{bookmarkData:x}=e,{autoScroller:ie}=e,{bookmarkManager:pe}=e,{pageManager:Ee}=e,{isBookmarkScreen:fe}=e;const Be=new je,L=new je,be=xi(null);W(t,be,C=>n(27,o=C));const q=Ot([be.pipe(nn(C=>!!C)),Ot([Be,L]).pipe(gn(0))]).pipe(zt(0,sn),Ve(([C])=>getComputedStyle(C)),kn({refCount:!0,bufferSize:1})),le=new vi(1),te=q.pipe(Ve(C=>w(h-jt(C.paddingLeft)-jt(C.paddingRight))));W(t,te,C=>n(28,r=C));const he=q.pipe(Ve(C=>F(d-jt(C.paddingTop)-jt(C.paddingBottom)-i)));W(t,he,C=>n(29,a=C));const ke=wt(()=>yn(document)).pipe(qt(C=>{const y=ia(C,K);return le.pipe(qt(se=>y(se)))}),pt());W(t,ke,C=>n(31,u=C));const Re=le.pipe(qt(C=>na(C)),pn());W(t,Re,C=>n(30,l=C));function w(C){return bt.Paginated===v&&!p&&I?Math.min(I,C):C}function F(C){return bt.Paginated===v&&p&&I?Math.min(I,C):C}function ce(C){T=C,n(0,T)}function V(C){G=C,n(1,G)}function Se(C){x=C,n(2,x)}function Ce(C){ie=C,n(3,ie)}function Ge(C){pe=C,n(4,pe)}function Ae(C){Ee=C,n(5,Ee)}const Fe=C=>le.next(C.detail);function Oe(C){Dn.call(this,t,C)}function Ke(C){T=C,n(0,T)}function Le(C){G=C,n(1,G)}function We(C){fe=C,n(6,fe)}function Te(C){x=C,n(2,x)}function lt(C){pe=C,n(4,pe)}function Ue(C){Ee=C,n(5,Ee)}const st=C=>le.next(C.detail);function it(C){Dn.call(this,t,C)}function tt(C){ne[C?"unshift":"push"](()=>{o=C,be.set(o)})}return t.$$set=C=>{"htmlContent"in C&&n(7,f=C.htmlContent),"width"in C&&n(38,h=C.width),"height"in C&&n(39,d=C.height),"verticalMode"in C&&n(8,p=C.verticalMode),"fontColor"in C&&n(9,m=C.fontColor),"backgroundColor"in C&&n(10,_=C.backgroundColor),"hintFuriganaFontColor"in C&&n(11,P=C.hintFuriganaFontColor),"hintFuriganaShadowColor"in C&&n(12,s=C.hintFuriganaShadowColor),"fontSize"in C&&n(13,c=C.fontSize),"fontFamilyGroupOne"in C&&n(14,S=C.fontFamilyGroupOne),"fontFamilyGroupTwo"in C&&n(15,B=C.fontFamilyGroupTwo),"hideSpoilerImage"in C&&n(16,O=C.hideSpoilerImage),"hideFurigana"in C&&n(17,D=C.hideFurigana),"furiganaStyle"in C&&n(18,K=C.furiganaStyle),"secondDimensionMaxValue"in C&&n(19,I=C.secondDimensionMaxValue),"firstDimensionMargin"in C&&n(20,j=C.firstDimensionMargin),"autoPositionOnResize"in C&&n(21,H=C.autoPositionOnResize),"avoidPageBreak"in C&&n(22,ae=C.avoidPageBreak),"pageColumns"in C&&n(23,k=C.pageColumns),"autoBookmark"in C&&n(24,R=C.autoBookmark),"viewMode"in C&&n(25,v=C.viewMode),"exploredCharCount"in C&&n(0,T=C.exploredCharCount),"bookCharCount"in C&&n(1,G=C.bookCharCount),"multiplier"in C&&n(26,oe=C.multiplier),"bookmarkData"in C&&n(2,x=C.bookmarkData),"autoScroller"in C&&n(3,ie=C.autoScroller),"bookmarkManager"in C&&n(4,pe=C.bookmarkManager),"pageManager"in C&&n(5,Ee=C.pageManager),"isBookmarkScreen"in C&&n(6,fe=C.isBookmarkScreen)},t.$$.update=()=>{t.$$.dirty[0]&34603264&&(i=j&&bt.Paginated===v&&!p?j*2:0),t.$$.dirty[1]&128&&Be.next(h),t.$$.dirty[1]&256&&L.next(d)},[T,G,x,ie,pe,Ee,fe,f,p,m,_,P,s,c,S,B,O,D,K,I,j,H,ae,k,R,v,oe,o,r,a,l,u,be,le,te,he,ke,Re,h,d,ce,V,Se,Ce,Ge,Ae,Fe,Oe,Ke,Le,We,Te,lt,Ue,st,it,tt]}class Pa extends ct{constructor(e){super(),ht(this,e,va,Sa,dt,{htmlContent:7,width:38,height:39,verticalMode:8,fontColor:9,backgroundColor:10,hintFuriganaFontColor:11,hintFuriganaShadowColor:12,fontSize:13,fontFamilyGroupOne:14,fontFamilyGroupTwo:15,hideSpoilerImage:16,hideFurigana:17,furiganaStyle:18,secondDimensionMaxValue:19,firstDimensionMargin:20,autoPositionOnResize:21,avoidPageBreak:22,pageColumns:23,autoBookmark:24,viewMode:25,exploredCharCount:0,bookCharCount:1,multiplier:26,bookmarkData:2,autoScroller:3,bookmarkManager:4,pageManager:5,isBookmarkScreen:6},null,[-1,-1,-1])}}function ya(t,e){const n=document.createTextNode(e);if(t.firstChild){t.replaceChild(n,t.firstChild);return}t.appendChild(n)}function Ma(t,e,n){let{styleSheet:i}=e,o;return fo(()=>{n(1,o=document.createElement("style")),document.head.appendChild(o)}),_n(()=>{o&&document.head.removeChild(o)}),t.$$set=r=>{"styleSheet"in r&&n(0,i=r.styleSheet)},t.$$.update=()=>{t.$$.dirty&3&&o&&ya(o,i)},[i,o]}class Ea extends ct{constructor(e){super(),ht(this,e,Ma,null,dt,{styleSheet:0})}}function qn(t,e,n){const i=t.slice();return i[18]=e[n],i}function Yn(t){let e,n,i,o,r;return n=new et({props:{icon:or}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(a){e=J(a,"DIV",{role:!0,class:!0});var l=Q(e);Pe(n.$$.fragment,l),l.forEach(E),this.h()},h(){X(e,"role","button"),X(e,"class",on)},m(a,l){A(a,e,l),ye(n,e,null),i=!0,o||(r=[De(e,"click",t[12]),De(e,"keyup",an)],o=!0)},p:Ct,i(a){i||(z(n.$$.fragment,a),i=!0)},o(a){Y(n.$$.fragment,a),i=!1},d(a){a&&E(e),Me(n),o=!1,mt(r)}}}function Kn(t){let e,n,i;return{c(){e=U("div"),n=_e(t[1]),i=_e("x"),this.h()},l(o){e=J(o,"DIV",{class:!0});var r=Q(e);n=we(r,t[1]),i=we(r,"x"),r.forEach(E),this.h()},h(){X(e,"class","flex items-center px-4 text-xl xl:px-3 xl:text-lg")},m(o,r){A(o,e,r),Z(e,n),Z(e,i)},p(o,r){r&2&&He(n,o[1])},d(o){o&&E(e)}}}function Un(t){let e,n,i,o={placement:"bottom",fallbackPlacements:["bottom-end","bottom-start"],yOffset:0,$$slots:{content:[Ra],icon:[Ba]},$$scope:{ctx:t}};return n=new ir({props:o}),t[15](n),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(r){e=J(r,"DIV",{class:!0});var a=Q(e);Pe(n.$$.fragment,a),a.forEach(E),this.h()},h(){X(e,"class","flex")},m(r,a){A(r,e,a),ye(n,e,null),i=!0},p(r,a){const l={};a&2097152&&(l.$$scope={dirty:a,ctx:r}),n.$set(l)},i(r){i||(z(n.$$.fragment,r),i=!0)},o(r){Y(n.$$.fragment,r),i=!1},d(r){r&&E(e),t[15](null),Me(n)}}}function Ba(t){let e,n,i;return n=new et({props:{icon:ar}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(o){e=J(o,"DIV",{slot:!0,class:!0});var r=Q(e);Pe(n.$$.fragment,r),r.forEach(E),this.h()},h(){X(e,"slot","icon"),X(e,"class",on)},m(o,r){A(o,e,r),ye(n,e,null),i=!0},p:Ct,i(o){i||(z(n.$$.fragment,o),i=!0)},o(o){Y(n.$$.fragment,o),i=!1},d(o){o&&E(e),Me(n)}}}function Jn(t,e){let n,i=e[18].label+"",o,r,a,l;function u(){return e[14](e[18])}return{key:t,first:null,c(){n=U("div"),o=_e(i),r=$(),this.h()},l(f){n=J(f,"DIV",{role:!0,class:!0});var h=Q(n);o=we(h,i),r=ee(h),h.forEach(E),this.h()},h(){X(n,"role","button"),X(n,"class","px-4 py-2 text-sm hover:bg-white hover:text-gray-700"),this.first=n},m(f,h){A(f,n,h),Z(n,o),Z(n,r),a||(l=[De(n,"click",u),De(n,"keyup",an)],a=!0)},p(f,h){e=f},d(f){f&&E(n),a=!1,mt(l)}}}function Ra(t){let e,n=[],i=new Map,o=t[9];const r=a=>a[18].label;for(let a=0;a<o.length;a+=1){let l=qn(t,o,a),u=r(l);i.set(u,n[a]=Jn(u,l))}return{c(){e=U("div");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=J(a,"DIV",{class:!0,slot:!0});var l=Q(e);for(let u=0;u<n.length;u+=1)n[u].l(l);l.forEach(E),this.h()},h(){X(e,"class","w-40 bg-gray-700 md:w-32"),X(e,"slot","content")},m(a,l){A(a,e,l);for(let u=0;u<n.length;u+=1)n[u].m(e,null)},p(a,l){l&1536&&(o=a[9],n=co(n,l,r,1,a,o,i,e,ho,Jn,null,qn))},d(a){a&&E(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function Qn(t){let e,n,i,o,r;return n=new et({props:{icon:rr}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(a){e=J(a,"DIV",{role:!0,class:!0});var l=Q(e);Pe(n.$$.fragment,l),l.forEach(E),this.h()},h(){X(e,"role","button"),X(e,"class",on)},m(a,l){A(a,e,l),ye(n,e,null),i=!0,o||(r=[De(e,"click",t[16]),De(e,"keyup",an)],o=!0)},p:Ct,i(a){i||(z(n.$$.fragment,a),i=!0)},o(a){Y(n.$$.fragment,a),i=!1},d(a){a&&E(e),Me(n),o=!1,mt(r)}}}function Da(t){let e,n,i,o,r,a,l,u,f,h,d,p,m,_,P=t[0]&&Yn(t);r=new et({props:{icon:t[3]?Lt:Vn}});let s=!t[5]&&Kn(t),c=(t[6]||t[7]===bt.Paginated)&&Un(t),S=t[2]&&Qn(t);return d=new nr({props:{items:[Qt.SETTINGS,Qt.MANAGE]}}),d.$on("action",t[17]),{c(){e=U("div"),n=U("div"),P&&P.c(),i=$(),o=U("div"),ve(r.$$.fragment),a=$(),s&&s.c(),l=$(),u=U("div"),c&&c.c(),f=$(),S&&S.c(),h=$(),ve(d.$$.fragment),this.h()},l(B){e=J(B,"DIV",{class:!0});var O=Q(e);n=J(O,"DIV",{class:!0});var D=Q(n);P&&P.l(D),i=ee(D),o=J(D,"DIV",{role:!0,class:!0});var K=Q(o);Pe(r.$$.fragment,K),K.forEach(E),a=ee(D),s&&s.l(D),D.forEach(E),l=ee(O),u=J(O,"DIV",{class:!0});var I=Q(u);c&&c.l(I),f=ee(I),S&&S.l(I),h=ee(I),Pe(d.$$.fragment,I),I.forEach(E),O.forEach(E),this.h()},h(){X(o,"role","button"),X(o,"class",on),X(n,"class","flex transform-gpu "+Pi),X(u,"class","flex transform-gpu "+yi),X(e,"class","flex justify-between bg-gray-700 px-4 md:px-8 "+Mi)},m(B,O){A(B,e,O),Z(e,n),P&&P.m(n,null),Z(n,i),Z(n,o),ye(r,o,null),Z(n,a),s&&s.m(n,null),Z(e,l),Z(e,u),c&&c.m(u,null),Z(u,f),S&&S.m(u,null),Z(u,h),ye(d,u,null),p=!0,m||(_=[De(o,"click",t[13]),De(o,"keyup",an)],m=!0)},p(B,[O]){B[0]?P?(P.p(B,O),O&1&&z(P,1)):(P=Yn(B),P.c(),z(P,1),P.m(n,i)):P&&(xe(),Y(P,1,1,()=>{P=null}),$e());const D={};O&8&&(D.icon=B[3]?Lt:Vn),r.$set(D),B[5]?s&&(s.d(1),s=null):s?s.p(B,O):(s=Kn(B),s.c(),s.m(n,null)),B[6]||B[7]===bt.Paginated?c?(c.p(B,O),O&192&&z(c,1)):(c=Un(B),c.c(),z(c,1),c.m(u,f)):c&&(xe(),Y(c,1,1,()=>{c=null}),$e()),B[2]?S?(S.p(B,O),O&4&&z(S,1)):(S=Qn(B),S.c(),z(S,1),S.m(u,h)):S&&(xe(),Y(S,1,1,()=>{S=null}),$e())},i(B){p||(z(P),z(r.$$.fragment,B),z(c),z(S),z(d.$$.fragment,B),p=!0)},o(B){Y(P),Y(r.$$.fragment,B),Y(c),Y(S),Y(d.$$.fragment,B),p=!1},d(B){B&&E(e),P&&P.d(),Me(r),s&&s.d(),c&&c.d(),S&&S.d(),Me(d),m=!1,mt(_)}}}function Fa(t,e,n){let i,o,r;W(t,Pn,D=>n(5,i=D)),W(t,vn,D=>n(6,o=D)),W(t,_o,D=>n(7,r=D));let{hasChapterData:a}=e,{autoScrollMultiplier:l}=e,{hasCustomReadingPoint:u}=e,{showFullscreenButton:f}=e,{isBookmarkScreen:h}=e;const d=tn(),p=[...u?[{label:"Show Point",action:"showCustomReadingPoint"}]:[],{label:"Set Point",action:"setCustomReadingPoint"},...u?[{label:"Reset Point",action:"resetCustomReadingPoint"}]:[]];let m;function _(D){d(D),m.toggleOpen()}const P=()=>d("tocClick"),s=()=>d("bookmarkClick"),c=D=>_(D.action);function S(D){ne[D?"unshift":"push"](()=>{m=D,n(4,m)})}const B=()=>d("fullscreenClick"),O=({detail:D})=>{D===Qt.SETTINGS.label?d("settingsClick"):D===Qt.MANAGE.label&&d("bookManagerClick")};return t.$$set=D=>{"hasChapterData"in D&&n(0,a=D.hasChapterData),"autoScrollMultiplier"in D&&n(1,l=D.autoScrollMultiplier),"hasCustomReadingPoint"in D&&n(11,u=D.hasCustomReadingPoint),"showFullscreenButton"in D&&n(2,f=D.showFullscreenButton),"isBookmarkScreen"in D&&n(3,h=D.isBookmarkScreen)},[a,l,f,h,m,i,o,r,d,p,_,u,P,s,c,S,B,O]}class Ta extends ct{constructor(e){super(),ht(this,e,Fa,Da,dt,{hasChapterData:0,autoScrollMultiplier:1,hasCustomReadingPoint:11,showFullscreenButton:2,isBookmarkScreen:3})}}function Zn(t,e,n){const i=t.slice();return i[16]=e[n],i}function xn(t,e){let n,i,o=e[16].label+"",r,a,l,u,f=e[16].startCharacter+"",h,d,p,m;function _(){return e[13](e[16])}return{key:t,first:null,c(){n=U("div"),i=U("div"),r=_e(o),l=$(),u=U("div"),h=_e(f),d=$(),this.h()},l(P){n=J(P,"DIV",{class:!0});var s=Q(n);i=J(s,"DIV",{id:!0,class:!0});var c=Q(i);r=we(c,o),c.forEach(E),l=ee(s),u=J(s,"DIV",{});var S=Q(u);h=we(S,f),S.forEach(E),d=ee(s),s.forEach(E),this.h()},h(){X(i,"id",a=`for${e[16].reference}`),X(i,"class","mr-4 cursor-pointer"),N(i,"opacity-30",e[16].progress===100&&e[16]!==e[2]),N(i,"hover:opacity-100",e[16].progress===100&&e[16]!==e[2]),N(i,"hover:opacity-60",e[16].progress<100||e[16]===e[2]),N(u,"opacity-30",e[16].progress===100&&e[16]!==e[2]),X(n,"class","my-6 flex justify-between"),this.first=n},m(P,s){A(P,n,s),Z(n,i),Z(i,r),Z(n,l),Z(n,u),Z(u,h),Z(n,d),p||(m=De(i,"click",_),p=!0)},p(P,s){e=P,s&2&&o!==(o=e[16].label+"")&&He(r,o),s&2&&a!==(a=`for${e[16].reference}`)&&X(i,"id",a),s&6&&N(i,"opacity-30",e[16].progress===100&&e[16]!==e[2]),s&6&&N(i,"hover:opacity-100",e[16].progress===100&&e[16]!==e[2]),s&6&&N(i,"hover:opacity-60",e[16].progress<100||e[16]===e[2]),s&2&&f!==(f=e[16].startCharacter+"")&&He(h,f),s&6&&N(u,"opacity-30",e[16].progress===100&&e[16]!==e[2])},d(P){P&&E(n),p=!1,m()}}}function Ia(t){let e,n,i,o,r,a,l,u,f,h,d,p,m=[],_=new Map,P,s,c,S,B,O,D,K,I,j;h=new et({props:{icon:lr}});let H=t[1];const ae=k=>k[16].reference;for(let k=0;k<H.length;k+=1){let R=Zn(t,H,k),v=ae(R);_.set(v,m[k]=xn(v,R))}return S=new et({props:{icon:sr}}),D=new et({props:{icon:ur}}),{c(){e=U("div"),n=U("div"),i=_e("Chapter Progress: "),o=_e(t[3]),r=_e(" ("),a=_e(t[4]),l=_e("%)"),u=$(),f=U("div"),ve(h.$$.fragment),d=$(),p=U("div");for(let k=0;k<m.length;k+=1)m[k].c();P=$(),s=U("div"),c=U("div"),ve(S.$$.fragment),B=$(),O=U("div"),ve(D.$$.fragment),this.h()},l(k){e=J(k,"DIV",{class:!0});var R=Q(e);n=J(R,"DIV",{});var v=Q(n);i=we(v,"Chapter Progress: "),o=we(v,t[3]),r=we(v," ("),a=we(v,t[4]),l=we(v,"%)"),v.forEach(E),u=ee(R),f=J(R,"DIV",{class:!0});var T=Q(f);Pe(h.$$.fragment,T),T.forEach(E),R.forEach(E),d=ee(k),p=J(k,"DIV",{class:!0});var G=Q(p);for(let pe=0;pe<m.length;pe+=1)m[pe].l(G);G.forEach(E),P=ee(k),s=J(k,"DIV",{class:!0});var oe=Q(s);c=J(oe,"DIV",{class:!0});var x=Q(c);Pe(S.$$.fragment,x),x.forEach(E),B=ee(oe),O=J(oe,"DIV",{class:!0});var ie=Q(O);Pe(D.$$.fragment,ie),ie.forEach(E),oe.forEach(E),this.h()},h(){X(f,"class","flex cursor-pointer items-end md:items-center"),X(e,"class","flex justify-between p-4"),X(p,"class","flex-1 overflow-auto p-4"),X(c,"class","cursor-pointer"),N(c,"opacity-30",!t[6]),X(O,"class","cursor-pointer"),N(O,"opacity-30",!t[5]),X(s,"class","flex justify-between px-4 py-6")},m(k,R){A(k,e,R),Z(e,n),Z(n,i),Z(n,o),Z(n,r),Z(n,a),Z(n,l),Z(e,u),Z(e,f),ye(h,f,null),A(k,d,R),A(k,p,R);for(let v=0;v<m.length;v+=1)m[v].m(p,null);A(k,P,R),A(k,s,R),Z(s,c),ye(S,c,null),Z(s,B),Z(s,O),ye(D,O,null),K=!0,I||(j=[De(f,"click",t[9]),De(c,"click",t[14]),De(O,"click",t[15])],I=!0)},p(k,[R]){(!K||R&8)&&He(o,k[3]),(!K||R&16)&&He(a,k[4]),R&262&&(H=k[1],m=co(m,R,ae,1,k,H,_,p,ho,xn,null,Zn)),(!K||R&64)&&N(c,"opacity-30",!k[6]),(!K||R&32)&&N(O,"opacity-30",!k[5])},i(k){K||(z(h.$$.fragment,k),z(S.$$.fragment,k),z(D.$$.fragment,k),K=!0)},o(k){Y(h.$$.fragment,k),Y(S.$$.fragment,k),Y(D.$$.fragment,k),K=!1},d(k){k&&E(e),Me(h),k&&E(d),k&&E(p);for(let R=0;R<m.length;R+=1)m[R].d();k&&E(P),k&&E(s),Me(S),Me(D),I=!1,mt(j)}}}function Aa(t,e){const[n,i]=e.reduce((o,r,a)=>(o[0]+=t[a]*r,o[1]+=r,o),[0,0]);return n/i}function $n(t){!t||(t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():t.scrollIntoView())}function Va(t,e,n){let i,o,{sectionData:r=[]}=e,{exploredCharCount:a=0}=e,{verticalMode:l}=e,u=[],f,h=-1,d="0/0",p="0.00";fo(()=>{In.dialogs$.next([{component:"<div/>"}]),f&&$n(document.getElementById(`for${f.reference}`))});function m(B,O){if(B){const D=u[h+O];_(D.reference,!1)}}function _(B,O=!1){Gt.next(B),O&&P()}function P(){Pt.next(!1),In.dialogs$.next([])}const s=B=>_(B.reference,!0),c=()=>m(i,l?1:-1),S=()=>m(o,l?-1:1);return t.$$set=B=>{"sectionData"in B&&n(10,r=B.sectionData),"exploredCharCount"in B&&n(11,a=B.exploredCharCount),"verticalMode"in B&&n(0,l=B.verticalMode)},t.$$.update=()=>{if(t.$$.dirty&5120&&r){const[B,O,D]=Ro(r),K=r.filter(I=>I.reference===D||I.parentChapter===D);n(4,p=Aa(K.map(I=>I.progress),K.map(I=>I.charactersWeight)).toFixed(2)),n(1,u=B),n(12,h=O),n(2,f=B[h])}if(t.$$.dirty&4099&&n(6,i=l?h<u.length-1:!!h),t.$$.dirty&4099&&n(5,o=l?!!h:h<u.length-1),t.$$.dirty&2052&&f){$n(document.getElementById(`for${f.reference}`));const B=f.characters;n(3,d=`${Math.min(Math.max(a-f.startCharacter,0),B)} / ${B}`)}},[l,u,f,d,p,o,i,m,_,P,r,a,h,s,c,S]}class Oa extends ct{constructor(e){super(),ht(this,e,Va,Ia,dt,{sectionData:10,exploredCharCount:11,verticalMode:0})}}class La{constructor(e){Ne(this,"fallbackSpec");this.fallbackSpec=eo(e)}get fullscreenEnabled(){return this.fallbackSpec("fullscreenEnabled","webkitFullscreenEnabled")??!1}get fullscreenElement(){return this.fallbackSpec("fullscreenElement","webkitFullscreenElement")??null}async requestFullscreen(e,n){const i=eo(e)("requestFullscreen","webkitRequestFullscreen");!i||await i(n)}async exitFullscreen(){const e=this.fallbackSpec("exitFullscreen","webkitExitFullscreen");!e||await e()}}function eo(t){return(e,n)=>to(t,e)??to(t,n)}function to(t,e){const n=t[e];return typeof n=="function"?n.bind(t):n}const Yt=new La(document);function za(t,e){return Na(t).pipe(Ve(n=>{const i=e.createElement("div");return i.innerHTML=n,Ha(i),Ga(i),Wa(i,e),ja(i),i.innerHTML}))}function Na(t){return new at(e=>{const{blobs:n}=t;let{elementHtml:i}=t;const o=[];return Object.entries(n).forEach(([r,a])=>{const l=URL.createObjectURL(a);o.push(l),i=i.replaceAll(er(r),l).replaceAll(`ttu:${r}`,l)}),e.next(i),()=>{o.forEach(r=>URL.revokeObjectURL(r))}})}function Ha(t){Array.from(t.getElementsByTagName("img")).map(e=>({parentEl:e.parentElement,isGaiji:vo(e)})).forEach(({parentEl:e,isGaiji:n})=>{e==null||e.classList.add("ttu-img-container"),n||e==null||e.classList.add("ttu-illustration-container")})}function Ga(t){Array.from(t.getElementsByTagName("svg")).forEach(e=>{e.removeAttribute("width"),e.removeAttribute("height")})}function Wa(t,e){const n=()=>{let o=[...t.children];const r=o.findIndex(a=>a.getElementsByTagName("a").length>1)+1;return r>0&&r<o.length&&(o=o.slice(r)),o},i=(o,r)=>{const a=e.createElement("span");a.toggleAttribute("data-ttu-spoiler-img"),(o.parentElement||r).insertBefore(a,o),a.appendChild(o)};n().forEach(o=>{Array.from(o.getElementsByTagName("img")).filter(r=>!vo(r)).forEach(r=>i(r,o)),Array.from(o.getElementsByTagName("svg")).filter(r=>r.getElementsByTagName("image").length).forEach(r=>i(r,o))})}function ja(t){t.querySelectorAll(".placeholder-br").forEach(e=>{e.parentElement.removeChild(e)})}var Xa=Oo;function Oo(t,e,n){t instanceof RegExp&&(t=no(t,n)),e instanceof RegExp&&(e=no(e,n));const i=Lo(t,e,n);return i&&{start:i[0],end:i[1],pre:n.slice(0,i[0]),body:n.slice(i[0]+t.length,i[1]),post:n.slice(i[1]+e.length)}}function no(t,e){const n=e.match(t);return n?n[0]:null}Oo.range=Lo;function Lo(t,e,n){let i,o,r,a,l,u=n.indexOf(t),f=n.indexOf(e,u+1),h=u;if(u>=0&&f>0){if(t===e)return[u,f];for(i=[],r=n.length;h>=0&&!l;)h===u?(i.push(h),u=n.indexOf(t,h+1)):i.length===1?l=[i.pop(),f]:(o=i.pop(),o<r&&(r=o,a=f),f=n.indexOf(e,h+1)),h=u<f&&u>=0?u:f;i.length&&(l=[r,a])}return l}function qa(t,e={}){const i=Object.assign({},{preserveStatic:!0,removeComments:!1},e),o=[];function r(v){throw new Error(`CSS parse error: ${v}`)}function a(v){const T=v.exec(t);if(T)return t=t.slice(T[0].length),T}function l(){return a(/^{\s*/)}function u(){return a(/^}/)}function f(){a(/^\s*/)}function h(){if(f(),t[0]!=="/"||t[1]!=="*")return;let v=2;for(;t[v]&&(t[v]!=="*"||t[v+1]!=="/");)v++;if(!t[v])return r("end of comment is missing");const T=t.slice(2,v);return t=t.slice(v+2),{type:"comment",comment:T}}function d(){const v=[];let T;for(;T=h();)v.push(T);return i.removeComments?[]:v}function p(){for(f();t[0]==="}";)r("extra closing bracket");const v=a(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(v)return v[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(T){return T.replace(/,/g,"‌")}).split(/\s*(?![^(]*\)),\s*/).map(function(T){return T.replace(/\u200C/g,",")})}function m(){if(t[0]==="@")return ae();a(/^([;\s]*)+/);const v=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;let T=a(/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!T)return;if(T=T[0].trim(),!a(/^:\s*/))return r("property missing ':'");const G=a(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),oe={type:"declaration",property:T.replace(v,""),value:G?G[0].replace(v,"").trim():""};return a(/^[;\s]*/),oe}function _(){if(!l())return r("missing '{'");let v,T=d();for(;v=m();)T.push(v),T=T.concat(d());return u()?T:r("missing '}'")}function P(){f();const v=[];let T;for(;T=a(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)v.push(T[1]),a(/^,\s*/);if(v.length)return{type:"keyframe",values:v,declarations:_()}}function s(){let v=a(/^@([-\w]+)?keyframes\s*/);if(!v)return;const T=v[1];if(v=a(/^([-\w]+)\s*/),!v)return r("@keyframes missing name");const G=v[1];if(!l())return r("@keyframes missing '{'");let oe,x=d();for(;oe=P();)x.push(oe),x=x.concat(d());return u()?{type:"keyframes",name:G,vendor:T,keyframes:x}:r("@keyframes missing '}'")}function c(){if(a(/^@page */))return{type:"page",selectors:p()||[],declarations:_()}}function S(){const v=a(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(v)return{type:"page-margin-box",name:`${v[1]}-${v[2]}`+(v[3]?`-${v[3]}`:""),declarations:_()}}function B(){if(a(/^@font-face\s*/))return{type:"font-face",declarations:_()}}function O(){const v=a(/^@supports *([^{]+)/);if(v)return{type:"supports",supports:v[1].trim(),rules:R()}}function D(){if(a(/^@host\s*/))return{type:"host",rules:R()}}function K(){const v=a(/^@media([^{]+)*/);if(v)return{type:"media",media:(v[1]||"").trim(),rules:R()}}function I(){const v=a(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(v)return{type:"custom-media",name:v[1].trim(),media:v[2].trim()}}function j(){const v=a(/^@([-\w]+)?document *([^{]+)/);if(v)return{type:"document",document:v[2].trim(),vendor:v[1]?v[1].trim():null,rules:R()}}function H(){const v=a(/^@(import|charset|namespace)\s*([^;]+);/);if(v)return{type:v[1],name:v[2].trim()}}function ae(){if(f(),t[0]==="@"){const v=H()||B()||K()||s()||O()||j()||I()||D()||c()||S();if(v&&!i.preserveStatic){let T=!1;return v.declarations?T=v.declarations.some(G=>/var\(/.test(G.value)):T=(v.keyframes||v.rules||[]).some(oe=>(oe.declarations||[]).some(x=>/var\(/.test(x.value))),T?v:{}}return v}}function k(){if(!i.preserveStatic){const G=Xa("{","}",t);if(G){const oe=/:(?:root|host)(?![.:#(])/.test(G.pre)&&/--\S*\s*:/.test(G.body),x=/var\(/.test(G.body);if(!oe&&!x)return t=t.slice(G.end+1),{}}}const v=p()||[],T=i.preserveStatic?_():_().filter(G=>{const oe=v.some(ie=>/:(?:root|host)(?![.:#(])/.test(ie))&&/^--\S/.test(G.property),x=/var\(/.test(G.value);return oe||x});return v.length||r("selector missing"),{type:"rule",selectors:v,declarations:T}}function R(v){if(!v&&!l())return r("missing '{'");let T,G=d();for(;t.length&&(v||t[0]!=="}")&&(T=ae()||k());)T.type&&G.push(T),G=G.concat(d());return!v&&!u()?r("missing '}'"):G}return{type:"stylesheet",stylesheet:{rules:R(!0),errors:o}}}function Ya(t,e="",n){const i={charset(r){return"@charset "+r.name+";"},comment(r){return r.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+r.comment+"*/":""},"custom-media"(r){return"@custom-media "+r.name+" "+r.media+";"},declaration(r){return r.property+":"+r.value+";"},document(r){return"@"+(r.vendor||"")+"document "+r.document+"{"+o(r.rules)+"}"},"font-face"(r){return"@font-face{"+o(r.declarations)+"}"},host(r){return"@host{"+o(r.rules)+"}"},import(r){return"@import "+r.name+";"},keyframe(r){return r.values.join(",")+"{"+o(r.declarations)+"}"},keyframes(r){return"@"+(r.vendor||"")+"keyframes "+r.name+"{"+o(r.keyframes)+"}"},media(r){return"@media "+r.media+"{"+o(r.rules)+"}"},namespace(r){return"@namespace "+r.name+";"},page(r){return"@page "+(r.selectors.length?r.selectors.join(", "):"")+"{"+o(r.declarations)+"}"},"page-margin-box"(r){return"@"+r.name+"{"+o(r.declarations)+"}"},rule(r){const a=r.declarations;if(a.length)return r.selectors.join(",")+"{"+o(a)+"}"},supports(r){return"@supports "+r.supports+"{"+o(r.rules)+"}"}};function o(r){let a="";for(let l=0;l<r.length;l++){const u=r[l];n&&n(u);const f=i[u.type](u);f&&(a+=f,f.length&&u.selectors&&(a+=e))}return a}return o(t.stylesheet.rules)}const Ka=/\s?html\s?/gi,Ua=/\s?body\s?/gi;function Ja(t,e){const i=qa(t.styleSheet).stylesheet.rules.filter(o=>o.type==="rule").filter(o=>!o.selectors.some(r=>Ka.test(r)||Ua.test(r)));return i.forEach(o=>{const r={};o.declarations=o.declarations.filter(l=>!/line-height$/.test(l.property)&&!/text-indent$/.test(l.property));const a=new $a(o.declarations,r);o.declarations.forEach(l=>{dn(r,Za(l)),dn(r,xa(l)),dn(r,a.convert(l))}),Object.entries(r).forEach(([l,u])=>{o.declarations.push({type:"declaration",property:l,value:u})}),o.declarations=o.declarations.filter(l=>!/writing-mode\s*$/.test(l.property))}),i.push(el()),i.forEach(o=>{o.selectors=Qa(o.selectors,e)}),Ya({stylesheet:{rules:i},type:"stylesheet"})}function Qa(t,e){return t.map(n=>`${e} ${n}`)}function dn(t,e){return e&&(t[e.key]=e.value),t}function Za(t){const e=/(?:(?:-epub-)|(?:-webkit-))(.+)/i.exec(t.property);if(e)return{key:e[1],value:t.value}}function xa(t){if(t.property==="font-family"){let e=t.value;return e.includes("sans-serif")?e="var(--font-family-sans-serif, Noto Sans JP, sans-serif)":e.includes("serif")&&(e="var(--font-family-serif, Noto Serif JP, serif)"),{key:t.property,value:e}}}class $a{constructor(e,n){Ne(this,"hasLineBreakDefined");this.ruleDeclarations=e,this.newDeclarations=n}convert(e){if(/(?:(?:-epub-)|(?:-webkit-))?word-break$/i.exec(e.property)&&e.value==="break-all"&&(this.hasLineBreakDefined===void 0&&(this.hasLineBreakDefined=this.ruleDeclarations.some(n=>n.type==="declaration"&&n.property==="line-break")),!this.hasLineBreakDefined&&!this.newDeclarations["line-break"]))return{key:"line-break",value:"loose"}}}function el(){return{type:"rule",selectors:["br"],declarations:[{type:"declaration",property:"display",value:"inline!important"}]}}function tl(t,e,n){return za(t,n).pipe(Ve(i=>({htmlContent:i,styleSheet:Ja(t,e)})))}function nl(t){return new at(e=>t.subscribe(n=>{e.next(n)}))}function Xt(t=Bi){return e=>t?e:Ei}function oo(t,e,n){return i=>new at(o=>{const r=t();return i.pipe(po(sn),Rr(()=>n(r))).subscribe({next:a=>{e(a,r),o.next(a)},error:a=>o.error(a),complete:()=>o.complete()})})}function ol(t,e,n,i,o,r,a,l,u,f){switch(e[t.code]){case nt.BOOKMARK:return n(),!0;case nt.JUMP_TO_BOOKMARK:return i(),!0;case nt.AUTO_SCROLL_TOGGLE:return r==null||r.toggle(),!0;case nt.AUTO_SCROLL_INCREASE:return o(1),!0;case nt.AUTO_SCROLL_DECREASE:return o(-1),!0;case nt.NEXT_PAGE:return a==null||a.nextPage(),!0;case nt.PREV_PAGE:return a==null||a.prevPage(),!0;case nt.PREV_CHAPTER:return u(l?1:-1),!0;case nt.NEXT_CHAPTER:return u(l?-1:1),!0;case nt.SET_READING_POINT:return f(),!0;default:return!1}}const{document:mn,window:il}=wn;function io(t){var d;let e,n,i,o,r,a,l,u;function f(p){t[68](p)}let h={hasChapterData:!!((d=t[21])!=null&&d.length),hasCustomReadingPoint:!!(t[24]&&(t[18]&&t[3]||!t[18]&&t[14]>-1&&t[13]>-1)),showFullscreenButton:Yt.fullscreenEnabled,autoScrollMultiplier:t[25]};return t[8]!==void 0&&(h.isBookmarkScreen=t[8]),n=new Ta({props:h}),ne.push(()=>me(n,"isBookmarkScreen",f,t[8])),n.$on("tocClick",t[69]),n.$on("setCustomReadingPoint",t[66]),n.$on("showCustomReadingPoint",t[70]),n.$on("resetCustomReadingPoint",t[71]),n.$on("fullscreenClick",t[65]),n.$on("bookmarkClick",t[63]),n.$on("bookManagerClick",t[64]),n.$on("settingsClick",t[63]),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(p){e=J(p,"DIV",{class:!0});var m=Q(e);Pe(n.$$.fragment,m),m.forEach(E),this.h()},h(){X(e,"class","elevation-4 writing-horizontal-tb fixed inset-x-0 top-0 z-10 w-full")},m(p,m){A(p,e,m),ye(n,e,null),a=!0,l||(u=Sn(o=Po.call(null,e,t[72])),l=!0)},p(p,m){var P;t=p;const _={};m[0]&2097152&&(_.hasChapterData=!!((P=t[21])!=null&&P.length)),m[0]&17063944&&(_.hasCustomReadingPoint=!!(t[24]&&(t[18]&&t[3]||!t[18]&&t[14]>-1&&t[13]>-1))),m[0]&33554432&&(_.autoScrollMultiplier=t[25]),!i&&m[0]&256&&(i=!0,_.isBookmarkScreen=t[8],ge(()=>i=!1)),n.$set(_),o&&gi(o.update)&&m[0]&128&&o.update.call(null,t[72])},i(p){a||(z(n.$$.fragment,p),p&&mo(()=>{r||(r=Fn(e,Cn,{y:-300,easing:bn},!0)),r.run(1)}),a=!0)},o(p){Y(n.$$.fragment,p),p&&(r||(r=Fn(e,Cn,{y:-300,easing:bn},!1)),r.run(0)),a=!1},d(p){p&&E(e),Me(n),p&&r&&r.end(),l=!1,u()}}}function rl(t){let e=(t[47]??"")+"",n;return{c(){n=_e(e)},l(i){n=we(i,e)},m(i,o){A(i,n,o)},p(i,o){o[1]&65536&&e!==(e=(i[47]??"")+"")&&He(n,e)},i:Ct,o:Ct,d(i){i&&E(n)}}}function al(t){var he,ke,Re;let e,n,i,o,r,a,l,u,f,h,d,p,m,_,P,s,c,S=(t[43]??"")+"",B,O,D=(t[44]??"")+"",K,I,j=(t[45]??"")+"",H,ae,k=(t[46]??"")+"",R,v;e=new Ea({props:{styleSheet:t[26].styleSheet}});function T(w){t[73](w)}function G(w){t[74](w)}function oe(w){t[75](w)}function x(w){t[76](w)}function ie(w){t[77](w)}function pe(w){t[78](w)}function Ee(w){t[79](w)}function fe(w){t[80](w)}function Be(w){t[81](w)}function L(w){t[82](w)}function be(w){t[83](w)}function q(w){t[84](w)}function le(w){t[85](w)}let te={htmlContent:t[26].htmlContent,width:t[27]??0,height:t[28]??0,verticalMode:t[19],fontColor:(he=t[29])==null?void 0:he.fontColor,backgroundColor:t[30],hintFuriganaFontColor:(ke=t[29])==null?void 0:ke.hintFuriganaFontColor,hintFuriganaShadowColor:(Re=t[29])==null?void 0:Re.hintFuriganaShadowColor,fontFamilyGroupOne:t[31],fontFamilyGroupTwo:t[32],fontSize:t[33],lineHeight:t[34],hideSpoilerImage:t[35],hideFurigana:t[36],furiganaStyle:t[37],viewMode:t[5],secondDimensionMaxValue:t[38],firstDimensionMargin:t[20],autoPositionOnResize:t[39],avoidPageBreak:t[40],pageColumns:t[41],autoBookmark:t[42],multiplier:t[25]};return t[0]!==void 0&&(te.exploredCharCount=t[0]),t[1]!==void 0&&(te.bookCharCount=t[1]),t[8]!==void 0&&(te.isBookmarkScreen=t[8]),t[12]!==void 0&&(te.bookmarkData=t[12]),t[2]!==void 0&&(te.autoScroller=t[2]),t[10]!==void 0&&(te.bookmarkManager=t[10]),t[11]!==void 0&&(te.pageManager=t[11]),t[15]!==void 0&&(te.customReadingPoint=t[15]),t[13]!==void 0&&(te.customReadingPointTop=t[13]),t[14]!==void 0&&(te.customReadingPointLeft=t[14]),t[16]!==void 0&&(te.customReadingPointScrollOffset=t[16]),t[3]!==void 0&&(te.customReadingPointRange=t[3]),t[4]!==void 0&&(te.showCustomReadingPoint=t[4]),i=new Pa({props:te}),ne.push(()=>me(i,"exploredCharCount",T,t[0])),ne.push(()=>me(i,"bookCharCount",G,t[1])),ne.push(()=>me(i,"isBookmarkScreen",oe,t[8])),ne.push(()=>me(i,"bookmarkData",x,t[12])),ne.push(()=>me(i,"autoScroller",ie,t[2])),ne.push(()=>me(i,"bookmarkManager",pe,t[10])),ne.push(()=>me(i,"pageManager",Ee,t[11])),ne.push(()=>me(i,"customReadingPoint",fe,t[15])),ne.push(()=>me(i,"customReadingPointTop",Be,t[13])),ne.push(()=>me(i,"customReadingPointLeft",L,t[14])),ne.push(()=>me(i,"customReadingPointScrollOffset",be,t[16])),ne.push(()=>me(i,"customReadingPointRange",q,t[3])),ne.push(()=>me(i,"showCustomReadingPoint",le,t[4])),i.$on("bookmark",t[63]),{c(){ve(e.$$.fragment),n=$(),ve(i.$$.fragment),c=$(),B=_e(S),O=$(),K=_e(D),I=$(),H=_e(j),ae=$(),R=_e(k)},l(w){Pe(e.$$.fragment,w),n=ee(w),Pe(i.$$.fragment,w),c=ee(w),B=we(w,S),O=ee(w),K=we(w,D),I=ee(w),H=we(w,j),ae=ee(w),R=we(w,k)},m(w,F){ye(e,w,F),A(w,n,F),ye(i,w,F),A(w,c,F),A(w,B,F),A(w,O,F),A(w,K,F),A(w,I,F),A(w,H,F),A(w,ae,F),A(w,R,F),v=!0},p(w,F){var Se,Ce,Ge;const ce={};F[0]&67108864&&(ce.styleSheet=w[26].styleSheet),e.$set(ce);const V={};F[0]&67108864&&(V.htmlContent=w[26].htmlContent),F[0]&134217728&&(V.width=w[27]??0),F[0]&268435456&&(V.height=w[28]??0),F[0]&524288&&(V.verticalMode=w[19]),F[0]&536870912&&(V.fontColor=(Se=w[29])==null?void 0:Se.fontColor),F[0]&1073741824&&(V.backgroundColor=w[30]),F[0]&536870912&&(V.hintFuriganaFontColor=(Ce=w[29])==null?void 0:Ce.hintFuriganaFontColor),F[0]&536870912&&(V.hintFuriganaShadowColor=(Ge=w[29])==null?void 0:Ge.hintFuriganaShadowColor),F[1]&1&&(V.fontFamilyGroupOne=w[31]),F[1]&2&&(V.fontFamilyGroupTwo=w[32]),F[1]&4&&(V.fontSize=w[33]),F[1]&8&&(V.lineHeight=w[34]),F[1]&16&&(V.hideSpoilerImage=w[35]),F[1]&32&&(V.hideFurigana=w[36]),F[1]&64&&(V.furiganaStyle=w[37]),F[0]&32&&(V.viewMode=w[5]),F[1]&128&&(V.secondDimensionMaxValue=w[38]),F[0]&1048576&&(V.firstDimensionMargin=w[20]),F[1]&256&&(V.autoPositionOnResize=w[39]),F[1]&512&&(V.avoidPageBreak=w[40]),F[1]&1024&&(V.pageColumns=w[41]),F[1]&2048&&(V.autoBookmark=w[42]),F[0]&33554432&&(V.multiplier=w[25]),!o&&F[0]&1&&(o=!0,V.exploredCharCount=w[0],ge(()=>o=!1)),!r&&F[0]&2&&(r=!0,V.bookCharCount=w[1],ge(()=>r=!1)),!a&&F[0]&256&&(a=!0,V.isBookmarkScreen=w[8],ge(()=>a=!1)),!l&&F[0]&4096&&(l=!0,V.bookmarkData=w[12],ge(()=>l=!1)),!u&&F[0]&4&&(u=!0,V.autoScroller=w[2],ge(()=>u=!1)),!f&&F[0]&1024&&(f=!0,V.bookmarkManager=w[10],ge(()=>f=!1)),!h&&F[0]&2048&&(h=!0,V.pageManager=w[11],ge(()=>h=!1)),!d&&F[0]&32768&&(d=!0,V.customReadingPoint=w[15],ge(()=>d=!1)),!p&&F[0]&8192&&(p=!0,V.customReadingPointTop=w[13],ge(()=>p=!1)),!m&&F[0]&16384&&(m=!0,V.customReadingPointLeft=w[14],ge(()=>m=!1)),!_&&F[0]&65536&&(_=!0,V.customReadingPointScrollOffset=w[16],ge(()=>_=!1)),!P&&F[0]&8&&(P=!0,V.customReadingPointRange=w[3],ge(()=>P=!1)),!s&&F[0]&16&&(s=!0,V.showCustomReadingPoint=w[4],ge(()=>s=!1)),i.$set(V),(!v||F[1]&4096)&&S!==(S=(w[43]??"")+"")&&He(B,S),(!v||F[1]&8192)&&D!==(D=(w[44]??"")+"")&&He(K,D),(!v||F[1]&16384)&&j!==(j=(w[45]??"")+"")&&He(H,j),(!v||F[1]&32768)&&k!==(k=(w[46]??"")+"")&&He(R,k)},i(w){v||(z(e.$$.fragment,w),z(i.$$.fragment,w),v=!0)},o(w){Y(e.$$.fragment,w),Y(i.$$.fragment,w),v=!1},d(w){Me(e,w),w&&E(n),Me(i,w),w&&E(c),w&&E(B),w&&E(O),w&&E(K),w&&E(I),w&&E(H),w&&E(ae),w&&E(R)}}}function ro(t){let e,n,i,o,r,a;return n=new Oa({props:{sectionData:t[21],verticalMode:t[19],exploredCharCount:t[0]}}),{c(){e=U("div"),ve(n.$$.fragment),this.h()},l(l){e=J(l,"DIV",{class:!0});var u=Q(e);Pe(n.$$.fragment,u),u.forEach(E),this.h()},h(){var l;X(e,"class","writing-horizontal-tb fixed top-0 left-0 z-[60] flex h-full w-full max-w-xl flex-col justify-between"),M(e,"color",(l=t[29])==null?void 0:l.fontColor),M(e,"background-color",t[30])},m(l,u){A(l,e,u),ye(n,e,null),o=!0,r||(a=Sn(Po.call(null,e,t[86])),r=!0)},p(l,u){var h;t=l;const f={};u[0]&2097152&&(f.sectionData=t[21]),u[0]&524288&&(f.verticalMode=t[19]),u[0]&1&&(f.exploredCharCount=t[0]),n.$set(f),u[0]&536870912&&M(e,"color",(h=t[29])==null?void 0:h.fontColor),u[0]&1073741824&&M(e,"background-color",t[30])},i(l){o||(z(n.$$.fragment,l),l&&(i||mo(()=>{i=ki(e,Cn,{x:-100,duration:100,easing:bn}),i.start()})),o=!0)},o(l){Y(n.$$.fragment,l),o=!1},d(l){l&&E(e),Me(n),r=!1,a()}}}function ao(t){let e,n,i;return{c(){e=U("div"),n=$(),i=U("div"),this.h()},l(o){e=J(o,"DIV",{class:!0}),Q(e).forEach(E),n=ee(o),i=J(o,"DIV",{class:!0}),Q(i).forEach(E),this.h()},h(){X(e,"class","fixed left-0 z-20 h-[1px] w-full border border-red-500"),M(e,"top",`${t[13]}px`),X(i,"class","fixed top-0 z-20 h-full w-[1px] border border-red-500"),M(i,"left",`${t[14]}px`)},m(o,r){A(o,e,r),A(o,n,r),A(o,i,r)},p(o,r){r[0]&8192&&M(e,"top",`${o[13]}px`),r[0]&16384&&M(i,"left",`${o[14]}px`)},d(o){o&&E(e),o&&E(n),o&&E(i)}}}function lo(t){let e,n,i,o,r,a=(t[0]/t[1]*100).toFixed(2)+"",l,u;return{c(){e=U("div"),n=_e(t[0]),i=_e(" / "),o=_e(t[1]),r=_e(" ("),l=_e(a),u=_e("%)"),this.h()},l(f){e=J(f,"DIV",{class:!0});var h=Q(e);n=we(h,t[0]),i=we(h," / "),o=we(h,t[1]),r=we(h," ("),l=we(h,a),u=we(h,"%)"),h.forEach(E),this.h()},h(){var f;X(e,"class","writing-horizontal-tb fixed bottom-2 right-2 z-10 text-xs leading-none"),M(e,"color",(f=t[29])==null?void 0:f.tooltipTextFontColor)},m(f,h){A(f,e,h),Z(e,n),Z(e,i),Z(e,o),Z(e,r),Z(e,l),Z(e,u)},p(f,h){var d;h[0]&1&&He(n,f[0]),h[0]&2&&He(o,f[1]),h[0]&3&&a!==(a=(f[0]/f[1]*100).toFixed(2)+"")&&He(l,a),h[0]&536870912&&M(e,"color",(d=f[29])==null?void 0:d.tooltipTextFontColor)},d(f){f&&E(e)}}}function ll(t){var ae;let e,n,i=(t[23]??"")+"",o,r,a,l,u,f,h,d,p,m,_,P,s,c,S;mn.title=e=Tn(((ae=t[22])==null?void 0:ae.title)??"");let B=t[7]&&io(t);const O=[al,rl],D=[];function K(k,R){return k[26]?0:1}f=K(t),h=D[f]=O[f](t);let I=t[6]&&ro(t),j=(t[17]&&!t[48]||!t[18]&&t[4])&&ao(t),H=t[9]&&t[1]&&lo(t);return{c(){n=$(),o=_e(i),r=$(),a=U("button"),l=$(),B&&B.c(),u=$(),h.c(),d=$(),I&&I.c(),p=$(),j&&j.c(),m=$(),H&&H.c(),_=$(),P=U("button"),this.h()},l(k){mi("svelte-rnuhm6",mn.head).forEach(E),n=ee(k),o=we(k,i),r=ee(k),a=J(k,"BUTTON",{class:!0}),Q(a).forEach(E),l=ee(k),B&&B.l(k),u=ee(k),h.l(k),d=ee(k),I&&I.l(k),p=ee(k),j&&j.l(k),m=ee(k),H&&H.l(k),_=ee(k),P=J(k,"BUTTON",{class:!0}),Q(P).forEach(E),this.h()},h(){X(a,"class","fixed inset-x-0 top-0 z-10 h-8 w-full"),X(P,"class","fixed inset-x-0 bottom-0 z-10 h-8 w-full cursor-pointer")},m(k,R){A(k,n,R),A(k,o,R),A(k,r,R),A(k,a,R),A(k,l,R),B&&B.m(k,R),A(k,u,R),D[f].m(k,R),A(k,d,R),I&&I.m(k,R),A(k,p,R),j&&j.m(k,R),A(k,m,R),H&&H.m(k,R),A(k,_,R),A(k,P,R),s=!0,c||(S=[De(il,"keydown",t[62]),De(a,"click",t[67]),De(P,"click",t[87])],c=!0)},p(k,R){var T;(!s||R[0]&4194304)&&e!==(e=Tn(((T=k[22])==null?void 0:T.title)??""))&&(mn.title=e),(!s||R[0]&8388608)&&i!==(i=(k[23]??"")+"")&&He(o,i),k[7]?B?(B.p(k,R),R[0]&128&&z(B,1)):(B=io(k),B.c(),z(B,1),B.m(u.parentNode,u)):B&&(xe(),Y(B,1,1,()=>{B=null}),$e());let v=f;f=K(k),f===v?D[f].p(k,R):(xe(),Y(D[v],1,1,()=>{D[v]=null}),$e(),h=D[f],h?h.p(k,R):(h=D[f]=O[f](k),h.c()),z(h,1),h.m(d.parentNode,d)),k[6]?I?(I.p(k,R),R[0]&64&&z(I,1)):(I=ro(k),I.c(),z(I,1),I.m(p.parentNode,p)):I&&(xe(),Y(I,1,1,()=>{I=null}),$e()),k[17]&&!k[48]||!k[18]&&k[4]?j?j.p(k,R):(j=ao(k),j.c(),j.m(m.parentNode,m)):j&&(j.d(1),j=null),k[9]&&k[1]?H?H.p(k,R):(H=lo(k),H.c(),H.m(_.parentNode,_)):H&&(H.d(1),H=null)},i(k){s||(z(B),z(h),z(I),s=!0)},o(k){Y(B),Y(h),Y(I),s=!1},d(k){k&&E(n),k&&E(o),k&&E(r),k&&E(a),k&&E(l),B&&B.d(k),k&&E(u),D[f].d(k),k&&E(d),I&&I.d(k),k&&E(p),j&&j.d(k),k&&E(m),H&&H.d(k),k&&E(_),k&&E(P),c=!1,mt(S)}}}const so="background-color",uo="writing-mode";function sl(t,e,n){let i,o,r,a,l,u,f,h,d,p,m,_,P,s,c,S,B,O,D,K,I,j,H,ae,k,R,v,T,G,oe,x,ie,pe,Ee,fe,Be;W(t,Vi,g=>n(19,o=g)),W(t,bo,g=>n(20,r=g)),W(t,Co,g=>n(90,l=g)),W(t,_o,g=>n(5,u=g)),W(t,Pt,g=>n(6,f=g)),W(t,fn,g=>n(91,h=g)),W(t,cn,g=>n(92,d=g)),W(t,vn,g=>n(24,_=g)),W(t,hn,g=>n(25,P=g)),W(t,Oi,g=>n(31,D=g)),W(t,Li,g=>n(32,K=g)),W(t,zi,g=>n(33,I=g)),W(t,Ni,g=>n(34,j=g)),W(t,Hi,g=>n(35,H=g)),W(t,Gi,g=>n(36,ae=g)),W(t,Wi,g=>n(37,k=g)),W(t,ji,g=>n(38,R=g)),W(t,Xi,g=>n(39,v=g)),W(t,qi,g=>n(40,T=g)),W(t,Yi,g=>n(41,G=g)),W(t,Ki,g=>n(42,oe=g)),W(t,Pn,g=>n(48,Be=g));let L=!0,be=!1,q=!0,le=0,te=0,he,ke,Re,w=Promise.resolve(void 0),F=-2,ce=-2,V=o?d:h,Se=0,Ce,Ge,Ae=!0,Fe=!1,Oe=!1;const Ke=un(2500).pipe(rt(()=>n(7,L=!1)),pt());W(t,Ke,g=>n(23,m=g));const Le=wt(()=>nl(Ui)).pipe(Ve(g=>Number(g.url.searchParams.get("id"))),kn({refCount:!0,bufferSize:1})),We=Le.pipe(At(g=>Dt.getData(g)),pn());W(t,We,g=>n(22,p=g));const Te=We.pipe(rt(g=>{g||Ii("/manage")}),pt());W(t,Te,g=>n(47,fe=g));const lt=We.pipe(rt(g=>{!g||n(12,w=Dt.getBookmark(g.id))}),pt());W(t,lt,g=>n(43,x=g));const Ue=We.pipe(At(g=>g?(g.lastBookOpen=new Date().getTime(),Ri(Di.BROWSER,window).then(de=>Dt.upsertData(g,de)).catch(()=>{}),Mn.next(g.sections||[]),tl(g,".book-content",document)):Mt),kn({refCount:!0,bufferSize:1}));W(t,Ue,g=>n(26,s=g));const st=wt(()=>visualViewport?Ye(visualViewport,"resize"):yn()).pipe(pn()),it=st.pipe(gn(0),Ve(()=>(visualViewport==null?void 0:visualViewport.width)||0),Xt());W(t,it,g=>n(27,c=g));const tt=st.pipe(gn(0),Ve(()=>(visualViewport==null?void 0:visualViewport.height)||0),Xt());W(t,tt,g=>n(28,S=g));const C=Fi.pipe(Ve(g=>fr.get(g)),nn(g=>!!g));W(t,C,g=>n(29,B=g));const y=C.pipe(Ve(g=>g.backgroundColor));W(t,y,g=>n(30,O=g));const se=y.pipe(oo(()=>document.body,(g,de)=>de.style.setProperty(so,g),g=>g.style.removeProperty(so)),pt(),Xt());W(t,se,g=>n(44,ie=g));const Xe=Ti.pipe(oo(()=>document.documentElement,(g,de)=>de.style.setProperty(uo,g),g=>g.style.removeProperty(uo)),pt(),Xt());W(t,Xe,g=>n(45,pe=g));const Ie=wt(()=>xt).pipe(Ve(g=>[...g.values()]));W(t,Ie,g=>n(21,a=g));const b=wt(()=>Ye(document,"selectionchange")).pipe(zt(200),rt(()=>{var de,ze;const g=((de=window.getSelection())==null?void 0:de.toString())||"";!g&&Ae?Ge=void 0:g?(Ge=(ze=window.getSelection())==null?void 0:ze.getRangeAt(0),Ae=!1):Ae=!0}),pt());W(t,b,g=>n(46,Ee=g));function re(g){!ol(g,Ai.getValue(),Ze,zo,ze=>hn.next(hn.getValue()+ze),he,Re,o,Go,Bn)||(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),g.preventDefault())}function ue(){let g;return Le.subscribe(de=>g=de).unsubscribe(),g}async function Ze(){var ze;const g=ue();if(!g||!ke)return;let de;if(n(7,L=!1),i){const Rt=l?Lr(window,Ge):void 0,kt=Rt||Ce;Tt((ze=kt==null?void 0:kt.endContainer)==null?void 0:ze.parentElement,"add",.5,500),de=ke.formatBookmarkDataByRange(g,kt),Rt&&Fo(window)}else de=ke.formatBookmarkData(g,Se);await Dt.putBookmark(de),n(12,w=Promise.resolve(de))}async function zo(){const g=await w;!g||!ke||ke.scrollToBookmark(g,Se)}function No(){Dt.deleteLastItem(),Ze()}function Ho(){if(n(7,L=!1),!Yt.fullscreenElement){Yt.requestFullscreen(document.documentElement);return}Yt.exitFullscreen()}function Go(g){if(!(a!=null&&a.length))return;const[de,ze]=Ro(a);!ze&&g===-1||g===1&&ze===de.length-1||Gt.next(de[ze+g].reference)}function Bn(){const g=document.querySelector(".book-content");if(!g)return;i&&(n(13,F=window.innerHeight/2-2),n(14,ce=window.innerWidth/2-2)),n(7,L=!1),n(17,Fe=!0),document.body.classList.add("cursor-crosshair");const{elLeftReferencePoint:de,elTopReferencePoint:ze,elRightReferencePoint:Rt,elBottomReferencePoint:kt,pointGap:Rn}=To(window,g,o,r);Ht(Ye(document,"pointerup"),Ye(document,"pointermove")).pipe(Fr(()=>Fe)).subscribe(Je=>{if(Je instanceof PointerEvent)if(Je.type==="pointerup")document.body.classList.remove("cursor-crosshair"),n(17,Fe=!1),pi().then(()=>{n(14,ce=o?Je.x:ce),n(13,F=o?F:Je.y);const ut=Or(ce,F);if(ut&&Tt(ut.parent,"add",.5,500),i)n(3,Ce=ut==null?void 0:ut.range);else{let ft=0;o?(ft=Math.ceil(Math.max(0,ce-de)/(Rt-de)*100),cn.next(ft)):(ft=Math.ceil(Math.max(0,F-ze)/(kt-ze)*100),fn.next(ft)),n(15,V=ft)}});else{const ut=Je.x>=de+Rn&&Je.x<=Rt,ft=Je.y>=ze&&Je.y<=kt-Rn;i?(n(13,F=ft?Je.y:F),n(14,ce=ut?Je.x:ce)):o&&ut?n(14,ce=Je.x):!o&&ft&&n(13,F=Je.y)}})}const Wo=()=>n(7,L=!0);function jo(g){be=g,n(8,be)}const Xo=()=>{n(7,L=!1),Pt.next(!0)},qo=()=>{n(7,L=!1),n(4,Oe=!0)},Yo=()=>{n(7,L=!1),i?n(3,Ce=void 0):o?(cn.next(100),n(15,V=100)):(fn.next(0),n(15,V=0))},Ko=()=>n(7,L=!1);function Uo(g){le=g,n(0,le)}function Jo(g){te=g,n(1,te)}function Qo(g){be=g,n(8,be)}function Zo(g){w=g,n(12,w)}function xo(g){he=g,n(2,he)}function $o(g){ke=g,n(10,ke)}function ei(g){Re=g,n(11,Re)}function ti(g){V=g,n(15,V)}function ni(g){F=g,n(13,F)}function oi(g){ce=g,n(14,ce)}function ii(g){Se=g,n(16,Se)}function ri(g){Ce=g,n(3,Ce)}function ai(g){Oe=g,n(4,Oe),n(3,Ce)}const li=()=>Pt.next(!1),si=()=>n(9,q=!q);return t.$$.update=()=>{var g;t.$$.dirty[0]&68&&f&&(he==null||he.off()),t.$$.dirty[0]&3&&te&&document.dispatchEvent(new CustomEvent("ttsu:page.change",{detail:{exploredCharCount:le}})),t.$$.dirty[0]&2&&document.dispatchEvent(new CustomEvent("ttsu:page.change",{detail:{bookCharCount:te}})),t.$$.dirty[0]&24&&Oe&&(Tt((g=Ce==null?void 0:Ce.endContainer)==null?void 0:g.parentElement,"add",1),Ye(document,"click").pipe(Kt(1),Bt(1)).subscribe(()=>{var de;n(4,Oe=!1),Tt((de=Ce==null?void 0:Ce.endContainer)==null?void 0:de.parentElement,"remove",1)})),t.$$.dirty[0]&32&&n(18,i=u===bt.Paginated)},[le,te,he,Ce,Oe,u,f,L,be,q,ke,Re,w,F,ce,V,Se,Fe,i,o,r,a,p,m,_,P,s,c,S,B,O,D,K,I,j,H,ae,k,R,v,T,G,oe,x,ie,pe,Ee,fe,Be,Ke,We,Te,lt,Ue,it,tt,C,y,se,Xe,Ie,b,re,Ze,No,Ho,Bn,Wo,jo,Xo,qo,Yo,Ko,Uo,Jo,Qo,Zo,xo,$o,ei,ti,ni,oi,ii,ri,ai,li,si]}class bl extends ct{constructor(e){super(),ht(this,e,sl,ll,dt,{},null,[-1,-1,-1,-1])}}export{bl as default};
