import{S as Ve,i as Me,a as Te,l as R,b as U,u as le,m as S,p as D,c as z,j as u,v as oe,q as h,r as Et,d as M,H as w,O as F,h as A,x as pe,f as N,g as he,w as De,T as se,$ as sr,A as Z,B as Y,C as Q,n as Be,D as x,ag as Bt,a8 as $,aa as Je,y as Re,Z as xe,af as kt,a2 as bt,J as Zt,L as Yt,V as Qt,a6 as be,a7 as we,a5 as Fe,E as X,M as ge,a0 as ve,ah as ke,e as Xe,_ as ir,ai as ar,o as cr,aj as It,ab as ht,ac as _t,G as fr,U as ur,t as dr}from"../chunks/index.a1b1e1bc.js";import{f as yt,g as pr}from"../chunks/format-page-title.f8574fd6.js";import{F as Ee,p as hr,q as _r,r as mr,s as gr,t as vr,u as kr,v as br,w as wr,x as Er,y as Br,z as Ir}from"../chunks/fa.5e0f40b0.js";import{a as yr,c as Dr,t as Cr}from"../chunks/index.84794016.js";import{P as Ze,m as te,M as Dt,r as Rr}from"../chunks/merged-header-icon.bb3cbc13.js";import{f as Ce,Z as Sr,aj as Ye,aD as Qe,aE as xt,aF as er,aG as tr,c as Tr,g as wt,ah as mt,aH as Pr,a5 as G,i as Or,aI as Le,aJ as Ct,a4 as Pe,aK as Ge,aL as ee,Y as Vr,aM as rr,W as Oe,aN as Mr,X as Ar,aO as Lr,aP as gt,aQ as vt,aR as $e,aS as Rt,aT as St,j as Ue,m as ut,U as Tt,A as Nr,aa as $r,a as Se,M as We,p as Ur,aU as zr,ab as Pt,aV as Fr,ai as Gr,aW as jr}from"../chunks/store.16eecc84.js";import{v as lr,a as Ot,m as ze,p as Hr}from"../chunks/error-handler.2c73d00e.js";function Vt(l){let e,t;return e=new Ee({props:{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",icon:yr}}),{c(){Z(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Be,i(r){t||(A(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Mt(l){let e,t,r,n;return{c(){e=R("img"),this.h()},l(i){e=S(i,"IMG",{decoding:!0,loading:!0,referrerpolicy:!0,class:!0,src:!0,alt:!0}),this.h()},h(){h(e,"decoding","async"),h(e,"loading","lazy"),h(e,"referrerpolicy","no-referrer"),h(e,"class","relative h-full w-full object-cover transition delay-150 duration-700 ease-out"),Bt(e.src,t=l[7](l[0]))||h(e,"src",t),h(e,"alt",l[5]),$(e,"blur",!l[6])},m(i,a){M(i,e,a),l[10](e),r||(n=F(e,"load",l[11]),r=!0)},p(i,a){a&1&&!Bt(e.src,t=i[7](i[0]))&&h(e,"src",t),a&32&&h(e,"alt",i[5]),a&64&&$(e,"blur",!i[6])},d(i){i&&u(e),l[10](null),r=!1,n()}}}function qr(l){let e,t,r,n,i,a,s,o,c,f,g,_,p=`${l[2]*100}%`,k,C,y,E=!l[6]&&Vt(),d=l[0]&&Mt(l);return{c(){e=R("div"),t=R("div"),r=R("div"),E&&E.c(),n=U(),d&&d.c(),i=U(),a=R("div"),s=R("div"),o=R("span"),c=le(l[1]),f=U(),g=R("div"),_=R("div"),this.h()},l(m){e=S(m,"DIV",{class:!0,role:!0});var P=D(e);t=S(P,"DIV",{class:!0});var I=D(t);r=S(I,"DIV",{class:!0});var b=D(r);E&&E.l(b),n=z(b),d&&d.l(b),b.forEach(u),i=z(I),a=S(I,"DIV",{class:!0});var v=D(a);s=S(v,"DIV",{class:!0});var L=D(s);o=S(L,"SPAN",{class:!0});var q=D(o);c=oe(q,l[1]),q.forEach(u),L.forEach(u),f=z(v),g=S(v,"DIV",{class:!0});var W=D(g);_=S(W,"DIV",{class:!0}),D(_).forEach(u),W.forEach(u),v.forEach(u),I.forEach(u),P.forEach(u),this.h()},h(){h(r,"class","h-full w-full text-5xl sm:text-7xl"),h(o,"class","line-clamp-3"),h(s,"class","sm:h-21 h-16 bg-gray-800 bg-opacity-80 p-0.5 px-1.5 text-justify text-sm text-white sm:p-1.5 sm:text-base"),h(_,"class","h-full rounded bg-gradient-to-b from-red-600 to-red-900"),Et(_,"width",p),h(g,"class","h-2.5 bg-gray-400 bg-opacity-80"),h(a,"class","absolute inset-x-0 bottom-0"),h(t,"class","inline"),h(e,"class","aspect-w-2 aspect-h-3 relative cursor-pointer"),h(e,"role","button")},m(m,P){M(m,e,P),w(e,t),w(t,r),E&&E.m(r,null),w(r,n),d&&d.m(r,null),w(t,i),w(t,a),w(a,s),w(s,o),w(o,c),w(a,f),w(a,g),w(g,_),k=!0,C||(y=[F(e,"click",l[8]),F(e,"keyup",l[9])],C=!0)},p(m,[P]){m[6]?E&&(pe(),N(E,1,1,()=>{E=null}),he()):E?(E.p(m,P),P&64&&A(E,1)):(E=Vt(),E.c(),A(E,1),E.m(r,n)),m[0]?d?d.p(m,P):(d=Mt(m),d.c(),d.m(r,null)):d&&(d.d(1),d=null),(!k||P&2)&&De(c,m[1]),P&4&&p!==(p=`${m[2]*100}%`)&&Et(_,"width",p)},i(m){k||(A(E),k=!0)},o(m){N(E),k=!1},d(m){m&&u(e),E&&E.d(),d&&d.d(),C=!1,se(y)}}}function Wr(l,e,t){let r,n,{imagePath:i}=e,{title:a}=e,{progress:s}=e,o="";sr(()=>{o&&URL.revokeObjectURL(o)});function c(d){return o&&(URL.revokeObjectURL(o),o=""),typeof d!="string"?(o=URL.createObjectURL(d),o):d}function f(){let d,m;const P=I=>d?d instanceof Blob&&I instanceof Blob?d.type===I.type&&d.size===I.size:typeof d!="object"||typeof I!="object"?d===I:!1:!1;return I=>(P(I)||(d=I,m=c(I)),m)}const g=f();let _,p=!0;function k(d){Je.call(this,l,d)}function C(d){Je.call(this,l,d)}function y(d){Re[d?"unshift":"push"](()=>{_=d,t(3,_)})}const E=()=>t(4,p=!1);return l.$$set=d=>{"imagePath"in d&&t(0,i=d.imagePath),"title"in d&&t(1,a=d.title),"progress"in d&&t(2,s=d.progress)},l.$$.update=()=>{l.$$.dirty&24&&t(6,r=(_==null?void 0:_.complete)&&!p),l.$$.dirty&2&&t(5,n=`${a}_cover`)},[i,a,s,_,p,n,r,g,k,C,y,E]}class Kr extends Ve{constructor(e){super(),Me(this,e,Wr,qr,Te,{imagePath:0,title:1,progress:2})}}function At(l,e,t){const r=l.slice();return r[11]=e[t],r}function Lt(l){let e,t,r,n,i;t=new Ee({props:{class:"absolute left-2 top-2 flex text-xl text-white",icon:hr}});function a(){return l[7](l[11])}return{c(){e=R("div"),Z(t.$$.fragment),this.h()},l(s){e=S(s,"DIV",{class:!0});var o=D(e);Y(t.$$.fragment,o),o.forEach(u),this.h()},h(){h(e,"class","absolute inset-0 cursor-pointer bg-gray-700 bg-opacity-20")},m(s,o){M(s,e,o),Q(t,e,null),r=!0,n||(i=[F(e,"click",a),F(e,"keyup",Ce)],n=!0)},p(s,o){l=s},i(s){r||(A(t.$$.fragment,s),r=!0)},o(s){N(t.$$.fragment,s),r=!1},d(s){s&&u(e),x(t),n=!1,se(i)}}}function Nt(l){let e,t,r;return t=new Ze({props:{placement:"right",fallbackPlacements:["bottom"],yOffset:5,$$slots:{content:[Xr],icon:[Jr]},$$scope:{ctx:l}}}),{c(){e=R("div"),Z(t.$$.fragment),this.h()},l(n){e=S(n,"DIV",{class:!0});var i=D(e);Y(t.$$.fragment,i),i.forEach(u),this.h()},h(){h(e,"class","absolute top-10 left-2")},m(n,i){M(n,e,i),Q(t,e,null),r=!0},p(n,i){const a={};i&16385&&(a.$$scope={dirty:i,ctx:n}),t.$set(a)},i(n){r||(A(t.$$.fragment,n),r=!0)},o(n){N(t.$$.fragment,n),r=!1},d(n){n&&u(e),x(t)}}}function Jr(l){let e,t;return e=new Ee({props:{slot:"icon",class:"mdc-elevation--z2 hover:mdc-elevation--z8 mdc-elevation-transition left-2 top-10 rounded-full bg-blue-400 text-xl text-white",icon:_r}}),{c(){Z(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Be,i(r){t||(A(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Xr(l){let e,t,r,n,i,a=(l[11].characters||"No Data")+"",s,o,c,f,g,_,p=Ae(l[11].lastBookOpen)+"",k,C,y,E,d,m,P=Ae(l[11].lastBookmarkModified)+"",I,b,v,L,q,W,J=Ae(l[11].lastBookModified)+"",fe;return{c(){e=R("div"),t=R("div"),r=le("Characters:"),n=U(),i=R("div"),s=le(a),o=U(),c=R("div"),f=le("Last Read:"),g=U(),_=R("div"),k=le(p),C=U(),y=R("div"),E=le("Bookmarked:"),d=U(),m=R("div"),I=le(P),b=U(),v=R("div"),L=le("Last Update:"),q=U(),W=R("div"),fe=le(J),this.h()},l(V){e=S(V,"DIV",{class:!0,slot:!0});var O=D(e);t=S(O,"DIV",{});var re=D(t);r=oe(re,"Characters:"),re.forEach(u),n=z(O),i=S(O,"DIV",{class:!0});var Ie=D(i);s=oe(Ie,a),Ie.forEach(u),o=z(O),c=S(O,"DIV",{class:!0});var me=D(c);f=oe(me,"Last Read:"),me.forEach(u),g=z(O),_=S(O,"DIV",{class:!0});var _e=D(_);k=oe(_e,p),_e.forEach(u),C=z(O),y=S(O,"DIV",{class:!0});var ie=D(y);E=oe(ie,"Bookmarked:"),ie.forEach(u),d=z(O),m=S(O,"DIV",{class:!0});var ue=D(m);I=oe(ue,P),ue.forEach(u),b=z(O),v=S(O,"DIV",{class:!0});var de=D(v);L=oe(de,"Last Update:"),de.forEach(u),q=z(O),W=S(O,"DIV",{class:!0});var ye=D(W);fe=oe(ye,J),ye.forEach(u),O.forEach(u),this.h()},h(){h(i,"class","w-40"),h(c,"class","mt-4"),h(_,"class","w-40"),h(y,"class","mt-4"),h(m,"class","w-40"),h(v,"class","mt-4"),h(W,"class","w-40"),h(e,"class","p-4"),h(e,"slot","content")},m(V,O){M(V,e,O),w(e,t),w(t,r),w(e,n),w(e,i),w(i,s),w(e,o),w(e,c),w(c,f),w(e,g),w(e,_),w(_,k),w(e,C),w(e,y),w(y,E),w(e,d),w(e,m),w(m,I),w(e,b),w(e,v),w(v,L),w(e,q),w(e,W),w(W,fe)},p(V,O){O&1&&a!==(a=(V[11].characters||"No Data")+"")&&De(s,a),O&1&&p!==(p=Ae(V[11].lastBookOpen)+"")&&De(k,p),O&1&&P!==(P=Ae(V[11].lastBookmarkModified)+"")&&De(I,P),O&1&&J!==(J=Ae(V[11].lastBookModified)+"")&&De(fe,J)},d(V){V&&u(e)}}}function $t(l){let e,t,r,n,i;function a(){return l[8](l[11])}return{c(){e=R("div"),t=be("svg"),r=be("path"),this.h()},l(s){e=S(s,"DIV",{class:!0});var o=D(e);t=we(o,"svg",{role:!0,class:!0,xmlns:!0,viewBox:!0});var c=D(t);r=we(c,"path",{class:!0,d:!0}),D(r).forEach(u),c.forEach(u),o.forEach(u),this.h()},h(){h(r,"class","fill-current text-white"),h(r,"d","M369.6 313.1c4.7 4.7 4.7 12.3 0 17L330 369.6c-4.7 4.7-12.3 4.7-17 0L248 304l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L126.4 330c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L304 248l65.6 65.1z"),h(t,"role","img"),h(t,"class","w-full"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"viewBox","0 0 504 504"),h(e,"class","mdc-elevation--z2 hover:mdc-elevation--z8 mdc-elevation-transition absolute -top-2 -right-2 h-6 w-6 cursor-pointer rounded-full bg-red-400")},m(s,o){M(s,e,o),w(e,t),w(t,r),n||(i=[F(e,"click",a),F(e,"keyup",Ce)],n=!0)},p(s,o){l=s},d(s){s&&u(e),n=!1,se(i)}}}function Ut(l,e){let t,r,n,i,a=e[2].has(e[11].id),s,o=e[2].has(e[11].id),c,f,g,_,p;const k=[e[11]];function C(){return e[6](e[11])}let y={};for(let I=0;I<k.length;I+=1)y=Zt(y,k[I]);n=new Kr({props:y}),n.$on("click",C);let E=a&&Lt(e),d=o&&Nt(e),m=e[11].id===e[3]&&$t(e);function P(){return e[9](e[11])}return{key:l,first:null,c(){t=R("div"),r=R("div"),Z(n.$$.fragment),i=U(),E&&E.c(),s=U(),d&&d.c(),c=U(),m&&m.c(),f=U(),this.h()},l(I){t=S(I,"DIV",{class:!0});var b=D(t);r=S(b,"DIV",{class:!0});var v=D(r);Y(n.$$.fragment,v),i=z(v),E&&E.l(v),v.forEach(u),s=z(b),d&&d.l(b),c=z(b),m&&m.l(b),f=z(b),b.forEach(u),this.h()},h(){h(r,"class","mdc-elevation--z1 hover:mdc-elevation--z8 mdc-elevation-transition relative overflow-hidden"),$(r,"rounded-tl-xl",e[11].id===e[1]),$(r,"mdc-elevation--z4",e[2].has(e[11].id)||e[11].id===e[1]),h(t,"class","relative"),$(t,"opacity-60",e[11].isPlaceholder),this.first=t},m(I,b){M(I,t,b),w(t,r),Q(n,r,null),w(r,i),E&&E.m(r,null),w(t,s),d&&d.m(t,null),w(t,c),m&&m.m(t,null),w(t,f),g=!0,_||(p=[F(t,"mouseenter",P),F(t,"mouseleave",e[10])],_=!0)},p(I,b){e=I;const v=b&1?Yt(k,[Qt(e[11])]):{};n.$set(v),b&5&&(a=e[2].has(e[11].id)),a?E?(E.p(e,b),b&5&&A(E,1)):(E=Lt(e),E.c(),A(E,1),E.m(r,null)):E&&(pe(),N(E,1,1,()=>{E=null}),he()),(!g||b&3)&&$(r,"rounded-tl-xl",e[11].id===e[1]),(!g||b&7)&&$(r,"mdc-elevation--z4",e[2].has(e[11].id)||e[11].id===e[1]),b&5&&(o=e[2].has(e[11].id)),o?d?(d.p(e,b),b&5&&A(d,1)):(d=Nt(e),d.c(),A(d,1),d.m(t,c)):d&&(pe(),N(d,1,1,()=>{d=null}),he()),e[11].id===e[3]?m?m.p(e,b):(m=$t(e),m.c(),m.m(t,f)):m&&(m.d(1),m=null),(!g||b&1)&&$(t,"opacity-60",e[11].isPlaceholder)},i(I){g||(A(n.$$.fragment,I),A(E),A(d),g=!0)},o(I){N(n.$$.fragment,I),N(E),N(d),g=!1},d(I){I&&u(t),x(n),E&&E.d(),d&&d.d(),m&&m.d(),_=!1,se(p)}}}function Zr(l){let e,t=[],r=new Map,n,i=l[0];const a=s=>s[11].id;for(let s=0;s<i.length;s+=1){let o=At(l,i,s),c=a(o);r.set(c,t[s]=Ut(c,o))}return{c(){e=R("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=S(s,"DIV",{class:!0});var o=D(e);for(let c=0;c<t.length;c+=1)t[c].l(o);o.forEach(u),this.h()},h(){h(e,"class","grid grid-cols-3 justify-between gap-5 pb-4 md:grid-cols-4 lg:grid-cols-5")},m(s,o){M(s,e,o);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);n=!0},p(s,[o]){o&63&&(i=s[0],pe(),t=xe(t,o,a,1,s,i,r,e,kt,Ut,null,At),he())},i(s){if(!n){for(let o=0;o<i.length;o+=1)A(t[o]);n=!0}},o(s){for(let o=0;o<t.length;o+=1)N(t[o]);n=!1},d(s){s&&u(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Ae(l){return l?new Date(l).toLocaleString():"No Data"}function Yr(l,e,t){let{bookCards:r=[]}=e,{currentBookId:n}=e,{selectedBookIds:i}=e;const a=bt();let s;function o(k){a("bookClick",{id:k})}const c=k=>o(k.id),f=k=>o(k.id),g=k=>a("removeBookClick",{id:k.id}),_=k=>t(3,s=k.id),p=()=>t(3,s=void 0);return l.$$set=k=>{"bookCards"in k&&t(0,r=k.bookCards),"currentBookId"in k&&t(1,n=k.currentBookId),"selectedBookIds"in k&&t(2,i=k.selectedBookIds)},[r,n,i,s,a,o,c,f,g,_,p]}class Qr extends Ve{constructor(e){super(),Me(this,e,Yr,Zr,Te,{bookCards:0,currentBookId:1,selectedBookIds:2})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2023, ッツ Reader Authors
 * All rights reserved.
 */function xr(l){l.setAttribute("webkitdirectory","")}/**
 * @license BSD-3-Clause
 * Copyright (c) 2023, ッツ Reader Authors
 * All rights reserved.
 */function Ke(l,e){const t=()=>{var r;(r=l.files)!=null&&r.length&&(e(l.files),l.value="")};return l.addEventListener("change",t),{destroy(){l.removeEventListener("change",t)}}}function zt(l,e,t){const r=l.slice();r[49]=e[t];const n=r[16][r[8]].property===r[49].property;r[50]=n;const i=r[50]&&r[16][r[8]].direction===Ge.ASC;return r[51]=i,r}function Ft(l,e,t){const r=l.slice();return r[54]=e[t],r}function el(l){let e,t,r,n,i,a,s,o,c,f;return t=new Ze({props:{contentText:l[4],contentStyles:"padding: 0.75rem",eventType:"pointer",$$slots:{default:[rl]},$$scope:{ctx:l}}}),{c(){e=R("div"),Z(t.$$.fragment),r=U(),n=R("progress"),i=U(),a=R("div"),s=le(l[7]),this.h()},l(g){e=S(g,"DIV",{class:!0});var _=D(e);Y(t.$$.fragment,_),r=z(_),n=S(_,"PROGRESS",{class:!0,max:!0}),D(n).forEach(u),i=z(_),a=S(_,"DIV",{class:!0});var p=D(a);s=oe(p,l[7]),p.forEach(u),_.forEach(u),this.h()},h(){h(n,"class","mx-4 w-full"),n.value=l[5],h(n,"max",l[6]),h(a,"class","ml-4 min-w-fit"),h(e,"class","mx-auto flex h-full transform-gpu items-center justify-center px-4 md:px-8 lg:max-w-4xl xl:max-w-none 2xl:max-w-6xl")},m(g,_){M(g,e,_),Q(t,e,null),w(e,r),w(e,n),w(e,i),w(e,a),w(a,s),f=!0},p(g,_){l=g;const p={};_[0]&16&&(p.contentText=l[4]),_[1]&67108864&&(p.$$scope={dirty:_,ctx:l}),t.$set(p),(!f||_[0]&32)&&(n.value=l[5]),(!f||_[0]&64)&&h(n,"max",l[6]),(!f||_[0]&128)&&De(s,l[7])},i(g){f||(A(t.$$.fragment,g),ge(()=>{c&&c.end(1),o=ve(e,ee,l[21]),o.start()}),f=!0)},o(g){N(t.$$.fragment,g),o&&o.invalidate(),c=ke(e,ee,l[22]),f=!1},d(g){g&&u(e),x(t),g&&c&&c.end()}}}function tl(l){let e,t,r,n,i,a,s,o,c,f,g;const _=[ol,ll],p=[];function k(P,I){return P[2]===0?0:1}t=k(l),r=p[t]=_[t](l);const C=[sl,nl],y=[];function E(P,I){return P[0]?1:0}a=E(l),s=y[a]=C[a](l);let d=!l[0]&&jt(l),m=l[2]>0&&Kt(l);return{c(){e=R("div"),r.c(),n=U(),i=R("div"),s.c(),o=U(),c=R("div"),d&&d.c(),f=U(),m&&m.c(),this.h()},l(P){e=S(P,"DIV",{class:!0});var I=D(e);r.l(I),n=z(I),i=S(I,"DIV",{class:!0});var b=D(i);s.l(b),b.forEach(u),o=z(I),c=S(I,"DIV",{class:!0});var v=D(c);d&&d.l(v),f=z(v),m&&m.l(v),v.forEach(u),I.forEach(u),this.h()},h(){h(i,"class","absolute left-1/2 h-full -translate-x-1/2 transform-gpu"),h(c,"class","flex transform-gpu "+Vr),h(e,"class","flex h-full justify-between "+rr)},m(P,I){M(P,e,I),p[t].m(e,null),w(e,n),w(e,i),y[a].m(i,null),w(e,o),w(e,c),d&&d.m(c,null),w(c,f),m&&m.m(c,null),g=!0},p(P,I){let b=t;t=k(P),t===b?p[t].p(P,I):(pe(),N(p[b],1,1,()=>{p[b]=null}),he(),r=p[t],r?r.p(P,I):(r=p[t]=_[t](P),r.c()),A(r,1),r.m(e,n));let v=a;a=E(P),a===v?y[a].p(P,I):(pe(),N(y[v],1,1,()=>{y[v]=null}),he(),s=y[a],s?s.p(P,I):(s=y[a]=C[a](P),s.c()),A(s,1),s.m(i,null)),P[0]?d&&(pe(),N(d,1,1,()=>{d=null}),he()):d?(d.p(P,I),I[0]&1&&A(d,1)):(d=jt(P),d.c(),A(d,1),d.m(c,f)),P[2]>0?m?(m.p(P,I),I[0]&4&&A(m,1)):(m=Kt(P),m.c(),A(m,1),m.m(c,null)):m&&(pe(),N(m,1,1,()=>{m=null}),he())},i(P){g||(A(r),A(s),A(d),A(m),g=!0)},o(P){N(r),N(s),N(d),N(m),g=!1},d(P){P&&u(e),p[t].d(),y[a].d(),d&&d.d(),m&&m.d()}}}function rl(l){let e,t,r,n,i;return t=new Ee({props:{icon:mr,class:"cursor-pointer"}}),{c(){e=R("div"),Z(t.$$.fragment)},l(a){e=S(a,"DIV",{});var s=D(e);Y(t.$$.fragment,s),s.forEach(u)},m(a,s){M(a,e,s),Q(t,e,null),r=!0,n||(i=[F(e,"click",l[48]),F(e,"keyup",Ce)],n=!0)},p:Be,i(a){r||(A(t.$$.fragment,a),r=!0)},o(a){N(t.$$.fragment,a),r=!1},d(a){a&&u(e),x(t),n=!1,se(i)}}}function ll(l){let e,t,r,n,i,a,s,o,c,f,g,_,p;return r=new Ee({props:{icon:kr}}),{c(){e=R("div"),t=R("div"),Z(r.$$.fragment),a=U(),s=R("span"),o=le(l[2]),this.h()},l(k){e=S(k,"DIV",{class:!0});var C=D(e);t=S(C,"DIV",{class:!0});var y=D(t);Y(r.$$.fragment,y),y.forEach(u),a=z(C),s=S(C,"SPAN",{class:!0});var E=D(s);o=oe(E,l[2]),E.forEach(u),C.forEach(u),this.h()},h(){h(t,"class","flex h-full items-center text-2xl xl:text-xl "+Mr+" cursor-pointer"),h(s,"class","translate-x-2 transform-gpu"),h(e,"class","flex h-full transform-gpu items-center "+Ar+" text-xl font-medium")},m(k,C){M(k,e,C),w(e,t),Q(r,t,null),w(e,a),w(e,s),w(s,o),g=!0,_||(p=[F(t,"click",l[37]),F(t,"keyup",Ce)],_=!0)},p(k,C){l=k,(!g||C[0]&4)&&De(o,l[2])},i(k){g||(A(r.$$.fragment,k),ge(()=>{i&&i.end(1),n=ve(t,ee,l[21]),n.start()}),ge(()=>{f&&f.end(1),c=ve(s,ee,l[21]),c.start()}),g=!0)},o(k){N(r.$$.fragment,k),n&&n.invalidate(),i=ke(t,ee,l[22]),c&&c.invalidate(),f=ke(s,ee,l[22]),g=!1},d(k){k&&u(e),x(r),k&&i&&i.end(),k&&f&&f.end(),_=!1,se(p)}}}function ol(l){let e,t,r,n,i,a,s,o;return{c(){e=R("div"),t=be("svg"),r=be("path"),this.h()},l(c){e=S(c,"DIV",{class:!0});var f=D(e);t=we(f,"svg",{viewBox:!0,xmlns:!0,class:!0});var g=D(t);r=we(g,"path",{class:!0,d:!0}),D(r).forEach(u),g.forEach(u),f.forEach(u),this.h()},h(){h(r,"class","fill-current"),h(r,"d","M20,4v12H8V4H20 M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4C22,2.9,21.1,2,20,2L20,2z M12.47,14 L9,10.5l1.4-1.41l2.07,2.08L17.6,6L19,7.41L12.47,14z M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z"),h(t,"viewBox","0 0 24 24"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"class",Oe),$(t,"opacity-100",l[0]),$(t,"opacity-60",!l[0]),h(e,"class","transform-gpu "+hl)},m(c,f){M(c,e,f),w(e,t),w(t,r),a=!0,s||(o=[F(t,"click",l[36]),F(t,"keyup",Ce)],s=!0)},p(c,f){l=c,(!a||f[0]&1)&&$(t,"opacity-100",l[0]),(!a||f[0]&1)&&$(t,"opacity-60",!l[0])},i(c){a||(ge(()=>{i&&i.end(1),n=ve(e,ee,l[21]),n.start()}),a=!0)},o(c){n&&n.invalidate(),i=ke(e,ee,l[22]),a=!1},d(c){c&&u(e),c&&i&&i.end(),s=!1,se(o)}}}function nl(l){let e,t,r,n,i,a,s;return{c(){e=be("svg"),t=be("path"),this.h()},l(o){e=we(o,"svg",{xmlns:!0,viewBox:!0,class:!0});var c=D(e);t=we(c,"path",{class:!0,d:!0}),D(t).forEach(u),c.forEach(u),this.h()},h(){h(t,"class","fill-current"),h(t,"d","M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 0 24 24"),h(e,"class",Oe)},m(o,c){M(o,e,c),w(e,t),i=!0,a||(s=[F(e,"click",l[39]),F(e,"keyup",Ce)],a=!0)},p(o,c){l=o},i(o){i||(ge(()=>{n&&n.end(1),r=ve(e,ee,l[21]),r.start()}),i=!0)},o(o){r&&r.invalidate(),n=ke(e,ee,l[22]),i=!1},d(o){o&&u(e),o&&n&&n.end(),a=!1,se(s)}}}function sl(l){let e,t,r=l[1]&&Gt(l);return{c(){r&&r.c(),e=Xe()},l(n){r&&r.l(n),e=Xe()},m(n,i){r&&r.m(n,i),M(n,e,i),t=!0},p(n,i){n[1]?r?(r.p(n,i),i[0]&2&&A(r,1)):(r=Gt(n),r.c(),A(r,1),r.m(e.parentNode,e)):r&&(pe(),N(r,1,1,()=>{r=null}),he())},i(n){t||(A(r),t=!0)},o(n){N(r),t=!1},d(n){r&&r.d(n),n&&u(e)}}}function Gt(l){let e,t,r,n,i,a,s;return{c(){e=be("svg"),t=be("path"),this.h()},l(o){e=we(o,"svg",{xmlns:!0,viewBox:!0,class:!0});var c=D(e);t=we(c,"path",{class:!0,d:!0}),D(t).forEach(u),c.forEach(u),this.h()},h(){h(t,"class","fill-current"),h(t,"d","M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1zm0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5v11.5zm-3.5-8c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99zM13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83zm4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 0 24 24"),h(e,"class",Oe)},m(o,c){M(o,e,c),w(e,t),i=!0,a||(s=[F(e,"click",l[38]),F(e,"keyup",Ce)],a=!0)},p(o,c){l=o},i(o){i||(ge(()=>{n&&n.end(1),r=ve(e,ee,l[21]),r.start()}),i=!0)},o(o){r&&r.invalidate(),n=ke(e,ee,l[22]),i=!1},d(o){o&&u(e),o&&n&&n.end(),a=!1,se(s)}}}function jt(l){let e,t,r,n,i,a,s,o,c,f,g,_,p,k,C,y,E,d,m,P;t=new Dt({props:{items:l[23],mergeTo:te.FILE_IMPORT}}),t.$on("action",l[25]);let I={placement:"bottom",fallbackPlacements:["bottom-end","bottom-start"],yOffset:0,$$slots:{content:[al],icon:[il]},$$scope:{ctx:l}};s=new Ze({props:I}),l[41](s);let b={placement:"bottom",fallbackPlacements:["bottom-end","bottom-start"],yOffset:0,$$slots:{content:[dl],icon:[ul]},$$scope:{ctx:l}};return _=new Ze({props:b}),l[44](_),E=new Dt({props:{items:l[14]?[te.MANAGE,te.DOMAIN_HINT,te.BUG_REPORT,te.SETTINGS]:[te.MANAGE,te.BUG_REPORT,te.SETTINGS]}}),E.$on("action",l[45]),{c(){e=R("div"),Z(t.$$.fragment),i=U(),a=R("div"),Z(s.$$.fragment),f=U(),g=R("div"),Z(_.$$.fragment),C=U(),y=R("div"),Z(E.$$.fragment),this.h()},l(v){e=S(v,"DIV",{class:!0});var L=D(e);Y(t.$$.fragment,L),L.forEach(u),i=z(v),a=S(v,"DIV",{class:!0});var q=D(a);Y(s.$$.fragment,q),q.forEach(u),f=z(v),g=S(v,"DIV",{class:!0});var W=D(g);Y(_.$$.fragment,W),W.forEach(u),C=z(v),y=S(v,"DIV",{class:!0});var J=D(y);Y(E.$$.fragment,J),J.forEach(u),this.h()},h(){h(e,"class","relative transform-gpu"),h(a,"class","relative transform-gpu"),h(g,"class","relative transform-gpu"),h(y,"class","relative transform-gpu")},m(v,L){M(v,e,L),Q(t,e,null),M(v,i,L),M(v,a,L),Q(s,a,null),M(v,f,L),M(v,g,L),Q(_,g,null),M(v,C,L),M(v,y,L),Q(E,y,null),P=!0},p(v,L){l=v;const q={};L[0]&921856|L[1]&67108864&&(q.$$scope={dirty:L,ctx:l}),s.$set(q);const W={};L[0]&98560|L[1]&67108864&&(W.$$scope={dirty:L,ctx:l}),_.$set(W);const J={};L[0]&16384&&(J.items=l[14]?[te.MANAGE,te.DOMAIN_HINT,te.BUG_REPORT,te.SETTINGS]:[te.MANAGE,te.BUG_REPORT,te.SETTINGS]),E.$set(J)},i(v){P||(A(t.$$.fragment,v),ge(()=>{n&&n.end(1),r=ve(e,ee,l[21]),r.start()}),A(s.$$.fragment,v),ge(()=>{c&&c.end(1),o=ve(a,ee,l[21]),o.start()}),A(_.$$.fragment,v),ge(()=>{k&&k.end(1),p=ve(g,ee,l[21]),p.start()}),A(E.$$.fragment,v),ge(()=>{m&&m.end(1),d=ve(y,ee,l[21]),d.start()}),P=!0)},o(v){N(t.$$.fragment,v),r&&r.invalidate(),n=ke(e,ee,l[22]),N(s.$$.fragment,v),o&&o.invalidate(),c=ke(a,ee,l[22]),N(_.$$.fragment,v),p&&p.invalidate(),k=ke(g,ee,l[22]),N(E.$$.fragment,v),d&&d.invalidate(),m=ke(y,ee,l[22]),P=!1},d(v){v&&u(e),x(t),v&&n&&n.end(),v&&u(i),v&&u(a),l[41](null),x(s),v&&c&&c.end(),v&&u(f),v&&u(g),l[44](null),x(_),v&&k&&k.end(),v&&u(C),v&&u(y),x(E),v&&m&&m.end()}}}function Ht(l){let e,t,r,n;return{c(){e=be("svg"),t=be("path"),this.h()},l(i){e=we(i,"svg",{class:!0,xmlns:!0,viewBox:!0});var a=D(e);t=we(a,"path",{class:!0,d:!0}),D(t).forEach(u),a.forEach(u),this.h()},h(){h(t,"class","fill-current"),h(t,"d",r=l[19].d),h(e,"class",Oe),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox",n=l[19].viewBox)},m(i,a){M(i,e,a),w(e,t)},p(i,a){a[0]&524288&&r!==(r=i[19].d)&&h(t,"d",r),a[0]&524288&&n!==(n=i[19].viewBox)&&h(e,"viewBox",n)},d(i){i&&u(e)}}}function il(l){let e,t=l[19],r=Ht(l);return{c(){e=R("div"),r.c(),this.h()},l(n){e=S(n,"DIV",{slot:!0});var i=D(e);r.l(i),i.forEach(u),this.h()},h(){h(e,"slot","icon")},m(n,i){M(n,e,i),r.m(e,null)},p(n,i){i[0]&524288&&Te(t,t=n[19])?(r.d(1),r=Ht(n),r.c(),r.m(e,null)):r.p(n,i)},d(n){n&&u(e),r.d(n)}}}function qt(l,e){let t,r=e[54].label+"",n,i,a,s;function o(){return e[40](e[54])}return{key:l,first:null,c(){t=R("div"),n=le(r),i=U(),this.h()},l(c){t=S(c,"DIV",{role:!0,class:!0});var f=D(t);n=oe(f,r),i=z(f),f.forEach(u),this.h()},h(){h(t,"role","button"),h(t,"class","cursor-pointer px-4 py-2 text-sm hover:bg-white hover:text-gray-700"),$(t,"hover:bg-white",!e[54].requiresConnectivity||e[17]),$(t,"hover:text-gray-700",!e[54].requiresConnectivity||e[17]),$(t,"cursor-not-allowed",e[54].requiresConnectivity&&!e[17]),$(t,"text-gray-500",e[54].requiresConnectivity&&!e[17]),this.first=t},m(c,f){M(c,t,f),w(t,n),w(t,i),a||(s=[F(t,"click",o),F(t,"keyup",Ce)],a=!0)},p(c,f){e=c,f[0]&16908288&&$(t,"hover:bg-white",!e[54].requiresConnectivity||e[17]),f[0]&16908288&&$(t,"hover:text-gray-700",!e[54].requiresConnectivity||e[17]),f[0]&16908288&&$(t,"cursor-not-allowed",e[54].requiresConnectivity&&!e[17]),f[0]&16908288&&$(t,"text-gray-500",e[54].requiresConnectivity&&!e[17])},d(c){c&&u(t),a=!1,se(s)}}}function al(l){let e,t=[],r=new Map,n=l[24];const i=a=>a[54].key;for(let a=0;a<n.length;a+=1){let s=Ft(l,n,a),o=i(s);r.set(o,t[a]=qt(o,s))}return{c(){e=R("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=S(a,"DIV",{class:!0,slot:!0});var s=D(e);for(let o=0;o<t.length;o+=1)t[o].l(s);s.forEach(u),this.h()},h(){h(e,"class","w-28 bg-gray-700"),h(e,"slot","content")},m(a,s){M(a,e,s);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(a,s){s[0]&17174784&&(n=a[24],t=xe(t,s,i,1,a,n,r,e,ir,qt,null,Ft))},d(a){a&&u(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function cl(l){let e,t;return e=new Ee({props:{icon:Er}}),{c(){Z(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Be,i(r){t||(A(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function fl(l){let e,t;return e=new Ee({props:{icon:Br}}),{c(){Z(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Be,i(r){t||(A(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function ul(l){let e,t,r,n;const i=[fl,cl],a=[];function s(o,c){return o[16][o[8]].direction===Ge.ASC?0:1}return t=s(l),r=a[t]=i[t](l),{c(){e=R("div"),r.c(),this.h()},l(o){e=S(o,"DIV",{slot:!0,class:!0});var c=D(e);r.l(c),c.forEach(u),this.h()},h(){h(e,"slot","icon"),h(e,"class",Oe)},m(o,c){M(o,e,c),a[t].m(e,null),n=!0},p(o,c){let f=t;t=s(o),t===f?a[t].p(o,c):(pe(),N(a[f],1,1,()=>{a[f]=null}),he(),r=a[t],r?r.p(o,c):(r=a[t]=i[t](o),r.c()),A(r,1),r.m(e,null))},i(o){n||(A(r),n=!0)},o(o){N(r),n=!1},d(o){o&&u(e),a[t].d()}}}function Wt(l,e){let t,r,n,i,a,s=e[49].label+"",o,c,f,g,_,p,k,C;n=new Ee({props:{icon:br,class:"px-4"}});function y(){return e[42](e[49])}g=new Ee({props:{icon:wr,class:"mt-1 px-4"}});function E(){return e[43](e[49])}return{key:l,first:null,c(){t=R("div"),r=R("div"),Z(n.$$.fragment),i=U(),a=R("div"),o=le(s),c=U(),f=R("div"),Z(g.$$.fragment),_=U(),this.h()},l(d){t=S(d,"DIV",{class:!0});var m=D(t);r=S(m,"DIV",{class:!0,role:!0});var P=D(r);Y(n.$$.fragment,P),P.forEach(u),i=z(m),a=S(m,"DIV",{class:!0});var I=D(a);o=oe(I,s),I.forEach(u),c=z(m),f=S(m,"DIV",{class:!0,role:!0});var b=D(f);Y(g.$$.fragment,b),b.forEach(u),_=z(m),m.forEach(u),this.h()},h(){h(r,"class","self-center justify-self-start"),h(r,"role","button"),$(r,"text-red-500",e[51]),$(r,"hover:text-gray-700",e[51]),$(r,"hover:text-red-500",!e[51]),h(a,"class","py-2"),h(f,"class","justify-self-end hover:text-red-500"),h(f,"role","button"),$(f,"text-red-500",e[50]&&!e[51]),$(f,"hover:text-gray-700",e[50]&&!e[51]),$(f,"hover:text-red-500",!e[50]||e[51]),h(t,"class","grid cursor-default grid-cols-[auto_auto_auto] text-sm hover:bg-white hover:text-gray-700"),$(t,"bg-white",e[50]),$(t,"text-gray-700",e[50]),$(t,"hover:opacity-70",e[50]),this.first=t},m(d,m){M(d,t,m),w(t,r),Q(n,r,null),w(t,i),w(t,a),w(a,o),w(t,c),w(t,f),Q(g,f,null),w(t,_),p=!0,k||(C=[F(r,"click",y),F(r,"keyup",_l),F(f,"click",E),F(f,"keyup",ml)],k=!0)},p(d,m){e=d,(!p||m[0]&98560)&&$(r,"text-red-500",e[51]),(!p||m[0]&98560)&&$(r,"hover:text-gray-700",e[51]),(!p||m[0]&98560)&&$(r,"hover:text-red-500",!e[51]),(!p||m[0]&32768)&&s!==(s=e[49].label+"")&&De(o,s),(!p||m[0]&98560)&&$(f,"text-red-500",e[50]&&!e[51]),(!p||m[0]&98560)&&$(f,"hover:text-gray-700",e[50]&&!e[51]),(!p||m[0]&98560)&&$(f,"hover:text-red-500",!e[50]||e[51]),(!p||m[0]&98560)&&$(t,"bg-white",e[50]),(!p||m[0]&98560)&&$(t,"text-gray-700",e[50]),(!p||m[0]&98560)&&$(t,"hover:opacity-70",e[50])},i(d){p||(A(n.$$.fragment,d),A(g.$$.fragment,d),p=!0)},o(d){N(n.$$.fragment,d),N(g.$$.fragment,d),p=!1},d(d){d&&u(t),x(n),x(g),k=!1,se(C)}}}function dl(l){let e,t=[],r=new Map,n,i=l[15];const a=s=>s[49].property;for(let s=0;s<i.length;s+=1){let o=zt(l,i,s),c=a(o);r.set(c,t[s]=Wt(c,o))}return{c(){e=R("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=S(s,"DIV",{class:!0,slot:!0});var o=D(e);for(let c=0;c<t.length;c+=1)t[c].l(o);o.forEach(u),this.h()},h(){h(e,"class","w-44 bg-gray-700"),h(e,"slot","content")},m(s,o){M(s,e,o);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);n=!0},p(s,o){o[0]&268534016&&(i=s[15],pe(),t=xe(t,o,a,1,s,i,r,e,kt,Wt,null,zt),he())},i(s){if(!n){for(let o=0;o<i.length;o+=1)A(t[o]);n=!0}},o(s){for(let o=0;o<t.length;o+=1)N(t[o]);n=!1},d(s){s&&u(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Kt(l){let e,t,r,n,i,a,s,o,c,f,g,_;return t=new Ee({props:{icon:gr}}),s=new Ee({props:{icon:vr}}),{c(){e=R("div"),Z(t.$$.fragment),i=U(),a=R("div"),Z(s.$$.fragment),this.h()},l(p){e=S(p,"DIV",{class:!0});var k=D(e);Y(t.$$.fragment,k),k.forEach(u),i=z(p),a=S(p,"DIV",{class:!0});var C=D(a);Y(s.$$.fragment,C),C.forEach(u),this.h()},h(){h(e,"class","transform-gpu "+Oe),h(a,"class","transform-gpu "+Oe)},m(p,k){M(p,e,k),Q(t,e,null),M(p,i,k),M(p,a,k),Q(s,a,null),f=!0,g||(_=[F(e,"click",l[46]),F(e,"keyup",Ce),F(a,"click",l[47]),F(a,"keyup",Ce)],g=!0)},p(p,k){l=p},i(p){f||(A(t.$$.fragment,p),ge(()=>{n&&n.end(1),r=ve(e,ee,l[21]),r.start()}),A(s.$$.fragment,p),ge(()=>{c&&c.end(1),o=ve(a,ee,l[21]),o.start()}),f=!0)},o(p){N(t.$$.fragment,p),r&&r.invalidate(),n=ke(e,ee,l[22]),N(s.$$.fragment,p),o&&o.invalidate(),c=ke(a,ee,l[22]),f=!1},d(p){p&&u(e),x(t),p&&n&&n.end(),p&&u(i),p&&u(a),x(s),p&&c&&c.end(),g=!1,se(_)}}}function pl(l){let e,t,r,n,i,a,s,o,c,f,g,_;const p=[tl,el],k=[];function C(y,E){return y[6]?1:0}return o=C(l),c=k[o]=p[o](l),{c(){e=R("input"),t=U(),r=R("input"),n=U(),i=R("input"),a=U(),s=R("div"),c.c(),this.h()},l(y){e=S(y,"INPUT",{type:!0,accept:!0}),t=z(y),r=S(y,"INPUT",{type:!0}),n=z(y),i=S(y,"INPUT",{type:!0,accept:!0}),a=z(y),s=S(y,"DIV",{class:!0});var E=D(s);c.l(E),E.forEach(u),this.h()},h(){e.hidden=!0,e.multiple=!0,h(e,"type","file"),h(e,"accept",".htmlz,.epub"),r.hidden=!0,r.multiple=!0,h(r,"type","file"),i.hidden=!0,h(i,"type","file"),h(i,"accept",".zip"),h(s,"class",Sr)},m(y,E){M(y,e,E),l[33](e),M(y,t,E),M(y,r,E),l[34](r),M(y,n,E),M(y,i,E),l[35](i),M(y,a,E),M(y,s,E),k[o].m(s,null),f=!0,g||(_=[Fe(Ke.call(null,e,l[26])),Fe(xr.call(null,r)),Fe(Ke.call(null,r,l[26])),Fe(Ke.call(null,i,l[27]))],g=!0)},p(y,E){let d=o;o=C(y),o===d?k[o].p(y,E):(pe(),N(k[d],1,1,()=>{k[d]=null}),he(),c=k[o],c?c.p(y,E):(c=k[o]=p[o](y),c.c()),A(c,1),c.m(s,null))},i(y){f||(A(c),f=!0)},o(y){N(c),f=!1},d(y){y&&u(e),l[33](null),y&&u(t),y&&u(r),l[34](null),y&&u(n),y&&u(i),l[35](null),y&&u(a),y&&u(s),k[o].d(),g=!1,se(_)}}}const hl="-translate-x-3 xl:-translate-x-2.5",_l=()=>{},ml=()=>{};function gl(l,e,t){let r,n,i,a,s,o,c,f,g,_;X(l,Ye,T=>t(8,n=T)),X(l,Qe,T=>t(16,i=T)),X(l,xt,T=>t(29,a=T)),X(l,er,T=>t(30,s=T)),X(l,tr,T=>t(31,o=T)),X(l,Tr,T=>t(32,c=T)),X(l,wt,T=>t(17,f=T)),X(l,mt,T=>t(18,g=T)),X(l,Pr,T=>t(19,_=T));let{hasBookOpened:p}=e,{selectMode:k}=e,{selectedCount:C}=e,{hasBooks:y}=e,{cancelTooltip:E}=e,{replicationProgress:d}=e,{replicationToProgress:m}=e,{replicationProgressRemaining:P}=e;const I=bt(),b={delay:150,duration:150,easing:Ct},v={duration:150,easing:Ct},L=[te.FILE_IMPORT],q=[{label:"Browser",key:G.BROWSER,requiresConnectivity:!1}];let W,J,fe,V,O,re=!1;function Ie(T){switch(T.detail){case te.FOLDER_IMPORT.label:J.click();break;case te.BACKUP_IMPORT.label:fe.click();break;default:W.click();break}}function me(T){I("filesChange",T)}function _e(T){I("importBackup",T[0])}function ie(T,qe){const{property:ft,direction:B}=i[n];(ft!==T||B!==qe)&&Qe.next({...i,[n]:{property:T,direction:qe}}),O.toggleOpen()}function ue(T){Re[T?"unshift":"push"](()=>{W=T,t(9,W)})}function de(T){Re[T?"unshift":"push"](()=>{J=T,t(10,J)})}function ye(T){Re[T?"unshift":"push"](()=>{fe=T,t(11,fe)})}const et=()=>t(0,k=y&&!k),Ne=()=>t(0,k=!k),je=()=>I("backToBookClick"),tt=()=>I("selectAllClick"),rt=async T=>{T.requiresConnectivity&&!f||(T.key!==n&&(g||Pe(window,T.key).clearData(),Ye.next(T.key)),V.toggleOpen())};function lt(T){Re[T?"unshift":"push"](()=>{V=T,t(12,V)})}const ot=T=>{ie(T.property,Ge.ASC)},He=T=>{ie(T.property,Ge.DESC)};function nt(T){Re[T?"unshift":"push"](()=>{O=T,t(13,O)})}const st=({detail:T})=>{T===te.BUG_REPORT.label&&I("bugReportClick"),T===te.DOMAIN_HINT.label&&I("domainHintClick")},it=()=>I("replicateData"),at=()=>I("removeClick"),ct=()=>I("cancelReplication");return l.$$set=T=>{"hasBookOpened"in T&&t(1,p=T.hasBookOpened),"selectMode"in T&&t(0,k=T.selectMode),"selectedCount"in T&&t(2,C=T.selectedCount),"hasBooks"in T&&t(3,y=T.hasBooks),"cancelTooltip"in T&&t(4,E=T.cancelTooltip),"replicationProgress"in T&&t(5,d=T.replicationProgress),"replicationToProgress"in T&&t(6,m=T.replicationToProgress),"replicationProgressRemaining"in T&&t(7,P=T.replicationProgressRemaining)},l.$$.update=()=>{l.$$.dirty[0]&1610612736|l.$$.dirty[1]&3&&(t(14,re=Or(window)),L.push(...c?[te.BACKUP_IMPORT]:[te.FOLDER_IMPORT,te.BACKUP_IMPORT]),q.push(...Le(G.GDRIVE,o,window)?[{label:"GDrive",key:G.GDRIVE,requiresConnectivity:!0}]:[],...Le(G.ONEDRIVE,s,window)?[{label:"OneDrive",key:G.ONEDRIVE,requiresConnectivity:!0}]:[],...Le(G.FS,a,window)?[{label:"Filesystem",key:G.FS,requiresConnectivity:!1}]:[])),l.$$.dirty[0]&256&&t(15,r=[...n===G.BROWSER?[{property:"id",label:"Added (id)"}]:[],{property:"title",label:"Title"},{property:"characters",label:"Characters"},{property:"lastBookModified",label:"Last Update"},{property:"lastBookOpen",label:"Last Read"},{property:"progress",label:"Progress"},{property:"lastBookmarkModified",label:"Bookmarked"}])},[k,p,C,y,E,d,m,P,n,W,J,fe,V,O,re,r,i,f,g,_,I,b,v,L,q,Ie,me,_e,ie,a,s,o,c,ue,de,ye,et,Ne,je,tt,rt,lt,ot,He,nt,st,it,at,ct]}class vl extends Ve{constructor(e){super(),Me(this,e,gl,pl,Te,{hasBookOpened:1,selectMode:0,selectedCount:2,hasBooks:3,cancelTooltip:4,replicationProgress:5,replicationToProgress:6,replicationProgressRemaining:7},null,[-1,-1])}}function kl(l){let e,t,r,n,i,a,s,o;return{c(){e=R("div"),t=be("svg"),r=be("path"),n=U(),i=R("div"),a=le(l[4]),this.h()},l(c){e=S(c,"DIV",{class:!0});var f=D(e);t=we(f,"svg",{class:!0,xmlns:!0,viewBox:!0});var g=D(t);r=we(g,"path",{class:!0,d:!0}),D(r).forEach(u),g.forEach(u),n=z(f),i=S(f,"DIV",{class:!0});var _=D(i);a=oe(_,l[4]),_.forEach(u),f.forEach(u),this.h()},h(){h(r,"class","fill-current"),h(r,"d",l[2]),h(t,"class","inline-block h-8 w-8 md:h-14 md:w-14 lg:h-20 lg:w-20"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"viewBox",l[3]),h(i,"class","mt-2"),h(e,"class","cursor-pointer border border-transparent py-4 text-center hover:border hover:border-current"),$(e,"border-current",l[0]),$(e,"opacity-5",l[1]),$(e,"cursor-not-allowed",l[1]),$(e,"hover:border-transparent",l[1])},m(c,f){M(c,e,f),w(e,t),w(t,r),w(e,n),w(e,i),w(i,a),s||(o=[F(e,"click",l[5]),F(e,"keyup",l[6])],s=!0)},p(c,[f]){f&4&&h(r,"d",c[2]),f&8&&h(t,"viewBox",c[3]),f&16&&De(a,c[4]),f&1&&$(e,"border-current",c[0]),f&2&&$(e,"opacity-5",c[1]),f&2&&$(e,"cursor-not-allowed",c[1]),f&2&&$(e,"hover:border-transparent",c[1])},i:Be,o:Be,d(c){c&&u(e),s=!1,se(o)}}}function bl(l,e,t){let{selected:r}=e,{disabled:n}=e,{d:i}=e,{viewBox:a}=e,{label:s}=e;function o(f){Je.call(this,l,f)}function c(f){Je.call(this,l,f)}return l.$$set=f=>{"selected"in f&&t(0,r=f.selected),"disabled"in f&&t(1,n=f.disabled),"d"in f&&t(2,i=f.d),"viewBox"in f&&t(3,a=f.viewBox),"label"in f&&t(4,s=f.label)},[r,n,i,a,s,o,c]}class wl extends Ve{constructor(e){super(),Me(this,e,bl,kl,Te,{selected:0,disabled:1,d:2,viewBox:3,label:4})}}function Jt(l,e,t){const r=l.slice();r[9]=e[t];const n=r[4](r[9].source)&&!r[3];return r[10]=n,r}function Xt(l,e){let t,r,n;const i=[e[9],{disabled:e[10]},{selected:e[9].source===e[0]}];function a(){return e[5](e[10],e[9])}let s={};for(let o=0;o<i.length;o+=1)s=Zt(s,i[o]);return r=new wl({props:s}),r.$on("click",a),{key:l,first:null,c(){t=Xe(),Z(r.$$.fragment),this.h()},l(o){t=Xe(),Y(r.$$.fragment,o),this.h()},h(){this.first=t},m(o,c){M(o,t,c),Q(r,o,c),n=!0},p(o,c){e=o;const f=c&29?Yt(i,[c&4&&Qt(e[9]),c&28&&{disabled:e[10]},c&5&&{selected:e[9].source===e[0]}]):{};r.$set(f)},i(o){n||(A(r.$$.fragment,o),n=!0)},o(o){N(r.$$.fragment,o),n=!1},d(o){o&&u(t),x(r,o)}}}function El(l){let e,t,r,n,i=[],a=new Map,s,o,c,f,g,_,p,k,C,y,E,d,m,P,I,b,v,L,q,W,J=l[2];const fe=V=>V[9].source;for(let V=0;V<J.length;V+=1){let O=Jt(l,J,V),re=fe(O);a.set(re,i[V]=Xt(re,O))}return L=ar(l[7][0]),{c(){e=R("h2"),t=le("Export Target"),r=U(),n=R("div");for(let V=0;V<i.length;V+=1)i[V].c();s=U(),o=R("h2"),c=le("Export Content"),f=U(),g=R("div"),_=R("div"),p=R("input"),k=U(),C=R("label"),y=le("Book Data"),E=U(),d=R("div"),m=R("input"),P=U(),I=R("label"),b=le("Bookmark"),this.h()},l(V){e=S(V,"H2",{class:!0});var O=D(e);t=oe(O,"Export Target"),O.forEach(u),r=z(V),n=S(V,"DIV",{class:!0});var re=D(n);for(let ye=0;ye<i.length;ye+=1)i[ye].l(re);re.forEach(u),s=z(V),o=S(V,"H2",{class:!0});var Ie=D(o);c=oe(Ie,"Export Content"),Ie.forEach(u),f=z(V),g=S(V,"DIV",{class:!0});var me=D(g);_=S(me,"DIV",{class:!0});var _e=D(_);p=S(_e,"INPUT",{type:!0,id:!0,name:!0}),k=z(_e),C=S(_e,"LABEL",{for:!0});var ie=D(C);y=oe(ie,"Book Data"),ie.forEach(u),_e.forEach(u),E=z(me),d=S(me,"DIV",{});var ue=D(d);m=S(ue,"INPUT",{type:!0,id:!0,name:!0}),P=z(ue),I=S(ue,"LABEL",{for:!0});var de=D(I);b=oe(de,"Bookmark"),de.forEach(u),ue.forEach(u),me.forEach(u),this.h()},h(){h(e,"class","mb-4 text-xl font-medium"),h(n,"class","mb-4 grid grid-cols-2 gap-8"),h(o,"class","mb-2 text-xl font-medium"),h(p,"type","checkbox"),h(p,"id","bookdata"),h(p,"name","data"),p.__value="data",p.value=p.__value,h(C,"for","bookdata"),h(_,"class","mr-4"),h(m,"type","checkbox"),h(m,"id","bookprogress"),h(m,"name","bookmark"),m.__value="bookmark",m.value=m.__value,h(I,"for","bookprogress"),h(g,"class","grid grid-cols-2 gap-4 md:grid-cols-4"),L.p(p,m)},m(V,O){M(V,e,O),w(e,t),M(V,r,O),M(V,n,O);for(let re=0;re<i.length;re+=1)i[re]&&i[re].m(n,null);M(V,s,O),M(V,o,O),w(o,c),M(V,f,O),M(V,g,O),w(g,_),w(_,p),p.checked=~(l[1]||[]).indexOf(p.__value),w(_,k),w(_,C),w(C,y),w(g,E),w(g,d),w(d,m),m.checked=~(l[1]||[]).indexOf(m.__value),w(d,P),w(d,I),w(I,b),v=!0,q||(W=[F(p,"change",l[6]),F(m,"change",l[8])],q=!0)},p(V,[O]){O&29&&(J=V[2],pe(),i=xe(i,O,fe,1,V,J,a,n,kt,Xt,null,Jt),he()),O&2&&(p.checked=~(V[1]||[]).indexOf(p.__value)),O&2&&(m.checked=~(V[1]||[]).indexOf(m.__value))},i(V){if(!v){for(let O=0;O<J.length;O+=1)A(i[O]);v=!0}},o(V){for(let O=0;O<i.length;O+=1)N(i[O]);v=!1},d(V){V&&u(e),V&&u(r),V&&u(n);for(let O=0;O<i.length;O+=1)i[O].d();V&&u(s),V&&u(o),V&&u(f),V&&u(g),L.r(),q=!1,se(W)}}}function Bl(l,e,t){let r;X(l,wt,_=>t(3,r=_));let{icons:n}=e,{target:i}=e,{dataToReplicate:a}=e;function s(_){return _===G.GDRIVE||_===G.ONEDRIVE}cr(()=>{n.find(_=>_.source===i)||t(0,i=G.BACKUP)});const o=[[]],c=(_,p)=>{_||t(0,i=p.source)};function f(){a=It(o[0],this.__value,this.checked),t(1,a)}function g(){a=It(o[0],this.__value,this.checked),t(1,a)}return l.$$set=_=>{"icons"in _&&t(2,n=_.icons),"target"in _&&t(0,i=_.target),"dataToReplicate"in _&&t(1,a=_.dataToReplicate)},l.$$.update=()=>{l.$$.dirty&13&&!r&&s(i)&&t(0,i=n.find(_=>_.source===G.BACKUP)?G.BACKUP:G.BROWSER)},[i,a,n,r,s,c,f,o,g]}class Il extends Ve{constructor(e){super(),Me(this,e,Bl,El,Te,{icons:2,target:0,dataToReplicate:1})}}function yl(l){let e,t,r,n;function i(o){l[10](o)}function a(o){l[11](o)}let s={icons:l[0]};return l[2]!==void 0&&(s.target=l[2]),l[1]!==void 0&&(s.dataToReplicate=l[1]),e=new Il({props:s}),Re.push(()=>ht(e,"target",i)),Re.push(()=>ht(e,"dataToReplicate",a)),{c(){Z(e.$$.fragment)},l(o){Y(e.$$.fragment,o)},m(o,c){Q(e,o,c),n=!0},p(o,c){const f={};c&1&&(f.icons=o[0]),!t&&c&4&&(t=!0,f.target=o[2],_t(()=>t=!1)),!r&&c&2&&(r=!0,f.dataToReplicate=o[1],_t(()=>r=!1)),e.$set(f)},i(o){n||(A(e.$$.fragment,o),n=!0)},o(o){N(e.$$.fragment,o),n=!1},d(o){x(e,o)}}}function Dl(l){let e,t,r,n,i,a,s,o,c,f,g,_;return n=new Rt({}),o=new Rt({}),{c(){e=R("div"),t=R("button"),r=le(`Cancel
      `),Z(n.$$.fragment),i=U(),a=R("button"),s=le(`Start
      `),Z(o.$$.fragment),this.h()},l(p){e=S(p,"DIV",{class:!0,slot:!0});var k=D(e);t=S(k,"BUTTON",{class:!0});var C=D(t);r=oe(C,`Cancel
      `),Y(n.$$.fragment,C),C.forEach(u),i=z(k),a=S(k,"BUTTON",{class:!0});var y=D(a);s=oe(y,`Start
      `),Y(o.$$.fragment,y),y.forEach(u),k.forEach(u),this.h()},h(){h(t,"class",St),h(a,"class",St),a.disabled=c=!l[1].length,$(a,"cursor-not-allowed",!l[1].length),h(e,"class","flex grow justify-between"),h(e,"slot","footer")},m(p,k){M(p,e,k),w(e,t),w(t,r),Q(n,t,null),w(e,i),w(e,a),w(a,s),Q(o,a,null),f=!0,g||(_=[F(t,"click",l[9]),F(a,"click",l[4])],g=!0)},p(p,k){(!f||k&2&&c!==(c=!p[1].length))&&(a.disabled=c),(!f||k&2)&&$(a,"cursor-not-allowed",!p[1].length)},i(p){f||(A(n.$$.fragment,p),A(o.$$.fragment,p),f=!0)},o(p){N(n.$$.fragment,p),N(o.$$.fragment,p),f=!1},d(p){p&&u(e),x(n),x(o),g=!1,se(_)}}}function Cl(l){let e,t;return e=new Lr({props:{$$slots:{footer:[Dl],content:[yl]},$$scope:{ctx:l}}}),{c(){Z(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p(r,[n]){const i={};n&4103&&(i.$$scope={dirty:n,ctx:r}),e.$set(i)},i(r){t||(A(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Rl(l,e,t){let r,n,i,a,s,o;X(l,Ye,C=>t(5,r=C)),X(l,xt,C=>t(6,n=C)),X(l,er,C=>t(7,i=C)),X(l,tr,C=>t(8,a=C)),X(l,gt,C=>t(1,s=C)),X(l,vt,C=>t(2,o=C));let c=[{...$e(G.BACKUP),source:G.BACKUP,label:"Zip File"},{...$e(G.BROWSER),source:G.BROWSER,label:"Browser DB"}];const f=bt();function g(){lr.next(),f("close")}const _=()=>f("close");function p(C){o=C,vt.set(o)}function k(C){s=C,gt.set(s)}return l.$$.update=()=>{l.$$.dirty&481&&t(0,c=[...c,...Le(G.GDRIVE,a,window)?[{...$e(G.GDRIVE),source:G.GDRIVE,label:"GDrive"}]:[],...Le(G.ONEDRIVE,i,window)?[{...$e(G.ONEDRIVE),source:G.ONEDRIVE,label:"OneDrive"}]:[],...Le(G.FS,n,window)?[{...$e(G.FS),source:G.FS,label:"Filesystem"}]:[]].filter(C=>C.source!==r))},[c,s,o,f,g,r,n,i,a,_,p,k]}class Sl extends Ve{constructor(e){super(),Me(this,e,Rl,Cl,Te,{})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2023, ッツ Reader Authors
 * All rights reserved.
 */function dt(l,e){const t=new Set(l);return e(t),t}/**
 * @license BSD-3-Clause
 * Copyright (c) 2023, ッツ Reader Authors
 * All rights reserved.
 */async function or(l){if(Tl(l)){const t=l.createReader(),r=await nr(t);return(await Promise.all(r.map(i=>or(i)))).flat()}return[await new Promise((t,r)=>{l.file(t,r)})]}async function nr(l){const e=await new Promise((r,n)=>{l.readEntries(r,n)});if(!e.length)return[];const t=await nr(l);return e.concat(t)}function Tl(l){return l.isDirectory}/**
 * @license BSD-3-Clause
 * Copyright (c) 2023, ッツ Reader Authors
 * All rights reserved.
 */async function Pl(l){var r;if(!((r=l.dataTransfer)!=null&&r.items))return[];const e=Array.from(l.dataTransfer.items).filter(n=>n.kind==="file").map(n=>n.webkitGetAsEntry()).filter(n=>!!n);return e.length?(await Promise.all(e.map(n=>or(n)))).flat():[]}/**
 * @license BSD-3-Clause
 * Copyright (c) 2023, ッツ Reader Authors
 * All rights reserved.
 */function Ol(l,e){return new Map(l.map(t=>[t[e],t]))}const{document:pt}=ur;function Vl(l){let e,t,r,n,i,a,s,o,c;return r=new Ee({props:{icon:Ir,style:"width: 100%; height: auto"}}),{c(){e=R("div"),t=R("div"),Z(r.$$.fragment),n=U(),i=R("label"),a=R("input"),this.h()},l(f){e=S(f,"DIV",{class:!0});var g=D(e);t=S(g,"DIV",{class:!0});var _=D(t);Y(r.$$.fragment,_),_.forEach(u),g.forEach(u),n=z(f),i=S(f,"LABEL",{class:!0});var p=D(i);a=S(p,"INPUT",{type:!0,accept:!0}),p.forEach(u),this.h()},h(){h(t,"class","flex w-3/6 justify-center xl:w-3/12"),h(e,"class","flex justify-center pt-44 text-gray-400 text-opacity-40"),h(a,"type","file"),h(a,"accept",".htmlz,.epub"),a.multiple=!0,a.hidden=!0,h(i,"class","fixed inset-0 z-0")},m(f,g){M(f,e,g),w(e,t),Q(r,t,null),M(f,n,g),M(f,i,g),w(i,a),s=!0,o||(c=Fe(Ke.call(null,a,l[16])),o=!0)},p:Be,i(f){s||(A(r.$$.fragment,f),s=!0)},o(f){N(r.$$.fragment,f),s=!1},d(f){f&&u(e),x(r),f&&u(n),f&&u(i),o=!1,c()}}}function Ml(l){let e,t;return e=new Qr({props:{currentBookId:l[9],selectedBookIds:l[1],bookCards:l[8]}}),e.$on("bookClick",l[30]),e.$on("removeBookClick",l[31]),{c(){Z(e.$$.fragment)},l(r){Y(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p(r,n){const i={};n[0]&512&&(i.currentBookId=r[9]),n[0]&2&&(i.selectedBookIds=r[1]),n[0]&256&&(i.bookCards=r[8]),e.$set(i)},i(r){t||(A(e.$$.fragment,r),t=!0)},o(r){N(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Al(l){let e;return{c(){e=le("Loading...")},l(t){e=oe(t,"Loading...")},m(t,r){M(t,e,r)},p:Be,i:Be,o:Be,d(t){t&&u(e)}}}function Ll(l){var I;let e,t,r=(l[10]??"")+"",n,i,a,s,o,c,f,g,_,p,k,C;pt.title=e=yt("Book Manager");function y(b){l[25](b)}let E={hasBookOpened:!!l[9],selectedCount:l[1].size,hasBooks:!!((I=l[8])!=null&&I.length),cancelTooltip:l[4],replicationProgress:l[5],replicationToProgress:l[6],replicationProgressRemaining:l[7]};l[0]!==void 0&&(E.selectMode=l[0]),s=new vl({props:E}),Re.push(()=>ht(s,"selectMode",y)),s.$on("selectAllClick",l[17]),s.$on("backToBookClick",l[18]),s.$on("removeClick",l[26]),s.$on("filesChange",l[27]),s.$on("domainHintClick",l[21]),s.$on("bugReportClick",l[22]),s.$on("cancelReplication",l[28]),s.$on("replicateData",l[23]),s.$on("importBackup",l[29]);const d=[Al,Ml,Vl],m=[];function P(b,v){return!b[8]||b[11]?0:b[8].length?1:2}return g=P(l),_=m[g]=d[g](l),{c(){t=U(),n=le(r),i=U(),a=R("div"),Z(s.$$.fragment),c=U(),f=R("div"),_.c(),this.h()},l(b){fr("svelte-1u9ti14",pt.head).forEach(u),t=z(b),n=oe(b,r),i=z(b),a=S(b,"DIV",{class:!0});var L=D(a);Y(s.$$.fragment,L),L.forEach(u),c=z(b),f=S(b,"DIV",{class:!0});var q=D(f);_.l(q),q.forEach(u),this.h()},h(){h(a,"class","elevation-4 fixed inset-x-0 top-0 z-10"),h(f,"class",rr+" h-full pt-16 xl:pt-14")},m(b,v){M(b,t,v),M(b,n,v),M(b,i,v),M(b,a,v),Q(s,a,null),M(b,c,v),M(b,f,v),m[g].m(f,null),p=!0,k||(C=[F(f,"dragenter",Ul),F(f,"dragover",zl),F(f,"dragend",Fl),F(f,"drop",Gl),F(f,"drop",l[32])],k=!0)},p(b,v){var W;(!p||v&0)&&e!==(e=yt("Book Manager"))&&(pt.title=e),(!p||v[0]&1024)&&r!==(r=(b[10]??"")+"")&&De(n,r);const L={};v[0]&512&&(L.hasBookOpened=!!b[9]),v[0]&2&&(L.selectedCount=b[1].size),v[0]&256&&(L.hasBooks=!!((W=b[8])!=null&&W.length)),v[0]&16&&(L.cancelTooltip=b[4]),v[0]&32&&(L.replicationProgress=b[5]),v[0]&64&&(L.replicationToProgress=b[6]),v[0]&128&&(L.replicationProgressRemaining=b[7]),!o&&v[0]&1&&(o=!0,L.selectMode=b[0],_t(()=>o=!1)),s.$set(L);let q=g;g=P(b),g===q?m[g].p(b,v):(pe(),N(m[q],1,1,()=>{m[q]=null}),he(),_=m[g],_?_.p(b,v):(_=m[g]=d[g](b),_.c()),A(_,1),_.m(f,null))},i(b){p||(A(s.$$.fragment,b),A(_),p=!0)},o(b){N(s.$$.fragment,b),N(_),p=!1},d(b){b&&u(t),b&&u(n),b&&u(i),b&&u(a),x(s),b&&u(c),b&&u(f),m[g].d(),k=!1,se(C)}}}function Nl(l){return l!=null&&l.progress?{progress:typeof l.progress=="string"?+l.progress.slice(0,-1):l.progress,lastBookmarkModified:l.lastBookmarkModified||0}:{progress:0,lastBookmarkModified:0}}function $l(l){return l&&Number.isFinite(l)?new Date(l*1e3).toISOString().substr(11,8):"??:??:??"}const Ul=l=>l.preventDefault(),zl=l=>l.preventDefault(),Fl=l=>l.preventDefault(),Gl=l=>l.preventDefault();function jl(l,e,t){let r,n,i,a,s,o,c,f,g,_,p,k;X(l,gt,B=>t(36,r=B)),X(l,Gr,B=>t(37,i=B)),X(l,mt,B=>t(38,a=B)),X(l,vt,B=>t(39,s=B)),X(l,Ye,B=>t(40,o=B)),X(l,wt,B=>t(41,f=B)),X(l,jr,B=>t(42,g=B)),X(l,Qe,B=>t(43,_=B));const C=Ue.listLoading$.pipe(ut(B=>B));X(l,C,B=>t(11,k=B));const y=Dr([Ue.dataList$,Ue.bookmarks$,Qe]).pipe(ut(([B,j])=>{const K=_[o],H=K.property==="title";if(o===G.BROWSER){const ae=Ol(j,"dataId");return[...B.filter(ne=>g||!ne.isPlaceholder).map(ne=>({...ne,...Nl(ae.get(ne.id))})).sort((ne,ce)=>V(ne,ce,K,H))]}return[...B.sort((ae,ne)=>V(ae,ne,K,H))]}),Tt());X(l,y,B=>t(8,n=B));const E=Ue.lastItem$.pipe(ut(B=>B==null?void 0:B.dataId),Tt());X(l,E,B=>t(9,c=B));let d=new Set,m=!1,P=new AbortController,I=P.signal,b="",v=0,L=0,q="~ ??:??:??",W=new Ot,J=0,fe;function V(B,j,K,H){const ae=B[K.property]||(H?"":0),ne=j[K.property]||(H?"":0);let ce=0;return K.direction===Ge.ASC?ce=H?B.title.localeCompare(j.title,"ja-JP",{numeric:!0}):+ae-+ne:ce=H?j.title.localeCompare(B.title,"ja-JP",{numeric:!0}):+ne-+ae,ce||(ce=B.title.localeCompare(j.title,"ja-JP",{numeric:!0})),ce}async function O(B){if(re()){if(!m){Se.dialogs$.next([{component:"<div/>",disableCloseOnClick:!0}]);let j=B;try{const K=n.find(ne=>ne.id===B);if(!K)throw new Error("Book title not found");const H=o===G.BROWSER,ae=Pe(window,o,"",H,a,i);mt||ae.clearData(!1),ae.startContext({id:H?K.id:0,title:K.title,imagePath:K.imagePath}),j=await ae.prepareBookForReading(),Se.dialogs$.next([])}catch(K){const H=`Error opening book: ${K.message}`;ze.warn(H),Se.dialogs$.next([{component:We,props:{title:"Error",message:H}}]);return}Ie(j);return}t(1,d=dt(d,j=>{if(j.has(B)){j.delete(B);return}j.add(B)}))}}function re(){const B=!((o===G.GDRIVE||o===G.ONEDRIVE)&&!f);if(!B&&!L){const j="You have to be online for this operation";ze.warn(j),Se.dialogs$.next([{component:We,props:{title:"Failure",message:j}}])}return!L&&B}function Ie(B){B&&(Ue.putLastItem(B),me(B))}async function me(B){await pr(`${Ur}/b?id=${B}`)}async function _e(B){if(!re())return;t(4,b=`Cancels the current Import
Already imported data will not be deleted`),ue();const j=/\.(?:htmlz|epub)$/,K=Array.from(B).filter(ce=>j.test(ce.name)),H="Bookimport failed";if(!K.length){de(),ie(H,"File(s) must be HTMLZ or EPUB","");return}const{error:ae,dataId:ne}=await zr(document,Pe(window,o,"",o===G.BROWSER,a,i),K,I).catch(ce=>({error:ce.message,dataId:0}));de(),ae?ie(H,ae,"Error(s) occurred during bookimport"):o===G.BROWSER&&ne&&Ie(ne)}function ie(B,j,K){const H=ze.errorCount>1;ze.warn(j),Se.dialogs$.next([{component:H?Pt:We,props:{title:B,message:H?K:j}}])}function ue(){W=new Ot,Hr.pipe(Cr(W)).subscribe(ot),t(7,q="~ ??:??:??"),t(5,v=0),t(6,L=1),fe=Date.now(),ze.clearHistory(),t(2,P=new AbortController),t(3,I=P.signal)}function de(){W.next(),W.complete(),t(6,L=0),t(5,v=0),t(4,b="")}function ye(){const B=n;t(1,d=dt(d,j=>{B.forEach(K=>j.add(K.id))}))}function et(){const B=c;B&&me(B)}async function Ne(B){if(!re())return;t(4,b=`Cancels the Deletion
Already deleted data will not be restored`),ue();const j=n.length,K=Pe(window,o,""),{error:H,deleted:ae}=await K.deleteBookData(n.reduce((ne,ce)=>(B.includes(ce.id)&&ne.push(ce.title),ne),[]),I);de(),await dr(),ae.length===j?t(0,m=!1):t(1,d=dt(d,ne=>{ae.forEach(ce=>ne.delete(ce))})),H&&ie("Deletion failed",H,"Error(s) occurred during deletion")}async function je(B){if(!re())return;const j="Import failed";if(t(4,b=`Cancels the current Import
Already imported data will not be deleted`),ue(),!B.name.endsWith(".zip")){de(),ie(j,"Invalid file - expected zip archive","");return}const K=await Fr(Pe(window,G.BACKUP,void 0,o===G.BROWSER,a,i),Pe(window,o,"",o===G.BROWSER,a,i),B,I).catch(H=>H.message);de(),K&&ie(j,K,"Error(s) occurred during import")}function tt(){Se.dialogs$.next([{component:We,props:{title:"Old Domain",message:"You are currently using the old domain of ッツ Reader - consider switching to https://reader.ttsu.app to prevent issues and to ensure full features"},disableCloseOnClick:!0}])}function rt(){Se.dialogs$.next([{component:Pt,props:{title:"Bug Report",message:"Please include the attached file for your report"}}])}function lt(){Se.dialogs$.next([{component:Sl,disableCloseOnClick:!0}])}function ot(B){if(!I.aborted){if(J=B.progressBase||J||0,t(6,L=B.maxProgress||L||0),B.skipStep){const j=Math.ceil(v/J)*J-v;t(5,v=Math.floor((v+(j||J)+Number.EPSILON)*1e3)/1e3)}else if(B.completeStep){const j=Math.ceil(v)-v;t(5,v=Math.floor((v+j+Number.EPSILON)*1e3)/1e3)}else B.progressToAdd&&B.progressToAdd>0&&t(5,v=Math.floor((v+B.progressToAdd+Number.EPSILON)*1e3)/1e3);if(B.progressToAdd){const j=(Date.now()-fe)/1e3,K=v/j,H=(L-v)/K;t(7,q=L>v?`~ ${$l(Math.ceil(H))}`:"~ 00:00:01")}}}const He=lr.pipe(Nr(async()=>{if(!re())return;t(4,b="Cancels the current export"),ue();const B=[o,s].map(H=>Pe(window,H,"",s===G.BROWSER,a,i)),j=n.filter(H=>d.has(H.id)),K=await $r(B[0],B[1],!1,j.map(H=>({title:H.title,imagePath:H.imagePath})),r,I).catch(H=>H.message);de(),K&&ie("Export failed",K,"Error(s) occurred during export")}),Rr());X(l,He,B=>t(10,p=B));function nt(B){m=B,t(0,m)}const st=()=>Ne(Array.from(d)),it=B=>_e(B.detail),at=()=>{I.aborted||(P.abort(),t(7,q="Canceling ..."))},ct=B=>je(B.detail),T=B=>O(B.detail.id),qe=B=>Ne([B.detail.id]),ft=B=>Pl(B).then(_e);return l.$$.update=()=>{l.$$.dirty[0]&1&&(m||t(1,d=new Set))},[m,d,P,I,b,v,L,q,n,c,p,k,C,y,E,O,_e,ye,et,Ne,je,tt,rt,lt,He,nt,st,it,at,ct,T,qe,ft]}class Yl extends Ve{constructor(e){super(),Me(this,e,jl,Ll,Te,{},null,[-1,-1])}}export{Yl as default};
